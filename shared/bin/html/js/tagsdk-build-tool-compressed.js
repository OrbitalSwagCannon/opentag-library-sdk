(function(){Function.prototype.bind=Function.prototype.bind||function(b){var h=this;return function(){return h.apply(b,arguments)}}})();var global=this;try{global=(0,eval)("this")||function(){return this}()||window}catch(e$$12){}global.VERSION="1.0.2-b1";var EMPTY_FUN=function(){},UNDEF=void 0;global.APP_PATH=global.APP_PATH||"/";global.LIBRARIES_REPO_LOC=global.LIBRARIES_REPO_LOC||"/";
(function(){var b,h;function d(){function a(c){z.events.push(c);b(z.listeners,function(a){if(!a.disposed&&s(a.type,c.meta.type))try{a.callback.call(a.context,c)}catch(e){console&&console.error&&console.error("Error emitting UV event",e.stack)}});e.shift();0<e.length&&a(e[0])}function b(a,c){for(var e=a.length,g=0;g<e;g++)c(a[g],g)}function g(a){var c={},e;for(e in a)a.hasOwnProperty(e)&&(c[e]=a[e]);return c}function s(a,c){return"string"===typeof a?a===c:a.test(c)}function c(a,c){for(var e=a.length,
b=[],g=0;g<e;g++)c(a[g])&&b.push(a[g]);return b}var e=[],z={emit:function(b,n){n=g(n||{});n.meta=n.meta||{};n.meta.type=b;e.push(n);1===e.length&&a(e[0]);z.listeners=c(z.listeners,function(a){return!a.disposed})},on:function(a,c,e){var g={type:a,callback:c,disposed:!1,context:e||window};z.listeners.push(g);var d={replay:function(){b(z.events,function(b){g.disposed||s(a,b.meta.type)&&c.call(e,b)});return d},dispose:function(){g.disposed=!0;return d}};return d},once:function(a,c,e){var b=z.on(a,function(){c.apply(e||
window,arguments);b.dispose()});return b},events:[],listeners:[]};return z}function k(){var a=I.uv;if(!a||!a.emit)return!1;if(!K){K=!0;for(var b=0;b<L.length;b++){var g=L[b];g.on?a.on.apply(a,g.on):g.emit&&a.emit.apply(a,g.emit)}a.on(/.*/,function(a){var c=a.meta.type,e=H[c];e?(e.current=a,e.history.push(a)):H[c]={current:a,history:[a]}}).replay();M=!0}return!0}(function(){Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");
var b=Array.prototype.slice.call(arguments,1),g=this,s=function(){},c=function(){return g.apply(this instanceof s?this:a,b.concat(Array.prototype.slice.call(arguments)))};s.prototype=this.prototype;c.prototype=new s;return c})})();var l={__anonymous__:!0},m=null;try{m=(0,eval)("this")}catch(q){}if(!m)try{m=function(){return this}()}catch(u){}var l=m,f=l.qubit||{};l.qubit||(l.qubit=f);if(f.VERSION&&"3.1.1"!==f.VERSION)try{console.warn("There is already 'qubit.VERSION' set to: "+f.VERSION)}catch(x){}f.VERSION=
"3.1.1";try{"object"===typeof module&&(module.exports=l)}catch(B){}var p=function(){};(function(){function a(){}function b(c,e,g,s,n){c=c.split(".");var d=a.NAMESPACE_BASE||l,f=null,h=null;n&&(d=m);n=d;d=g||d;for(g=0;g<c.length-1;g+=1)h=c[g],d[h]=d[h]||{},d=d[h];f=d;h=c[c.length-1];m.TAGSDK_NS_OVERRIDE&&(s=!1);void 0!==m.TAGSDK_NS_FORCED_OVERRIDE_OPTION&&(s=!m.TAGSDK_NS_FORCED_OVERRIDE_OPTION);void 0!==e?void 0!==f[h]&&s||(f[h]=e):f[h]=f[h]||{};e&&(e.CLASSPATH=c.join("."),c.splice(c.length-1,1),e.PACKAGE_NAME=
c.join("."));return{root:n,object:f,instance:f[h]}}a.global=function(){return m};a.STANDARD_CS_NS="qubit.cs";a.clientSpaceClasspath=function(){return window.qubit.CLIENT_CONFIG?"qubit.cs.d"+window.qubit.CLIENT_CONFIG.id:a.STANDARD_CS_NS};a.globalNamespace=function(a,e,g,s){return b(a,e,g,s,!0)};a.namespace=function(a,e,g,s){return b(a,e,g,s,!1)};a.clientNamespace=function(c,e,b,g){return a.namespace(a.clientSpaceClasspath()+"."+c,e,b,g)};a.clazz=function(c,e,b,g,s){a.namespace(c,e,g,!0);"function"===
typeof b&&(e.SUPER=b,e.superclass=b,e.prototype=new b(s),e.prototype.SUPER=b,e.prototype.CLASS=e);c=c.split(".");e.prototype?(e.prototype.CLASSPATH=c.join("."),e.prototype.CLASS_NAME=c[c.length-1],c.splice(c.length-1,1),e.prototype.PACKAGE_NAME=c.join(".")):(e.CLASSPATH=c.join("."),e.STATIC_NAME=c[c.length-1],c.splice(c.length-1,1),e.PACKAGE_NAME=c.join("."));return e};a.clazz("qubit.Define",a);a.clientClazz=function(c,e,b,g,s){return a.clazz(a.clientSpaceClasspath()+"."+c,e,b,g,s)};a.STANDARD_VS_NS=
"qubit.vs";a.vendorsSpaceClasspath=function(c){var e=f.VENDOR_SPACE_CP,e=void 0===e||null===e?a.STANDARD_VS_NS:e;return c?e?e+"."+c:c:e};var g=a.vendorsSpaceClasspath(),s;s=g?a.namespace(g,{},null,!0).instance:a.global();a.getVendorSpace=function(){return s};a.vendorNamespace=function(c,e,b,g){c=a.vendorsSpaceClasspath(c);return a.namespace(c,e,b,g)};a.vendorClazz=function(c,e,b,g,s){c=a.vendorsSpaceClasspath(c);return a.clazz(c,e,b,g,s)}})();(function(){function a(a){}for(var b={},g=0;93>g;g++)b["abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ*!-#$&+()@'%./:<>?[\"]^_`{|}~\\;=".charAt(g)]=
g;f.Define.clazz("qubit.Cookie",a);a.cookieAlphabet="abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ*!-#$&+()@'%./:<>?[\"]^_`{|}~\\;=";a.cookieAlphabetMap=b;a.decode=function(a){return unescape(a)};a.encode=function(a){return escape(a)};a.set=function(b,c,e,g,d){if(e){var n=new Date;n.setTime(n.getTime()+864E5*e);e="; expires="+n.toGMTString()}else e="";d||(b=a.encode(b),c=a.encode(c));b=b+"="+c+e+"; path=/;";g&&(b+=" domain="+g);document.cookie=b};a.get=function(b,c){for(var e=b+"=",
g=document.cookie.split(";"),d=0;d<g.length;d++){for(var n=g[d];" "===n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(e))return e=n.substring(e.length,n.length),c||(e=a.decode(e)),e}return null};a.getAllForName=function(b,c){if(!b)return[];for(var e=b+"=",g=document.cookie.split(";"),d=[],n=0;n<g.length;n++){for(var f=g[n];" "===f.charAt(0);)f=f.substring(1,f.length);0===f.indexOf(e)&&(f=f.substring(e.length,f.length),c&&(f=a.decode(f)),d.push(f))}return d};a.getAll=function(b){for(var c=
document.cookie.split(";"),e=[],g=0;g<c.length;g++){for(var d=c[g];" "===d.charAt(0);)d=d.substring(1,d.length);var n=d.substring(0,d.indexOf("=")),d=d.substring(n.length+1,d.length);b&&(d=a.decode(d));e.push([n,d])}return e};a.rm=function(b,c){a.set(b,"",-1,c)}})();(function(){function a(a,c){for(var e=h.length,b=0;b<e;b++)if(a===h[b][0])return h[b][1];h[h.length]=[a,c];return!1}function b(t,c,e,g,w){var n=!1,s=!1,f=!1,v=!1,k=!1,l=k=!1;c&&(n=(k=!!c.all)||c.nodes,v=k||c.win,s=k,l=!!c.emptyForMaxDeep,
f=c.noFunctions&&!k,void 0!==c.noOwn&&(s=!!c.noOwn),void 0!==c.noFunctions&&(f=!!c.noFunctions),void 0!==c.win&&(v=!!c.win),void 0!==c.nodes&&(n=!!c.nodes),k=!!c.copyReference);if(void 0===e||e)void 0!==e&&e--;else return l?void 0:t;if(!(t&&t instanceof Object))return t;if(!n){try{if(t instanceof Node)return t}catch(F){if(t instanceof ActiveXObject&&void 0!==t.nodeType)return t}if(t===document)return t}if(!v&&t===d)return t;n=t instanceof Array?[]:{};t instanceof Date&&(n=new Date(t));!f&&t instanceof
Function&&(f=String(t).replace(/\s+/g,""),n=f.indexOf("{[nativecode]}")+14===f.length?function(){return t.apply(w||this,arguments)}:function(){return t.apply(this,arguments)});void 0===g&&(h=[],g=0);if(f=a(t,n))return f;if(n instanceof Array)for(f=0;f<t.length;f++)n[n.length]=t[f]===t[f]?b(t[f],c,e,g+1,t):t[f];else{var f=0,E;for(E in t){if(s||t.hasOwnProperty(E))n[E]=t[E]===t[E]?b(t[E],c,e,g+1,t):t[E];f++}}c.proto&&(n.prototype=b(t.prototype,c,e,g+1,t));k&&(n.___copy_ref=t);return n}function g(a,
c,e,b,w,s,f,h){e=e||{};void 0===e.hasOwn&&(e.hasOwn=!0);if(!e.objectsOnly||a instanceof Object)if(void 0===h||h){void 0!==h&&h--;if(!e||!e.nodes)try{if(a instanceof Node)return}catch(v){if(a instanceof ActiveXObject&&void 0!==a.nodeType)return}if(a!==d){void 0===b&&(n=[],b=0);var k;a:{for(k=0;k<b&&k<n.length;k++)if(a===n[k]){k=!0;break a}k=!1}if(!(k||(n[b]=a,w=w||a,w&&s&&w[s]!==w[s]||c(a,w,s,f)))){s=0;k="";for(var J in a){if(!e.hasOwn||a.hasOwnProperty(J))try{var l=a[J];e.track&&(k=f?f+"."+J:J);g(l,
c,e,b+1,w,J,k,h)}catch(O){}s++}}}}}var s=f.Define,c=f.Cookie,e=function(){},d=s.global();s.clazz("qubit.opentag.Utils",e);e.global=s.global;e.namespace=s.namespace;e.clazz=s.clazz;e.getObjectUsingPath=function(a,c){c=c||d;for(var e=a.split("."),b=0;b<e.length;b++)c&&e[b]&&(c=c[e[b]]);return c};e.getParentObject=function(a){var c=a.lastIndexOf(".");a=a.substring(0,c);return e.getObjectUsingPath(a)};e.variableExists=function(a){return void 0!==a&&null!==a};e.ANON_VARS=[];e.getAnonymousAcessor=function(a){var c=
e.indexInArray(a,e.ANON_VARS);-1===c&&(c=e.addToArrayIfNotExist(e.ANON_VARS,a));return"qubit.opentag.Utils.ANON_VARS["+c+"]"};e.replaceAll=function(a,c,e){return a.replace(new RegExp(c.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1"),"g"),e)};e.secureText=function(a){"string"!==typeof a&&(a+="");a=a.replace(/</g,"&lt;");return a=a.replace(/>/g,"&gt;")};e.getUrl=function(){return document.location.href};e.getQueryParam=function(a){var c,b,g,w;c=e.getUrl();if(0<c.indexOf("?"))for(w=c.substring(c.indexOf("?")+
1).split("&"),c=0,b=w.length;c<b;c+=1)if(g=w[c],0<g.indexOf("=")&&(g=g.split("="),2===g.length&&g[0]===a))return g[1];return null};e.getElementValue=function(a){return(a=document.getElementById(a))?a.textContent||a.innerText:null};var h=[];e.objectCopy=function(a,c){c=c||{};var e=b(a,c,c.maxDeep);h=[];return e};var n=[];e.traverse=function(a,c,e){g(a,c,e,void 0,void 0,void 0,void 0,e.maxDeep)};e.prepareQuotedString=function(a){return"string"===typeof a?'"'+a.replace(/\"/g,'\\"')+'"':a};e.expressionToFunction=
function(a,c){return e.gevalAndReturn("function ("+(c||"")+") {"+a+"}").result};e.defineWrappedClass=function(a,c,e,b,g){var w=function(){return g?g.apply(this,arguments):c.apply(this,arguments)};s.clazz(a,w,c,b);for(var n in e)e.hasOwnProperty(n)&&"CONSTRUCTOR"!==n&&(w.prototype[n]=e[n]);return w};e.copyAandAddFromB=function(a,c,e){a=this.objectCopy(a,{maxDeep:e||8});for(var b in c)c.hasOwnProperty(b)&&(a[b]=c[b]);return a};e.keys=function(a){if(a instanceof Object){if(Object.keys)return Object.keys(a);
var c=[],e;for(e in a)a.hasOwnProperty(e)&&(c[c.length]=e);return c}throw"keys() called on non-object!";};e.getSrcElement=function(a){var c;a=a||window.event;a.srcElement?c=a.srcElement:a.target&&(c=a.target);return c};e.addToArrayIfNotExist=function(a,c,e){for(var b=0,g=!1;b<a.length;b+=1)if(e&&e(a[b],c)||a[b]===c){g=!0;break}g||(a[a.length]=c,b=-1);return b};e.indexInArray=function(a,c){for(var e=0,b=!1;e<a.length;e++)if(a[e]===c){b=!0;break}return b?e:-1};e.removeFromArray=function(a,c){for(var e=
0,b=0;e<a.length;)a[e]===c?(a.splice(e,1),b++):e++;return b};e.addClass=function(a,c){var b;try{a.classList.add(c)}catch(g){null===a.className?a.className=c:(b=a.className.split(" "),e.addToArrayIfNotExist(b,c),a.className=b.join(" "))}};e.removeClass=function(a,c){var b;try{a.classList.remove(c)}catch(g){null===a.className?a.className="":(b=a.className.split(" "),e.removeFromArray(b,c),a.className=b.join(" "))}};e.gevalAndReturn=function(a){var c=m;c.qubitopentagutilsgevalandreturn__var_test__=void 0;
c.qubitopentagutilsgevalandreturn__var_test__error=void 0;e.geval("try{this.qubitopentagutilsgevalandreturn__var_test__=("+a+");}catch(ex){this.qubitopentagutilsgevalandreturn__var_test__error = ex;}");a=c.qubitopentagutilsgevalandreturn__var_test__;var b=c.qubitopentagutilsgevalandreturn__var_test__error;try{c.qubitopentagutilsgevalandreturn__var_test__=void 0,c.qubitopentagutilsgevalandreturn__var_test__error=void 0,delete c.qubitopentagutilsgevalandreturn__var_test__,delete c.qubitopentagutilsgevalandreturn__var_test__error}catch(g){}return{result:a,
error:b}};e.trim=function(a){try{return String(a).trim()}catch(c){return String(a).replace(/^\s+|\s+$/g,"")}};e.setIfUnset=function(a,c){if(a&&c)for(var e in c)c.hasOwnProperty(e)&&!a.hasOwnProperty(e)&&(a[e]=c[e])};e.overrideFromLeftToRight=function(a,c){if(a&&c)for(var e in c)c.hasOwnProperty(e)&&(a[e]=c[e]);return a};e.geval=function(a){return window&&window.execScript?window.execScript(""===a?" ":a):d.eval.call(d,a)};var v=[];e.bodyAvailable=function(a){if(document.body){if(v){for(var c=0;c<v.length;c++)try{v[c]()}catch(e){}v=
!1}a()}else v.push(a)};e.rmCookiesMatching=function(a){for(var e=c.getAll(),b=0;b<e.length;b++){var g=e[b][0];0===g.match(a)&&c.rm(g)}};var k=[],l=!1,F=!1;e.bodyReady=function(a){if(F)return a&&a(),!0;if(l=l||!(!document.body||"complete"!==document.readyState)){F=!0;for(var c=0;c<k.length;c++)try{k[c]()}catch(e){}a&&a()}else a&&k.push(a);return l};var w=d.onload;d.onload=function(a){try{e.bodyReady()}catch(c){try{window.qubit.opentag.Utils.bodyReady()}catch(b){}}var g=!1;try{g=w}catch(n){}g&&g(a)};
(function(){var a,c=!1,b=1,g,w,n,s;w=function(a){!0===a&&(b-=1);if(!b||!0!==a&&!c){if(!document.body)return setTimeout(w,1);c=!0;if(!0!==a&&(b-=1,0<b))return;for(;0<g.length;)a=g.shift(),a()}};s=function(){if(!c){try{document.documentElement.doScroll("left")}catch(a){setTimeout(s,1);return}w()}};n=function(){if(!g){g=[];if("complete"===document.readyState)return setTimeout(w,1);if(document.addEventListener)document.addEventListener("DOMContentLoaded",a,!1),window.addEventListener("load",w,!1);else if(document.attachEvent){document.attachEvent("onreadystatechange",
a);window.attachEvent("onload",w);var c=!1;try{c=null===window.frameElement||void 0===window.frameElement}catch(e){}document.documentElement.doScroll&&c&&s()}}};document.addEventListener?a=function(){document.removeEventListener("DOMContentLoaded",a,!1);w()}:document.attachEvent&&(a=function(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",a),w())});(function(a){n();c?setTimeout(a,1):g.push(a)})(function(){l=!0;e.bodyReady()})})()})();(function(){function a(c,e,b){this.collectLogs=
!!a.isCollecting();this.collectLocally=b;this.collection=[];this.getPrefix=function(){var a="";e&&("function"===typeof e?a=e(this.ref):e.CLASS_NAME?a=e.CLASS_NAME:e.constructor&&e.constructor.name&&(a=e.constructor.name),a&&(a+=" -> "));return(c||"")+a}}function b(e,g,t,n,s,d,f,z){var h=c>=z;if(0<=a.getCollectLevel()||h)g=s?[n,f,t]:[g+e.getPrefix()+n,d,t],g[3]=z,e.collect(g,z),h&&e.printMessage.apply(e,g)}var g=f.Define,s=null;g.clazz("qubit.opentag.Log",a);a.LEVEL_FINEST=4;a.LEVEL_FINE=3;a.LEVEL_INFO=
2;a.LEVEL_WARN=1;a.LEVEL_ERROR=0;a.LEVEL_NONE=-1;a.MAX_LOG_LEN=1E4;a.prototype.MAX_LOG_LEN=-1;var c=a.LEVEL_NONE,e=a.LEVEL_NONE,d=!0;a.setLevelFromCookie=function(){var c=f.Cookie.get("qubit.opentag.Log.LEVEL");if(c&&(c=+c,!isNaN(c)&&0<c)){var e=a.LEVEL_FINE;a.setCollectLevel(c>e?c:e);a.setLevel(+c)}};a.setCollecting=function(a){d=!!a};a.isCollecting=function(){return d||a.COLLECT};a.setLevel=function(a){c=+a};a.setCollectAndLevel=function(c){a.setLevel(c);a.setCollectLevel(c)};a.getLevel=function(){return c};
a.setCollectLevel=function(a){e=+a};a.getCollectLevel=function(){return e};var h=[];a.logsCollection=h;a.rePrintAll=function(e,b,g,n){var d=c;void 0!==e&&(c=e);try{if(a.isCollecting()){try{g||s.clear()}catch(z){}var h=n||a.logsCollection,v=0;for(g=0;g<h.length;g++)(function(g){var t=h[g];g=t[3];void 0!==g&&c>=g&&(v++,b?f.opentag.Timed.setTimeout(function(){void 0!==e&&(c=e);try{a.print.apply(a,t)}finally{c=d}},v*b):a.print.apply(a,t))})(g)}}catch(k){}finally{c=d}};var n=g.global(),v=!!(n.webkitMediaStream||
n.webkitURL||n.mozContact);a.isStyleSupported=function(){return v};var k={};a.setConsole=function(a){return s=a||k};a.delayPrint=-1;var l=(new Date).valueOf();a.prototype.printMessage=function(c,e,b,g){if(0<a.delayPrint){var n=a.delayPrint,s=l-(new Date).valueOf();0<s&&(n+=s);try{f.opentag.Timed.setTimeout(function(){this.print(c,e,b,g)}.bind(this),n)}catch(d){setTimeout(function(){this.print(c,e,b,g)}.bind(this),n)}l=(new Date).valueOf()+n}else this.print(c,e,b,g)};a.prototype.print=function(c,e,
b,g){a.print(c,e,b,g)};a.print=function(e,b,g,n){if(!(void 0!==n&&c<n))try{if(s&&s.log)if(b&&a.isStyleSupported())if(g&&s[g])s[g]("%c"+e,b);else s.log("%c"+e,b);else if(g&&s[g])s[g](e);else s.log(e)}catch(d){}};a.prototype.collect=function(c,e){void 0===e&&(e=a.getCollectLevel());var b=!1,g=this.collectLogs&&a.isCollecting()&&a.getCollectLevel()>=+e;g&&(h.push(c),b=!0);this.collectLocally&&g&&(this.collection.push(c),b=!0);0<a.MAX_LOG_LEN&&h.length>a.MAX_LOG_LEN&&h.splice(0,h.length-a.MAX_LOG_LEN);
if(0<a.MAX_LOG_LEN||0<this.MAX_LOG_LEN)g=a.MAX_LOG_LEN,0<this.MAX_LOG_LEN&&(g=this.MAX_LOG_LEN),this.collection.length>g&&this.collection.splice(0,this.collection.length-g);return b?c:null};a.clearAllLogs=function(){try{s.clear()}catch(a){}finally{h.splice(0,h.length)}};a.getCollectedByLevel=function(a,c){c=c||h;for(var e=[],b=0;b<c.length;b++){var g=c[b];g[0][4]===a&&e.push(g)}return e};a.prototype.rePrint=function(c,e,b){a.rePrintAll(c,e,!b,this.collection)};a.prototype.FINEST=function(c,e){b(this,
"FINEST: ",!1,c,e,"color:#CCCCCC;",!1,a.LEVEL_FINEST)};a.prototype.FINE=function(c,e){b(this,"FINE: ",!1,c,e,"color:#999999;",!1,a.LEVEL_FINE)};a.prototype.INFO=function(c,e,g){b(this,"INFO: ","info",c,e,g,g,a.LEVEL_INFO)};a.prototype.WARN=function(c,e){b(this,"WARN: ","warn",c,e,"color:#26A110;",!1,a.LEVEL_WARN)};a.prototype.ERROR=function(c,e){b(this,"ERROR: ","error",c,e,"color:red;",!1,a.LEVEL_ERROR)};a.setConsole(g.global().console);a.setLevelFromCookie()})();(function(){function a(a){a&&(this._rate=
a.rate||10,this._smallestRate=-1,a.start&&this.startPooling(),this.config=a);this.inervals=[];this._lck_obj={};this._binded_pool=this._pool.bind(this)}f.Define.clazz("qubit.opentag.Timer",a);a.prototype.timers=[];a.prototype.startPooling=function(a){a&&this.config.dynamic&&(0>this._smallestRate||this._smallestRate>a)&&(this._smallestRate=Math.min(Math.floor(a/2),1500));this.started||(this.started=!0,setTimeout(this._binded_pool,0))};a.prototype._pool=function(){this.maxFrequent(function(){},5E3,this._lck_obj);
this.callTimers();0!==this.timers.length?setTimeout(this._binded_pool,this._smallestRate>this._rate?this._smallestRate:this._rate):(this.started=!1,this._smallestRate=-1)};a.prototype.callTimers=function(){this.lastCalled=(new Date).valueOf();for(var a=0;a<this.timers.length;a++){var b=this.timers[a];if((new Date).valueOf()>=b.time){try{b.execute()}catch(c){}this.timers.splice(a,1);--a}}};a.prototype.cancellAll=function(){this.timers=[]};a.prototype.setRate=function(a){this._rate=a};a.prototype.maxFrequent=
function(a,b,c){c||(a.__maxFrequent__timer_opentag_qubit_=a.__maxFrequent__timer_opentag_qubit_||{},c=a.__maxFrequent__timer_opentag_qubit_);var e=c.____last__timed__max__frequent____;if(!e||(new Date).valueOf()-e>b)e=(new Date).valueOf(),c.____last__timed__max__frequent____=e,a()};a.prototype.runIfNotScheduled=function(a,b,c){c=c||a;if(c.__lastRun__&&(new Date).valueOf()<b+c.__lastRun__)return this.schedule(a,b,c);c.__lastRun__=(new Date).valueOf();a();return!0};a.prototype.schedule=function(a,b,
c){if(c.___scheduled___)return!1;c.___scheduled___=(new Date).valueOf();this.setTimeout(function(){c.___scheduled___=!1;c.__lastRun__=(new Date).valueOf();a()},b);return!0};var b=1;a.prototype.setTimeout=function(a,s){var c={id:b++,time:(new Date).valueOf()+ +s,execute:a};this.timers.push(c);this.startPooling(s);return c};a.prototype.setInterval=function(a,b){var c=setInterval(a,b);this.inervals.push(c);return c}})();(function(){f.Define.namespace("qubit.opentag.Timed",new f.opentag.Timer({rate:37,
dynamic:!0}));var a=f.opentag.Timed;a.tillTrue=function(b,g,s){var c=function(){b()?g():a.setTimeout(c,s||33)};c()}})();var r;r=r||{};r.fileLoader={};r.fileLoader.load=function(a,b,g,s,c,e){var d,f,n,h;h=!1;n=function(c){return function(){h||(h=!0,c&&!f&&(f={url:document.location.href}),g(a,f,c))}};try{b&&(d=b(a))}catch(k){d=!1,g(a,"Exception loading pre",!0)}finally{!1!==d&&(b=r.fileLoader.createScriptEl(a,c,!1,e),g&&(b.onload=n(!1),b.onerror=n(!0),b.onreadystatechange=function(){"complete"!==this.readyState&&
"loaded"!==this.readyState||setTimeout(function(){n(!1)()},1)}),s||(s=window.document.getElementsByTagName("head")[0]),s.appendChild(b))}};r.fileLoader.createScriptEl=function(a,b,g,s){var c,e=document.createElement("script");e.type="text/javascript";e.src=r.fileLoader.tidyUrl(a)+(g?"?"+(new Date).getTime():"");!1!==b?(e.async="true",e.defer="true"):(e.async="false",!1!==e.async&&(e.async=!1),e.defer="false",!1!==e.defer&&(e.defer=!1));for(c in s)s.hasOwnProperty(c)&&e.setAttribute(c,s[c]);return e};
r.fileLoader.tidyUrl=function(a){return"http:"===a.substring(0,5)||"https:"===a.substring(0,6)?a:"//"+a};(function(){function a(a){this.log=new f.opentag.Log("",function(){return this.CLASS_NAME+"["+this.config.name+"]"}.bind(this),"collectLogs");this.config={order:0,include:!0,name:"Filter-"+g++,script:void 0,session:void 0};this.session=null;if(a){for(var e in a)a.hasOwnProperty(e)&&(this.config[e]=a[e]);a.session&&this.setSession(a.session);this.register(this)}}var b=f.opentag.Utils,g=0,s=[];f.Define.clazz("qubit.opentag.filter.BaseFilter",
a);a.state={DISABLED:-3,SESSION:-2,PASS:-1,FAIL:0};a.prototype.reset=function(){this.enable()};a.prototype.disable=function(){this.config.disabled=!0};a.prototype.enable=function(){this.config.disabled=!1};a.prototype.match=function(){return!0};a.prototype.setSession=function(a){this.session=a};a.prototype.getSession=function(){return this.session};a.prototype.getState=function(){var c=a.state.PASS;if(this.config.disabled)return a.state.DISABLED;this.config.script&&(c=this.config.script.call(this,
c));isNaN(+c)&&(c=a.state.FAIL);this.lastState=+c;return c};a.getFilters=function(){return s};a.prototype.register=function(){a.register(this)};a.register=function(a){b.addToArrayIfNotExist(s,a)}})();f.Define.namespace("qubit.opentag.filter.pattern.PatternType",{CONTAINS:"CONTAINS",MATCHES_EXACTLY:"MATCHES_EXACTLY",STARTS_WITH:"STARTS_WITH",ENDS_WITH:"ENDS_WITH",REGULAR_EXPRESSION:"REGULAR_EXPRESSION",ALL_URLS:"ALL_URLS"});(function(){function a(b){this._lockObject={};var c={patternType:g.CONTAINS,
pattern:""};if(b)for(var e in b)b.hasOwnProperty(e)&&(c[e]=b[e]);a.SUPER.call(this,c)}var b=f.opentag.Utils,g=f.opentag.filter.pattern.PatternType;f.Define.clazz("qubit.opentag.filter.URLFilter",a,f.opentag.filter.BaseFilter);a.prototype.PATTERNS=g;a.prototype.getURL=function(a){return a||b.getUrl()};a.prototype.match=function(a){a=this.getURL(a);var c=!0,e=this.config.pattern;switch(this.config.patternType){case g.CONTAINS:c=0<=a.toLowerCase().indexOf(e.toLowerCase());break;case g.MATCHES_EXACTLY:c=
a.toLowerCase()===this.config.pattern.toLowerCase();break;case g.STARTS_WITH:c=0===a.toLowerCase().indexOf(e.toLowerCase());break;case g.ENDS_WITH:c=a.lastIndexOf(e.toLowerCase())+e.length===a.length;break;case g.REGULAR_EXPRESSION:c=(new RegExp(e)).test(a);break;case g.ALL_URLS:c=!0}return c}})();(function(){function a(c){var e={};if(c){for(var b in c)c.hasOwnProperty(b)&&("customStarter"===b&&c[b]?this.customStarter=c[b]:"customScript"===b&&c[b]&&(this.customScript=c[b]),e[b]=c[b]);this.uid="f"+
d++}this.tagsToRun=[];a.SUPER.call(this,e)}var b=f.opentag.filter.BaseFilter,g=f.opentag.Utils,d=0;f.Define.clazz("qubit.opentag.filter.Filter",a,f.opentag.filter.URLFilter);a.prototype.customStarter=function(a,e,b){e(!1)};a.prototype.isSession=function(){return this.config.sessionDisabled||null===this.customStarter&&null===this.customScript?!1:!0};a.prototype.customScript=function(a){return!0};a.prototype.match=function(c){var e=!0;try{this.customScript&&(void 0===this._matchState&&(this._matchState=
!!this.customScript(this.getSession())),e=this._matchState)}catch(b){e=!1}return e&&a.SUPER.prototype.match.call(this,c)};a.prototype.runTag=function(c){g.addToArrayIfNotExist(this.tagsToRun,c);if(this.starterExecuted)this._triggerTag(c);else if(!this._starterWasRun){this._starterWasRun=!0;var e=function(a){this.reRun=a;this.starterExecuted=(new Date).valueOf();this._processQueuedTagsToRun()}.bind(this);this.customStarter?this.customStarter(this.getSession(),e,c):a.prototype.customStarter.call(this,
this.getSession(),e,c)}};a.prototype._processQueuedTagsToRun=function(){for(var a=0;a<this.tagsToRun.length;a++)this._triggerTag(this.tagsToRun[a])};a.prototype._triggerTag=function(a){!0===this.reRun?a.run():a.runOnce()};a.prototype.getState=function(c){c&&this.setSession(c);c=a.SUPER.prototype.getState.call(this);if(c===b.state.DISABLED)return b.state.DISABLED;c===b.state.PASS&&this.isSession()&&(c=b.state.SESSION);this.config.script&&(c=this.config.script.call(this,c,this.getSession()));return this.lastState=
c};a.prototype.reset=function(){this._matchState=void 0;a.SUPER.prototype.reset.call(this);this.starterExecuted=this._starterWasRun=void 0;this.tagsToRun=[];this.reRun=void 0}})();r.GlobalEval={};r.GlobalEval.globalEval=function(a){window.execScript?window.execScript(""===a?" ":a):window.eval.call(window,a)};r.HtmlInjector={};r.HtmlInjector.inject=function(a,b,g,d,c){var e,f,h,n;if(0<=g.toLowerCase().indexOf("<script")){c=document.createElement("div");c.innerHTML="a"+g;f=c.getElementsByTagName("script");
h=[];g=0;for(e=f.length;g<e;g+=1)h.push(f[g]);n=[];g=0;for(e=h.length;g<e;g+=1){f=h[g];var v={attributes:r.HtmlInjector.getAttributes(f)};f.src?v.src=f.src:v.script=f.innerHTML;n.push(v);f.parentNode.removeChild(f)}c.innerHTML&&0<c.innerHTML.length&&(c.innerHTML=c.innerHTML.substring(1));r.HtmlInjector.doInject(a,b,c);r.HtmlInjector.loadScripts(n,0,d,a)}else c=document.createElement("div"),c.innerHTML=g,r.HtmlInjector.doInject(a,b,c),d&&d()};r.HtmlInjector.doInject=function(a,b,g){if(0<g.childNodes.length){for(var d=
document.createDocumentFragment();0<g.childNodes.length;)d.appendChild(g.removeChild(g.childNodes[0]));b?r.HtmlInjector.injectAtStart(a,d):r.HtmlInjector.injectAtEnd(a,d)}};r.HtmlInjector.injectAtStart=function(a,b){0===a.childNodes.length?a.appendChild(b):a.insertBefore(b,a.childNodes[0])};r.HtmlInjector.injectAtEnd=function(a,b,g){g||(g=1);a===document.body&&"complete"!==document.readyState&&50>g?setTimeout(function(){r.HtmlInjector.injectAtEnd(a,b,g+1)},100):a.appendChild(b)};r.HtmlInjector.loadScripts=
function(a,b,g,d){var c,e,f=!1;for(c=a.length;b<c;b+=1)if(e=a[b],e.src){f=!0;break}else r.GlobalEval.globalEval(e.script);f&&r.fileLoader.load(e.src,null,function(){r.HtmlInjector.loadScripts(a,b+1,g,d)},d,!1,e.attributes);g&&b===c&&g()};r.HtmlInjector.getAttributes=function(a){var b,g,d,c,e={};if(a){g=a.attributes;b=g.length;for(a=0;a<b;a++)d=g[a].value,c=g[a].name.toLowerCase(),""===d||"id"!==c&&"class"!==c&&"charset"!==c&&"data-"!==c.substr(0,5)||(e[c]=d);return e}};(function(){function a(){l=
l||{write:document.write,writeln:document.writeln}}function b(){document.write=l.write;document.writeln=l.writeln;l=null}var g=f.opentag.filter.BaseFilter,d=f.opentag.Utils,c=r.HtmlInjector,e=r.fileLoader,h=f.opentag.filter.Filter,k=function(){};f.Define.clazz("qubit.opentag.TagsUtils",k);var n=!1;k.bodyLoaded=function(){return n?!0:n=!(!document.body||"loading"===document.readyState)};k.bodyAvailable=function(a){return!!document.body};var v={};k.loadScript=function(a){var c=a.url,b=function(b,e,
g){v[c].error=e;g?(v[c].state="failure",a.onerror()):(v[c].state="success",a.onsuccess())};if(v[c]){if(a.noMultipleLoad)return b(c,v[c].error,"failure"===v[c].state);v[c].count+=1}else v[c]={count:1,state:null};var g=!a.async,t=k.bodyLoaded();g&&!t?k.writeScriptURL(c,function(a,e){b(c,e,!a)}):e.load(c,!1,b,a.node,a.async)};var l=null;k.redirectDocumentWritesToArray=function(c,b){a();document.write=function(a){c.push(a)};document.writeln=function(a){c.push(a)}};k.flushDocWritesArray=function(a,c,b,
e,g){if(c&&a){a=a.splice(0,a.length);try{return k.injectHTML(c,b,a.join("\n"),g||p),!0}catch(t){}}else return!1;g&&g();return!0};k.unlockDocumentWrites=function(){l&&b()};var E=k.prototype.PACKAGE_NAME+".TagsUtils._writeScriptURL_callbacks",F={};f.Define.namespace(E,F,m,!0);var w=0,t=(new Date).valueOf();k.writeScriptURL=function(c,g){var n="_"+t+"_"+w++,A=E+"."+n,f=!1;F[n]=function(a){f||(f=!0,a?g(!1,"error while loading script "+c):g(!0),F[n]=void 0,delete k.writeScriptURL.callbacks[n])};var h=
'if(this.readyState === "loaded" || this.readyState === "complete"){ try {'+A+"(true)} catch (ex) {}}",z="try{"+A+"(false)}catch(ex){}",A="try{"+A+"(true)}catch(ex){}";c=e.tidyUrl(c);h="<script onload='"+z+"'  onerror='"+A+"' onreadystatechange='"+h+"' type='text/javascript'  src='"+c+"'>\x3c/script>";l?(b(),document.write(h),a()):document.write(h);d.bodyReady(function(){f||(f=!0,g(!0))})};k.writeScriptURL.callbacks={};var A=g.state.SESSION,C=g.state.PASS,N=g.state.FAIL;k.filtersState=function(a,
c,b,e){a=a.sort(function(a,c){try{var b=c.config.order,e=a.config.order;isNaN(-e)&&(e=0);isNaN(-b)&&(b=0);return b-e}catch(g){return 0}});var t=C;if(!a||0===a.length)return t;for(var t=null,n=!1,w=!1,d=0,f,s,k=[],v,l,J=0;J<a.length;J++)if(v=a[J],v.setSession(c),v.match())if(f=v.getState(),0<f){if(0===d||d>f)d=f}else f===g.state.DISABLED?n=!0:f===A?(w=!0,s=t=v,k.push(v)):t=v;else l=v;a=!1;null===t?(a=!0,t=n?C:N):t=t.config.include?f:f===C?N:C;0<d&&(t===C||a)&&(t=d);if(t===A||t===C&&w){if(!s.config.include)return N;
t=A;if(s instanceof h&&s.isSession()&&e)for(e=0;e<k.length;e++)try{k[e].runTag(b)}catch(E){}}b.config.dedupe&&t===C&&l&&l instanceof h&&l.isSession()&&(b.sendDedupePing=!0,t=N);return t};k.injectHTML=function(a,b,e,g){return c.inject(a,b?0:1,e,g||p)};k.getHTMLLocationForTag=function(a){a=a.prepareLocationObject(a.config.locationObject);switch(a){case "HEAD":a=document.getElementsByTagName("head")[0];break;case "BODY":a=document.body;break;default:a=a?document.getElementById(a):document.body}return a}})();
(function(){function a(b){this.config={};this.handlers=[];this.parameters=null;this.callHandlersOnRead=!1;if(b){this.uniqueId="BV"+c++;a.ALL_VARIABLES[this.uniqueId]=this;for(var e in b)b.hasOwnProperty(e)&&(this.config[e]=b[e],"value"===e&&(this.value=b.value));return a.register(this)}}function b(){if(h)return!1;for(var c=0;c<e.length;c++)try{e[c].getValue()}catch(g){}d.setTimeout(b,a.CHECK_POLL_RATE);return!0}var g=f.opentag.Utils,d=f.opentag.Timed,c=0;f.Define.clazz("qubit.opentag.pagevariable.BaseVariable",
a);a.ALL_VARIABLES={};var e=[];a.OBSERVED_VARIABLES=e;a.pageVariables=[];a.register=function(c){if(c instanceof a){for(var b=0;b<a.pageVariables.length;b++){var e=a.pageVariables[b];if(c===e)return e}a.pageVariables.push(c);return c}return null};a.prototype.getValue=function(){this._updateCurrentValue(this.value);return this.currentValue};a.prototype._updateCurrentValue=function(a){return this.valuesAreEqual(a,this.currentValue)?!1:(this.oldValue=this.currentValue,this.currentValue=a,h&&!this.callHandlersOnRead||
this._handleValueChanged(),!0)};a.prototype.getDefaultValue=function(){return this.defaultValue};a.prototype.setDefaultValue=function(a){this.defaultValue=a};a.prototype.exists=function(a){var c=g.variableExists(this.getValue());a&&(c=c||g.variableExists(this.getDefaultValue()));return c};a.prototype.getRelativeValue=function(a,c){var b=this.getValue();g.variableExists(b)||(b=c);var e;a&&!g.variableExists(b)&&(e=this.getDefaultValue(),g.variableExists(e)&&(b=e));return b};a.prototype.replaceToken=
function(a,c,b,e){var d=this.exists();b=d?this.getValue():b;a="\\$\\{"+a+"\\}";return e||b instanceof Array?(e=d?this.getValueAccessorString():g.getAnonymousAcessor(b),c.replace(new RegExp(a,"g"),e)):c.replace(new RegExp(a,"g"),b)};a.prototype.getAccessorString=function(){return"qubit.opentag.pagevariable.BaseVariable.ALL_VARIABLES."+this.uniqueId};a.prototype.getValueAccessorString=function(){return this.getAccessorString()+".getValue()"};a.prototype.onValueChanged=function(a,c){g.addToArrayIfNotExist(this.handlers,
a);!1!==c&&this.startObservingForChanges()};a.prototype.deatchOnValueChanged=function(a){g.removeFromArray(this.handlers,a)};a.prototype._handleValueChanged=function(){for(var a={oldValue:this.oldValue,newValue:this.currentValue,variable:this},c=0;c<this.handlers.length;c++)try{this.handlers[c](a)}catch(b){}};var h=!0;a.CHECK_POLL_RATE=333;a.prototype.startObservingForChanges=function(){this.addToObservedVariables();h&&(h=!1,b())};a.prototype.stopObservingForChanges=function(){this.removeFromObservedVariables();
0===e.length&&(h=!0)};a.prototype.addToObservedVariables=function(){g.addToArrayIfNotExist(e,this)};a.prototype.removeFromObservedVariables=function(){g.removeFromArray(e,this)};a.prototype.getObservedVariables=function(){return e};a.prototype.valuesAreEqual=function(a,c){return a===c}})();(function(){function a(b){this._lockExprObject={};a.SUPER.apply(this,arguments)}var b=f.opentag.Utils;f.Define.clazz("qubit.opentag.pagevariable.Expression",a,f.opentag.pagevariable.BaseVariable);a.prototype.getValue=
function(){var g,d,c=this.value;try{if(c&&-1===c.indexOf("[#]")){var e=b.gevalAndReturn(c);g=e.result;this.failMessage=null;d=e.error}else g=a.parseUVArray(c)}catch(f){d=f}d&&(g="could not read value of expression: \n"+c+"\nexact cause: "+d,this.failMessage!==g&&(this.failMessage=g),g=null);this._updateCurrentValue(g);return g};a.parseUVArray=function(a){var d=a.split("[#]");a=b.gevalAndReturn(d[0]).result;var c=[],d=d[1];0===d.indexOf(".")&&(d=d.replace(".",""));for(var e=0;e<a.length;e++){var f=
b.getObjectUsingPath(d,a[e]);c.push(f)}return c};a.prototype.replaceToken=function(b,d,c,e){this.getValue()instanceof Array&&(e=!0);return a.SUPER.prototype.replaceToken.call(this,b,d,c,e)}})();(function(){function a(b){a.SUPER.apply(this,arguments)}var b=f.opentag.Utils;f.Define.clazz("qubit.opentag.pagevariable.DOMText",a,f.opentag.pagevariable.BaseVariable);a.prototype.getValue=function(){var a=b.getElementValue(this.value);this._updateCurrentValue(a);return a}})();(function(){function a(b){a.SUPER.apply(this,
arguments);this._lockObject={}}f.Define.clazz("qubit.opentag.pagevariable.Cookie",a,f.opentag.pagevariable.BaseVariable);a.prototype.getValue=function(){var a=f.Cookie.get(this.value);this._updateCurrentValue(a);return a}})();(function(){function a(b){a.SUPER.apply(this,arguments)}var b=f.opentag.Utils;f.Define.clazz("qubit.opentag.pagevariable.URLQuery",a,f.opentag.pagevariable.BaseVariable);a.prototype.getValue=function(){var a=b.getQueryParam(this.value);this._updateCurrentValue(a);return a}})();
(function(){function a(){}function b(a,c){var e=[];try{var g=a.parameters;if(g)for(var d=0;d<g.length;d++)a.getVariableForParameter(g[d])===c&&e.push(g[d])}catch(t){}return e}var g=f.opentag.Utils,d=f.opentag.TagsUtils,c=f.opentag.pagevariable.BaseVariable,e=f.opentag.pagevariable.Expression,h=f.opentag.pagevariable.DOMText,k=f.opentag.pagevariable.Cookie,n=f.opentag.pagevariable.URLQuery;f.Define.clazz("qubit.opentag.TagHelper",a);a.injectHTMLForLoader=function(a,c,b,e){if(e=void 0!==e?e:a.getHtml()){var g=
"END"===a.config.locationPlaceHolder,t=d.getHTMLLocationForTag(a);a.injectHTMLNotFinished=!0;try{t?d.injectHTML(t,g,e,function(){a.injectHTMLNotFinished=!1;if(c)try{c()}catch(b){}}.bind(a)):b&&"loading"===document.readyState?(document.write(e),a.injectHTMLNotFinished=!1):a.injectHTMLFailed=(new Date).valueOf()}catch(n){a.injectHTMLNotFinished=!1,a.injectHTMLFailed=(new Date).valueOf()}}};a.getAllVariablesWithParameters=function(a){for(var c=a.getPageVariables(),e=[],g=0;g<c.length;g++)for(var d=c[g],
t=b(a,d),n=0;n<t.length;n++)e.push({parameter:t[n],variable:d});return e};a.allParameterVariablesReadyForTag=function(a,c){for(var e=!0,g=a.getPageVariables(),d=0;d<g.length;d++){var t=g[d];try{var n=b(a,t),f=t.exists();!f&&c&&(0<n.length&&(f=!!n[0].defaultValue),f=f||t.exists(!0));if(!f){e=!1;break}}catch(h){e=!1;break}}return e};a.validateAndGetVariableForParameter=function(c){c.hasOwnProperty("variable")&&c.variable&&(c.variable=a.initPageVariable(c.variable));return c.variable};a.initPageVariable=
function(a){if(!a||a instanceof c)return a;if("string"===typeof a){var b=g.getObjectUsingPath(a);if(b&&b instanceof c)return b}switch(a.type){case "2":return new e(a);case "3":return new n(a);case "4":return new k(a);case "5":return new h(a);case "EPRESSION":return new e(a);case "URL_PARAMETER":return new n(a);case "COOKIE_VALUE":return new k(a);case "DOM_VALUE":return new h(a);default:return new c(a)}}})();(function(){function a(a){this.calls={}}var b=f.Define,g=f.opentag.Utils;a.prototype.on=function(a,
c){this.calls[a]||(this.calls[a]=[]);return g.addToArrayIfNotExist(this.calls[a],c)};a.prototype.call=function(a,c){var b=this.calls[a];if(b)for(var g=0;g<b.length;g++)try{b[g](c)}catch(d){}};a.prototype.remove=function(a,c){return this.calls[a]?g.removeFromArray(this.calls[a],c):null};a.prototype.removeAll=function(a){var c=0,b;for(b in this.calls)this.calls.hasOwnProperty(b)&&(c+=g.removeFromArray(this.calls[b],a));return c};a.prototype.clear=function(){this.calls={}};b.clazz("qubit.Events",a)})();
(function(){function a(a){this.log=new k("",function(){return this.CLASS_NAME+"["+this.config.name+"]"}.bind(this),"collectLogs");this.runCounter=this.urlsFailed=this.urlsLoaded=0;this.events=new f.Events({});this._depLoadedHandler=function(){this.dependenciesLoaded()&&this.awaitingDependencies&&this._triggerLoadingAndExecution()}.bind(this);this.config={name:"Tag-"+h++,async:!0,usesDocumentWrite:!1,timeout:this.LOADING_TIMEOUT,dependencies:[],url:null,urlLocation:null,locationPlaceHolder:"END",locationObject:null,
dontWaitForInjectionLocation:!1,noMultipleLoad:!1,loadDependenciesOnLoad:!1};this.delayDocWrite=!1;this.dependencies=[];this._lockObject={count:0};this._lockObjectDepsLoaded={};this.genericDependencies=[];if(a){if(!a.name){var c="Tag-"+h++;this.config.name=c}this.addState("INITIAL");for(var b in a)this.config[b]=a[b];a.genericDependencies&&(this.genericDependencies=this.genericDependencies.concat(a.genericDependencies));a.dependencies&&(this.dependencies=a.dependencies.concat(this.dependencies));
a.PACKAGE&&(this._package=a.PACKAGE);this.onInit()}}function b(){if(this.cancelled)this._handleCancel();else{this.waitForDependenciesFinished=(new Date).valueOf();var a=this._fullBodyNeededAndUnLoaded(),c=this._bodyNeededButNotAvailable();a||c?this.waitForDependenciesFinished=!1:(this.timeoutCountdownStart||(this.timeoutCountdownStart=(new Date).valueOf()),this.allDependenciesLoaded()?this._markLoadedSuccesfuly():this._loadingOutOfTimeFrames()?(this.loadingTimedOut=(new Date).valueOf(),this.allDependenciesLoaded(!0)?
this._markLoadedSuccesfuly():(this.addState("TIMED_OUT"),this._markLoadingDependenciesFailed(),this._triggerOnLoadTimeout())):this.waitForDependenciesFinished=!1);this.waitForDependenciesFinished?this.addState("LOADED_DEPENDENCIES"):this._setTimeout(b.bind(this),65)}}var g=f.opentag.Utils,d=f.opentag.TagsUtils,c=f.opentag.Timed,e=f.opentag.TagHelper,h=0,k=f.opentag.Log;f.Define.clazz("qubit.opentag.GenericLoader",a);a.prototype.onInit=p;a.prototype.LOADING_TIMEOUT=5E3;a.prototype.getHtml=function(){return this.config.html?
this.config.html:this.htmlContent?g.trim(this.htmlContent):null};a.prototype._executeScript=function(){var a=!1;try{this.script(),a=!0}catch(c){this.addState("EXECUTED_WITH_ERRORS"),this.executedWithErrors=(new Date).valueOf(),this._onError(c)}finally{this._onExecute(a)}};a.prototype.getTimeout=function(){return this._getTimeout()};a.prototype._getTimeout=function(a){var c=+this.config.timeout,b=this.dependencies;if(-1!==c&&0<b.length){var e=0;a=a||[];if(-1===g.indexInArray(a,this)){a[a.length]=this;
for(var d=0;d<b.length;d++){var w=b[d]._getTimeout(a);w>e&&(e=w)}0<e&&(c+=e)}else return 0}return c};a.prototype._onExecute=function(a){this.onExecute(a)};a.prototype.onExecute=p;a.prototype._flushDocWrites=function(a){var c=!0;this._docWriteNotFlushed=!1;try{var b=d.getHTMLLocationForTag(this);b&&this._securedWrites&&0<this._securedWrites.length&&((c=d.flushDocWritesArray(this._securedWrites,b,"END"===this.config.locationPlaceHolder,this.log,a))?this._docWriteFlushed=(new Date).valueOf():this._docWriteNotFlushed=
(new Date).valueOf())}catch(e){this._onError(e)}a&&a();this._securedWrites&&0<this._securedWrites.length&&(c=!1,this._docWriteNotFlushed=(new Date).valueOf());return c};a.prototype.log=p;a.prototype.finished=function(){return!!this.runIsFinished};a.prototype.script=function(){};a.prototype.before=function(){this.beforeRun=(new Date).valueOf();try{this.events.call("before",this)}catch(a){this._onError(a)}};a.prototype.onBefore=function(a){this.events.on("before",a)};a.prototype.after=function(a){this.afterRun=
(new Date).valueOf();try{this.events.call("after",{success:a,tag:this})}catch(c){this._onError(c)}};a.prototype.onAfter=function(a){this.events.on("after",a)};a.prototype.runOnce=function(){this._runOnceTriggered||this.scriptExecuted||(this._runOnceTriggered=(new Date).valueOf(),this.run())};a.CANCEL_ALL=!1;a.prototype.run=function(){if(!isNaN(this.config.runningLimit)&&this.config.runningLimit<=this.runCounter)return!1;if(this.cancelled||a.CANCEL_ALL)return this._handleCancel(),!1;if(this.isRunning)return!1;
this.lastRun&&this.reset();this.lastRun=this.isRunning=(new Date).valueOf();this.runCounter++;this._ignoreDeps=!!this.ignoreDependencies;return this._ignoreDeps||this.dependenciesLoaded()?this._triggerLoadingAndExecution():(this._attachDepsEventsToContinue(),!1)};a.prototype._triggerLoadingAndExecution=function(){this.awaitingDependencies=-(new Date).valueOf();this.load();this._ignoreDeps?this.execute():this.waitForDependenciesAndExecute();return!0};a.prototype._attachDepsEventsToContinue=function(){this.awaitingDependencies=
(new Date).valueOf();for(var a=this.dependencies,c=0;c<a.length;c++)try{a[c].events.on("success",this._depLoadedHandler)}catch(b){}};a.prototype.dependenciesLoaded=function(){for(var a=this.dependencies,c=0;c<a.length;c++)if(a[c]!==this&&!(0<+a[c].scriptExecuted))return!1;return!0};a.prototype._setTimeout=function(a,b){this._wasTimed=(new Date).valueOf();return c.setTimeout(a,b)};a.prototype._handleCancel=function(){this.addState("CANCELLED");try{this.onCancel()}catch(a){this._onError(a)}};a.prototype.waitForDependenciesAndExecute=
function(){this.cancelled?this._handleCancel():this.loadedDependencies?this.execute():this.loadingDependenciesFailed?(this._markFailure(),this._markFinished()):this._setTimeout(this.waitForDependenciesAndExecute.bind(this),30)};a.prototype.execute=function(){this._triggerExecution()};a.prototype._triggerExecution=function(){if(this.cancelled)this._handleCancel();else if(!this.scriptExecuted){var a=!0;if(this.shouldWaitForDocWriteProtection())a=!1;else{if(!this._beforeEntered){this._beforeEntered=
(new Date).valueOf();a=!1;try{a=this.before()}catch(c){this._onError(c)}if(a){this._markFailure();this._markFinished();return}}a=this.loadExecutionURLsAndHTML(this._triggerExecution.bind(this))}if(!this.scriptExecuted)if(this.unexpectedFail&&(a=!0),a){this._flushDocWrites();this.scriptLoadingFailed||this.injectHTMLFailed||this.unexpectedFail?this._markFailure():(this.scriptExecuted=(new Date).valueOf(),this.addState("EXECUTED"),this._executeScript());if(this.cancelled)return this._handleCancel(),
!1;a=0<this.scriptExecuted;try{this.afterRun||(this.afterRun=(new Date).valueOf(),this.after(a))}catch(b){this.executedWithErrors=(new Date).valueOf()}this.executedWithErrors||a&&this.events.call("success");this._flushDocWrites();this._markFinished()}else this._setTimeout(this._triggerExecution.bind(this),30)}};a.prototype._markFailure=function(){this.scriptExecuted=-(new Date).valueOf();this.addState("FAILED_TO_EXECUTE")};a.prototype._markFinished=function(){this.runIsFinished=(new Date).valueOf();
this.isRunning=!1;a.LOCK_DOC_WRITE===this&&(this._flushDocWrites(),d.unlockDocumentWrites(),a.LOCK_DOC_WRITE=!1);this.onFinished(!0)};a.prototype.onFinished=p;a.prototype.onCancel=p;a.prototype.onFinished=p;a.prototype.shouldWaitForDocWriteProtection=function(){if(this.willSecureDocumentWrite())if(!a.LOCK_DOC_WRITE)a.LOCK_DOC_WRITE=this,this._secureWriteAndCollectForExecution();else if(a.LOCK_DOC_WRITE!==this)return this._lockedDocWriteInformed||(this._lockedDocWriteInformed=(new Date).valueOf()),
!0;return!1};a.prototype.runWithoutDependencies=function(){this.ignoreDependencies=!0;this.run()};a.prototype.loadExecutionURLsAndHTML=function(a){if(this.cancelled)return this._handleCancel(),!0;this._loadExecutionURLsAndHTMLInformed||(this._loadExecutionURLsAndHTMLInformed=!0);this._triggerURLsLoading(a);return this.loadURLsNotFinished||(this._flushDocWrites(),this._triggerHTMLInjection(),this._flushDocWrites(),this.injectHTMLNotFinished||(this._flushDocWrites(),this._docWriteNotFlushed))?!1:!0};
a.prototype._triggerURLsLoading=function(a){!this._urlLoadTriggered&&this.config.url&&(this._urlLoadTriggered=!0,this.loadURLs(!1,a))};a.prototype._triggerHTMLInjection=function(){!this._injectHTMLTriggered&&this.getHtml()&&(this._injectHTMLTriggered=!0,this.injectHTML())};a.prototype.STATE={INITIAL:0,STARTED:1,LOADING_DEPENDENCIES:2,LOADED_DEPENDENCIES:4,LOADING_URL:8,LOADED_URL:16,EXECUTED:32,EXECUTED_WITH_ERRORS:64,FAILED_TO_LOAD_DEPENDENCIES:128,FAILED_TO_LOAD_URL:256,FAILED_TO_EXECUTE:512,TIMED_OUT:1024,
UNEXPECTED_FAIL:2048,CANCELLED:4096};a.prototype.addState=function(a){if(this.STATE.hasOwnProperty(a)){this.state|=this.STATE[a];try{this.onStateChange(a)}catch(c){this._onError(c)}}};a.prototype.onStateChange=p;a.prototype.cancel=function(){this.cancelled=(new Date).valueOf()};a.prototype.unCancel=function(){this.cancelled=void 0};a.prototype.state=a.prototype.STATE.INITIAL;a.prototype._markLoadedSuccesfuly=function(){this.loadedDependencies=(new Date).valueOf();this.onAllDependenciesLoaded()};a.prototype._secureWriteAndCollectForExecution=
function(){this._securedWrites||(this._securedWrites=[],d.redirectDocumentWritesToArray(this._securedWrites,this.log))};a.prototype._markLoadingDependenciesFailed=function(){this.addState("FAILED_TO_LOAD_DEPENDENCIES");this.loadingDependenciesFailed=(new Date).valueOf()};a.prototype.allDependenciesLoaded=function(a,c){return 0===this.getDependenciesToBeLoaded(a,c).length};a.prototype.getDependenciesToBeLoaded=function(a,c){var b=c||[];this.injectionLocationReady()||b.push("injection location");var e,
g=this.dependencies;for(e=0;e<g.length;e++)g[e]!==this&&(0<+g[e].scriptExecuted||b.push("dependant Tag with name -> "+(g[e].config?g[e].config.name:"anonymous")));for(e=0;e<this.genericDependencies.length;e++)this.genericDependencies[e](this)||b.push("this.genericDependencies["+e+"] (index: "+e+")");return b};a.prototype.docWriteAsksToWaitForBody=function(){return!(!this.delayDocWrite||!this.config.usesDocumentWrite)};a.prototype._bodyNeededButNotAvailable=function(){return this._dontWaitForInjections()?
!1:this._isBodyLocationNeeded()&&!d.bodyAvailable()};a.prototype._isBodyLocationNeeded=function(){return this.isLoadingAsynchronously()?this._isBodyLocationSet()?!0:"HEAD"===this.config.locationObject&&"END"===this.config.locationPlaceHolder:!1};a.prototype._isBodyLocationSet=function(){var a=this.config.locationObject;return!a||"BODY"===a};a.prototype._fullBodyNeededAndUnLoaded=function(){if(this._dontWaitForInjections())return!1;var a=!1;this._isBodyLocationNeeded()&&(a="END"===this.config.locationPlaceHolder);
return(a=a||this.fullbodyNeeded||this.docWriteAsksToWaitForBody())&&!g.bodyReady()};a.prototype._dontWaitForInjections=function(){return this.config.dontWaitForInjectionLocation||this.dontWaitForInjectionLocation||a.dontWaitForInjectionLocation};a.prototype.injectionLocationReady=function(){return this._dontWaitForInjections()?!0:this._fullBodyNeededAndUnLoaded()?!1:this.isLoadingAsynchronously()?!!d.getHTMLLocationForTag(this):!0};a.prototype._loadingOutOfTimeFrames=function(){return 0>this.getTimeout()?
!1:(new Date).valueOf()-this.timeoutCountdownStart>this.getTimeout()};a.prototype.loadDependencies=function(){this._loadDependencies()};a.prototype.addClientDependenciesList=function(a,c){return this.addDependenciesList(a,f.Define.clientSpaceClasspath())};a.prototype.addDependenciesList=function(c,b){if(c&&0!==c.length){this.failedDependenciesToParse||(this.failedDependenciesToParse=[]);for(var e=this.dependencies,d=0;d<c.length;d++){var f=c[d],w=!1;if(f instanceof a)e.push(f);else if("string"===
typeof f){var t=f;b&&(f=b+"."+f);var A=g.getObjectUsingPath(f);A?A instanceof a?e.push(A):w=!0:this.failedDependenciesToParse.push(t)}else w=!0;w&&(this.badDepsObjects=this.badDepsObjects||[],g.addToArrayIfNotExist(this.badDepsObjects,f))}}};a.prototype._loadDependencies=function(a){a=a||[];var c=this.dependencies;if(-1===g.indexInArray(a,this)){a[a.length]=this;for(var b=0;b<c.length;b++)c[b].load(a)}};a.prototype.onError=p;a.prototype._onError=function(a){try{this.onError(a)}catch(c){}};a.prototype._triggerOnLoadTimeout=
function(){this.onLoadTimeout()};a.prototype.onLoadTimeout=p;a.prototype.onScriptsLoadSuccess=p;a.prototype.onScriptLoadError=p;a.prototype.onAllDependenciesLoaded=p;a.prototype.onBeforeLoad=null;a.prototype.load=function(){if(!this.loadStarted){this.loadStarted=(new Date).valueOf();try{if(this.onBeforeLoad)this.onBeforeLoad()}catch(a){this._onError(a)}this.addState("LOADING_DEPENDENCIES");try{!this._ignoreDeps&&this.config.loadDependenciesOnLoad&&this.loadDependencies()}catch(c){throw c;}b.call(this)}};
a.prototype._singleUrlLoadHandler=function(a,c,b){++this.urlsLoaded;a||++this.urlsFailed;if(this.urlsLoaded===c.length)if(this.loadURLsNotFinished=!1,a&&0===this.urlsFailed){this.addState("LOADED_URL");this.urlsLoaded=(new Date).valueOf();try{b&&b(!0)}catch(e){this._onError(e)}finally{this.onScriptsLoadSuccess()}}else{a="error loading urls. Failed "+this.urlsFailed;this._onError(a);this.addState("FAILED_TO_LOAD_URL");this.urlsLoaded=-(new Date).valueOf();try{this.scriptLoadingFailed=!0,b&&b(!1)}catch(g){this._onError(g)}finally{this.onScriptLoadError(a)}}};
a.prototype.loadURLs=function(a,c){var b=a||this.config.url;this.addState("LOADING_URL");try{!b||b instanceof Array||(b=[b]);for(var e=0;e<b.length;e++){this.loadURLsNotFinished=!0;var g=b[e],g=this.prepareURL(g);this.loadURL(g,function(a){this._singleUrlLoadHandler(a,b,c)}.bind(this))}}catch(d){this.loadURLsNotFinished=!1,this.addState("UNEXPECTED_FAIL"),this.unexpectedFail=(new Date).valueOf(),this._onError(d)}};a.prototype.prepareLocationObject=function(a){return a};a.prototype.prepareURL=function(a){return a};
a.prototype.prepareHTML=function(a){return a};a.prototype.loadURL=function(a,c,b){this.addState("LOADING_URL");d.loadScript({onsuccess:function(){try{c&&c(!0)}catch(a){}}.bind(this),onerror:function(){try{c&&c(!1)}catch(a){}}.bind(this),url:a,node:b||this.config.urlLocation,async:this.isLoadingAsynchronously(),noMultipleLoad:this.config.noMultipleLoad})};a.prototype.reset=function(){this._securedWrites=this.delayDocWrite=this.scriptLoadingFailed=this.scriptExecuted=this.runIsFinished=this.loadingTimedOut=
this.loadingDependenciesFailed=this.loadedDependencies=this.loadURLsNotFinished=this.loadStarted=this.injectHTMLFailed=this.filtersRunTriggered=this.beforeRun=this.afterRun=this._urlLoadTriggered=this._runOnceTriggered=this._lockedDocWriteInformed=this._loadExecutionURLsAndHTMLInformed=this._injectHTMLTriggered=void 0;this.state=0;this.unexpectedFail=void 0;this.urlsLoaded=this.urlsFailed=0;this.timeoutCountdownStart=this.awaitingDependencies=this._beforeEntered=this.cancelled=this._lastRun=this.isRunning=
this.waitForDependenciesFinished=void 0;this.addState("INITIAL")};a.prototype.isLoadingAsynchronously=function(){return this._wasTimed?!0:!(!this.config.async&&!this.forceAsynchronous)};a.prototype.willSecureDocumentWrite=function(){return this.config.usesDocumentWrite&&this.isLoadingAsynchronously()};a.prototype.injectHTML=function(a){var c=!this.docWriteAsksToWaitForBody(),b=this.prepareHTML(this.getHtml());b&&e.injectHTMLForLoader(this,a,c,b)};a.prototype.clone=function(){return new a(this.config)}})();
(function(){function a(c){g.setIfUnset(c,{filterTimeout:c&&c.filterTimeout||this.FILTER_WAIT_TIMEOUT,PACKAGE:c&&c.PACKAGE,dedupe:!1,needsConsent:!1,inactive:!1,variables:null,runner:null,disabled:!1,locked:!1,reRunOnVariableChange:!1});a.SUPER.apply(this,arguments);this.namedVariables={};this.parameters=[];this.filters=[];this.session=null;this.oldDedupePingSent=this.dedupePingSent=this.oldPingSent=this.pingSent=!1;this.reRunCounter=0;if(c){this.addState("INITIAL");try{a.register(this)}catch(b){}this.setupConfig(c);
this.uniqueRefString=null;if(c.init)try{c.init.call(this,c)}catch(e){}this.onTagInit();this.handleVariableChange=this._handleVariableChange.bind(this)}}function b(a,c){var g=a.namedVariables,d=e.initPageVariable(g[c]);return g[c]=d}var g=f.opentag.Utils,d=f.opentag.TagsUtils,c=f.opentag.filter.BaseFilter,e=f.opentag.TagHelper,h=f.opentag.pagevariable.BaseVariable,k=f.Cookie,n=f.Define;n.clazz("qubit.opentag.BaseTag",a,f.opentag.GenericLoader);a.prototype.setupConfig=function(a){if(a){a.filters&&this.addFilters(a.filters);
a.parameters&&this.addParameters(a.parameters);if(a.variables)for(var c in a.variables)if(a.variables.hasOwnProperty(c)){var b=this.getParameterByTokenName(c);if(b){var e=a.variables[c];b.variable=e;void 0!==e.defaultValue&&(b.defaultValue=e.defaultValue);void 0!==e.uv&&(b.uv=e.uv)}}a.locked&&this.lock()}};a.prototype.valueForToken=function(a,c){var e=this.getParameterByTokenName(a);if(e)return void 0===c&&this.loadingTimedOut&&(c=!0),this.getParameterValue(e,c);if((e=this.namedVariables)&&e[a]&&
(e=b(this,a)))return e.getRelativeValue(c)};a.prototype.addParameters=function(a){this.parameters=this.parameters.concat(a)};a.prototype.LOADING_TIMEOUT=5E3;a.prototype.FILTER_WAIT_TIMEOUT=-1;a.prototype._isVariable=function(a){return null!==a&&void 0!==a};a.prototype.run=function(){if(this.destroyed)throw"Tag is destroyed.";this.resolveAllDynamicData();var a=this.parameters;if(a)for(var c=0;c<a.length;c++){var b=this.getVariableForParameter(a[c]);if(!this._isVariable(b)){this._markLoadingDependenciesFailed();
this._markFinished();return}}if(this.config.runner){a=!1;try{this.addState("AWAITING_CALLBACK"),a=this._runner=(new Date).valueOf(),this.config.runner.call(this)}catch(e){}return a}this._runner=!1;return this.start()};a.prototype.lock=function(){this.locked=!0;this._unlock=null};a.prototype.unlock=function(){this.locked=!1;this._unlock&&(this._unlock(),this._unlock=!1)};a.prototype.start=function(){return this.locked?(this._unlock=function(){return a.SUPER.prototype.run.call(this)}.bind(this),!1):
a.SUPER.prototype.run.call(this)};a.prototype.startOnce=function(){return this.locked?(this._unlock=function(){return a.SUPER.prototype.runOnce.call(this)}.bind(this),!1):a.SUPER.prototype.runOnce.call(this)};a.prototype.getFilters=function(){return this.filters};a.prototype.runOnceIfFiltersPass=function(){this._runOnceIfFiltersPassTriggered||this.scriptExecuted||(this._runOnceIfFiltersPassTriggered=(new Date).valueOf(),this.runIfFiltersPass())};a.prototype.runIfFiltersPass=function(){if(this.destroyed)throw"Tag is destroyed.";
this.resolveAllDynamicData();var a=this.filtersState(!0);this.addState("FILTER_ACTIVE");this.filtersRunTriggered||(this.filtersRunTriggered=(new Date).valueOf());if(a===c.state.SESSION)this.addState("AWAITING_CALLBACK"),this.awaitingCallback=(new Date).valueOf();else if(a===c.state.PASS){this.filtersPassed=(new Date).valueOf();try{this.onFiltersPassed()}catch(b){}this.run()}else if(a===c.state.FAIL)this._markFiltersFailed(),this._markFinished();else if(0<a){var e=this.config.filterTimeout;if(0>e||
(new Date).valueOf()-this.filtersRunTriggered>e){if(!this._awaitingForFilterInformed){this._awaitingForFilterInformed=(new Date).valueOf();try{this.onFiltersDelayed()}catch(g){}}this._setTimeout(this.runIfFiltersPass.bind(this),a)}else this._markFiltersFailed(),this._markFinished(),this.filtersRunTimedOut=(new Date).valueOf()}try{this.onFiltersCheck(a)}catch(d){}return a};a.prototype._markFiltersFailed=function(){this.addState("FILTERS_FAILED");this.filtersPassed=-(new Date).valueOf()};a.prototype.STATE=
{INITIAL:0,FILTER_ACTIVE:1,AWAITING_CALLBACK:2,FILTERS_FAILED:4,STARTED:8,LOADING_DEPENDENCIES:16,LOADED_DEPENDENCIES:32,LOADING_URL:64,LOADED_URL:128,EXECUTED:256,EXECUTED_WITH_ERRORS:512,FAILED_TO_LOAD_DEPENDENCIES:1024,FAILED_TO_LOAD_URL:2048,FAILED_TO_EXECUTE:4096,TIMED_OUT:8192,UNEXPECTED_FAIL:16384,CANCELLED:32768};a.prototype.addState=function(c){a.SUPER.prototype.addState.call(this,c);try{a.onStateChange(this)}catch(b){}this.stateStack=[];c=this.STATE;var e=this.state,g=this.stateStack;e&
c.INITIAL&&g.push("Initial state.");e&c.FILTER_ACTIVE&&g.push("Tag running with filters pass triggered.");e&c.FILTERS_FAILED&&g.push("Filters failed to pass.");e&c.AWAITING_CALLBACK&&g.push("Awaiting callback to run this tag. Not pooling.");e&c.STARTED&&g.push("Tag is initialized and loading has been started.");e&c.LOADING_DEPENDENCIES&&g.push("Dependencies are being loaded.");e&c.LOADED_DEPENDENCIES&&g.push("Dependencies loading process has been finished.");e&c.LOADING_URL&&g.push("External URL is being loaded.");
e&c.LOADED_URL&&g.push("External URL has been loaded.");e&c.EXECUTED&&g.push("Main script has been executed.");e&c.EXECUTED_WITH_ERRORS&&g.push("Main script has been executed but errors occured.");e&c.FAILED_TO_LOAD_DEPENDENCIES&&g.push("Dependencies has failed to load.");e&c.FAILED_TO_LOAD_URL&&g.push("URL location failed to load.");e&c.FAILED_TO_EXECUTE&&g.push("Script failed to execute.");e&c.TIMED_OUT&&g.push("Script timed out awaiting for dependencies.");e&c.UNEXPECTED_FAIL&&g.push("Script occured UNEXPECTED exception and is failed.");
e&c.CANCELLED&&g.push("Tag has been cancelled.")};a.prototype.onTagInit=p;a.onStateChange=p;a.prototype.onFiltersDelayed=p;a.prototype.onFiltersPassed=p;a.prototype.onFiltersCheck=p;a.prototype.state=a.prototype.STATE.INITIAL;a.prototype.arePageVariablesLoaded=function(a){return e.allParameterVariablesReadyForTag(this,a)};a.prototype.getDependenciesToBeLoaded=function(c,b){var e=b||[];this.arePageVariablesLoaded(c)||e.push("page variables");return a.SUPER.prototype.getDependenciesToBeLoaded.call(this,
c,e)};a.prototype.resolveAllDynamicData=function(){this.resolvePageVariables();this.resolveDependencies();this.resolveFilters()};a.prototype.resolveDependencies=function(){var a=this.failedDependenciesToParse;a&&(this.failedDependenciesToParse=null,this.addDependenciesList(a,n.clientSpaceClasspath()));return this.dependencies};a.prototype.addClientVariablesMap=function(a){return this.unresolvedClientVariablesMap=this._addVariablesMap(a,n.clientSpaceClasspath())};a.prototype.resolvePageVariables=function(){var a=
this.unresolvedClientVariablesMap;a&&(this.unresolvedClientVariablesMap=null,this.addClientVariablesMap(a));if(a=this.unresolvedVariablesMap)this.unresolvedVariablesMap=null,this.addVariablesMap(a);return this.getPageVariables()};a.prototype.addVariablesMap=function(a){return this.unresolvedVariablesMap=this._addVariablesMap(a)};a.prototype._addVariablesMap=function(a,c){if(a){var b={},e=this.namedVariables,d;for(d in a)if(a.hasOwnProperty(d)){var f=a[d];if(f instanceof h)e[d]=f;else if("string"===
typeof f){var k=f;c&&(f=c+"."+f);var s=g.getObjectUsingPath(f);s?e[d]=s instanceof h?s:f:b[d]=k}}return b}};a.prototype.prepareURL=function(a){return this.replaceTokensWithValues(a)};a.prototype.prepareLocationObject=function(a){return this.replaceTokensWithValues(a)};a.prototype.prepareHTML=function(a){a&&(a=this.replaceTokensWithValues(a));return a};a.prototype._executeScript=function(){if(this.config&&this.config.script)if("function"===typeof this.config.script)this.script=this.config.script;else{var c=
this.replaceTokensWithValues(String(this.config.script));this.script=g.expressionToFunction(c).bind(this)}a.SUPER.prototype._executeScript.call(this)};a.prototype.replaceTokensWithValues=function(a){if(!a||-1===a.indexOf("${"))return a;var c=this.parameters;if(c)for(var b=0;b<c.length;b++){var e=this.getVariableForParameter(c[b]);if(e){var g=c[b].token,d=this.valueForToken(g);a=e.replaceToken(g,a,d)}}return a};a.prototype.getParameter=function(a){var c=this.parameters,b=null;if(c)for(var e=0;e<c.length;e++)c[e].name===
a&&(b=c[e]);return b};a.prototype.setParameterValueByTokenName=function(a,c){var b=this.getParameterByTokenName(a);return null!==b?(b.variable={value:c},!0):!1};a.prototype.getParameterValue=function(a,c){var b="string"===typeof a?this.getParameter(a):a;if(b){var e=this.getVariableForParameter(b);if(e)try{var d;c&&""!==b.defaultValue&&(d=g.gevalAndReturn(b.defaultValue).result);return d=e.getRelativeValue(c,d)}catch(f){}}};a.prototype.filtersState=function(a){return d.filtersState(this.filters,this.session,
this,a)};a.prototype.addFilter=function(a){g.addToArrayIfNotExist(this.filters,a)};a.prototype.addFilters=function(a){for(var c=0;c<a.length;c++)this.addFilter(a[c])};a.prototype.addClientFiltersList=function(a){return this.unresolvedClientFilterClasspaths=this.addFiltersList(a,n.clientSpaceClasspath())};a.prototype.resolveFilters=function(){var a=this.unresolvedClientFilterClasspaths;a&&(this.unresolvedClientFilterClasspaths=null,this.addClientFiltersList(a));return this.filters};a.prototype.addFiltersList=
function(a,b){for(var e=[],d=0;d<a.length;d++)try{var f=a[d],h=null;"string"===typeof f&&(h=f,b&&(f=b+"."+f),f=g.getObjectUsingPath(f));"function"===typeof f&&(f=new f);!f instanceof c&&(f=null);f?this.addFilter(f):h&&g.addToArrayIfNotExist(e,h)}catch(k){this.failedFilters=this.failedFilters||[],this.failedFilters.push(a[d])}return e};a.prototype.reset=function(){a.SUPER.prototype.reset.call(this);this.filtersPassed=void 0;this.oldPingSent=this.pingSent=this.oldDedupePingSent=this.dedupePingSent=
!1;this._runner=this.filtersRunTriggered=this._runOnceIfFiltersPassTriggered=void 0;this.reRunCounter=0;this.detachVariablesChangedListeners()};a.prototype.resetFilters=function(){for(var a=0;a<this.filters.length;a++)this.filters[a].reset()};a.prototype.getParameterByTokenName=function(a){var c=null;if(this.parameters)for(var b=this.parameters,e=0;e<b.length;e++)b[e].token===a&&(c=b[e]);return c};a.prototype.removeFilter=function(a){g.removeFromArray(this.filters,a)};var l=0,m=[],E={},r={};a.register=
function(a){var c=g.addToArrayIfNotExist(m,a);a._tagIndex=-1===c?m.length-1:c;a.config.id?(c="Q"+a.config.id,r[c]=a,a.uniqueId=c):r[a.CLASSPATH]=a};a.getById=function(a){return r[String(a)]};a.prototype.getById=a.getById;a.prototype.unregister=function(c){a.unregister(c||this)};a.prototype.destroy=function(){this.destroyed=!0;this.cancel();a.unregister(this)};a.unregister=function(a){g.removeFromArray(m,a);a._tagIndex=-1};a.getTags=function(){return m};a.getAccessorsMap=function(){return E};a.prototype.getTags=
function(){return m};a.prototype.getPageVariables=function(){var a=this.parameters,c=[];if(a)for(var e=0;e<a.length;e++){var d=this.getVariableForParameter(a[e]);this._isVariable(d)&&g.addToArrayIfNotExist(c,d)}if(this.namedVariables)for(var f in this.namedVariables)g.addToArrayIfNotExist(c,b(this,f));return c};a.prototype.getAccessorString=function(){this._accessorsMapKey||(this._accessorsMapKey="_"+l++,E[this._accessorsMapKey]=this);return"qubit.opentag.BaseTag.getAccessorsMap()."+this._accessorsMapKey};
a.prototype.getVariableForParameter=function(a){var c,g=this.namedVariables;g&&g[a.token]&&(c=b(this,a.token));c||(c=e.validateAndGetVariableForParameter(a));return c};a.prototype.printVariablesState=function(){for(var a=[],c=e.getAllVariablesWithParameters(this),b=0;b<c.length;b++){var g=c[b].parameter,d=c[b].variable,f;f=g&&g.token?this.valueForToken(g.token):d.getRelativeValue(!0);g={name:d.config.name,exists:d.exists(),token:g?g.token:null,value:f,variable:d};a.push(g)}return a};a.prototype._triggerOnLoadTimeout=
function(){this.onLoadTimeout()};a.prototype.getId=function(){return this._getUniqueId()};a.prototype._getUniqueId=function(){return this.config.id?this.config.id:0===String(this.CLASSPATH).indexOf(n.STANDARD_CS_NS)?this.CLASSPATH.substring(n.STANDARD_CS_NS.length+1):this.CLASSPATH+"#"+this.config.name};a.prototype.cookieSaysToRunEvenIfDisabled=function(){var a=this._getUniqueId(),c=!!k.get("qubit.tag.forceAllToRun");c||(c=!!k.get("qubit.tag.forceRunning_"+a));return c};a.prototype.setCookieForcingTagToRun=
function(){var a=this._getUniqueId();k.set("qubit.tag.forceRunning_"+a,"true")};a.setCookieForcingTagsToRun=function(){k.set("qubit.tag.forceAllToRun","true")};a.prototype.setCookieToDisable=function(){var a=this._getUniqueId();k.set("qubit.tag.disableRunning_"+a,"true")};a.prototype.rmCookieToDisable=function(){var a=this._getUniqueId();k.rm("qubit.tag.disableRunning_"+a)};a.prototype.disabledByCookie=function(){var a=this._getUniqueId();return!!k.get("qubit.tag.disableRunning_"+a)};a.rmCookieForcingTagsToRun=
function(){k.rm("qubit.tag.forceAllToRun")};a.prototype.rmCookieForcingTagToRun=function(){var a=this._getUniqueId();k.rm("qubit.tag.forceRunning_"+a)};a.rmAllDisablingCookies=function(){g.rmCookiesMatching("qubit.tag.disableRunning_")};a.rmAllCookiesForcingTagToRun=function(){g.rmCookiesMatching("qubit.tag.forceRunning_");a.rmCookieForcingTagsToRun()};a.prototype.onVariableChanged=function(a){this.attachVariablesChangedListeners(!0);this.events.on("variableChanged",a)};a.prototype._handleVariableChange=
function(a){this.events.call("variableChanged",a);this.isRunning||!this.config.reRunOnVariableChange||!isNaN(this.config.reRunLimit)&&this.config.reRunLimit<=this.reRunCounter||(a=this.reRunCounter+1,this.reset(),this.reRunCounter=a,this.resetFilters(),this.runIfFiltersPass())};a.prototype.attachVariablesChangedListeners=function(a){var c=this.getPageVariables();if(a=!!(this.config.reRunOnVariableChange||this.config.observeVariables||a))for(var b=0;b<c.length;b++)c[b].onValueChanged(this.handleVariableChange,
a)};a.prototype.detachVariablesChangedListeners=function(){for(var a=this.getPageVariables(),c=0;c<a.length;c++)a[c].deatchOnValueChanged(this.handleVariableChange)};a.prototype._markFinished=function(){a.SUPER.prototype._markFinished.call(this);this.attachVariablesChangedListeners()}})();(function(){var a=f.opentag.Utils,b=f.opentag.filter.BaseFilter,g=function(){};f.Define.clazz("qubit.opentag.Tags",g);g.getById=function(a){return f.opentag.BaseTag.getById(String(a))};g.getAllTagsByState=function(){return f.opentag.Container.getAllTagsByState(g.getTags())};
g.findTagByName=function(a){for(var b=this.getTags(),g=[],d=0;d<b.length;d++)b[d].config.name===a&&g.push(b[d]);return g};g.findTagByMatch=function(a){for(var b=this.getTags(),g=[],d=0;d<b.length;d++)b[d].config.name.match(a)&&g.push(b[d]);return g};g.findTagContainers=function(a){for(var b=g.getContainers(),d=[],f=0;f<b.length;f++){var h=b[f].tags,k;for(k in h)if(h[k]===a){d.push(b[f]);break}}return d};g.getTags=function(){return f.opentag.BaseTag.getTags()};g.resetAllTags=function(a){for(var b=
g.getTags(),d=0;d<b.length;d++)b[d].reset(),a||b[d].resetFilters()};g.getContainersPageVariables=function(){for(var a=g.getContainers(),b=[],d=0;d<a.length;d++)b=b.concat(a.getPageVariables());return b};g.getAllPageVariables=function(){for(var a=g.getTags(),b=[],d=0;d<a.length;d++)b=b.concat(a[d].getPageVariables());return b};g.cancelAll=function(){for(var a=g.getTags(),b=0;b<a.length;b++)a[b].cancel()};g.resetAll=function(a){for(var b=g.getTags(),d=0;d<b.length;d++)b[d].reset(),a||b[d].resetFilters()};
g.getPageVariableByName=function(a){for(var b=g.getAllPageVariables(),d=[],f=0;f<b.length;f++)b[f].config.name===a&&d.push(b[f]);return d};g.getLoadTime=function(a){var b=a.beforeRun,g=a.runIsFinished;return isNaN(g)?{tag:a,loadTime:null}:{tag:a,loadTime:g-b}};g.getLoadTimes=function(a){var b=[];if(a instanceof f.opentag.BaseTag)return b.push([g.getLoadTime(a[d])]),b;a=a||g.getTags();if(a instanceof Array)for(d=0;d<a.length;d++)a[d]instanceof f.opentag.BaseTag&&b.push(g.getLoadTime(a[d]));else for(var d in a)a[d]instanceof
f.opentag.BaseTag&&b.push(g.getLoadTime(a[d]));return b};g.forceAllContainersAndTagsToRunIfDisabled=function(){f.opentag.Container.setCookieForDisabledContainersToRun();f.opentag.BaseTag.setCookieForcingTagsToRun()};g.rmAllContainersAndTagsForcingFlags=function(){f.opentag.Container.rmCookieForDisabledContainersToRun();f.opentag.BaseTag.rmAllCookiesForcingTagToRun()};g.getContainers=function(){return f.opentag.Container.getContainers()};g.findAllTagsByClassPath=function(c){var b=[],d=[];try{d.push(f.opentag.CustomTag),
d.push(f.opentag.LibraryTag)}catch(h){}for(var k=g.getTags(),s=0;s<k.length;s++){var l=k[s];0>a.indexInArray(d,l)&&0===l.PACKAGE_NAME.indexOf(c)&&b.push(l)}return b};g.findAllTags=function(a,b){var d=f.opentag.BaseTag,h=[];try{h.push(f.opentag.CustomTag),h.push(f.opentag.LibraryTag)}catch(k){}return g.findAllInstances(a,d,h,b)};var d=function(b,e,g,d){var f=[];"string"===typeof b&&(b=a.getObjectUsingPath(b));if(b){var h={objectsOnly:!0};d&&(h.maxDeep=!0);d=function(b,c,d,h){if(e(b)){for(c=0;c<g.length;c++)if(g[c]===
b)return!0;a.addToArrayIfNotExist(f,b);return!0}return!1}.bind(this);a.traverse(b,d,h)}return f};g.findAllInstances=function(a,b,g,f){return d(a,function(a){return a instanceof b},g,f)};g.findAllInheriting=function(a,b,g,f){return d(a,function(a){return a.prototype instanceof b},g,f)};g.findAllFilters=function(a,e){var d=[];try{d.push(f.opentag.filter.Filter),d.push(f.opentag.filter.URLFilter)}catch(h){}return g.findAllInheriting(a,b,d,e)}})();b={};h=void 0;b.update=function(){var a,b;b=function(){return Math.floor(1+
65536*Math.random()).toString(36).substring(1)};window.__pageViewId__||(a=(new Date).getTime().toString(36),window.__pageViewId__=a+b()+b()+b());return window.__pageViewId__};r.PostData=function(a,b,g,d){var c,e,f,h,k,l,m;m=2;k=!1;l=function(){0<m&&setTimeout(function(){k||(m-=1,c())},5E3)};e=navigator.userAgent.toLowerCase();f=-1!==e.indexOf("msie");e.indexOf("msie 9");e=-1!==e.indexOf("msie 7")||-1!==e.indexOf("msie 6");h=("https:"===document.location.protocol?"https:":"http:")+a;g=g||"POST";c=
function(){var a;try{a=null;try{a=new XMLHttpRequest}catch(c){}a&&!f?a.open(g,h,!0):"undefined"!==typeof XDomainRequest?(a=new XDomainRequest,a.open(g,h)):a=null;try{a.withCredentials=!1}catch(e){}a.setRequestHeader&&(d?a.setRequestHeader("Content-Type",d):a.setRequestHeader("Content-Type","text/plain;charset=UTF-8"));a.onload=function(){k=!0};a.onreadystatechange=function(){};a.ontimeout=function(){};a.onerror=function(){};a.onprogress=function(){};a.send(b)}catch(t){try{try{r.fileLoader.load(h)}catch(A){window.console&&
window.console.log&&window.console.log(t)}}catch(C){}}l()};e?r.fileLoader.load(h):c()};(function(){function a(){}function d(a,f){var c={};c.clientId=""+f.clientId;c.containerId=""+a.getContainerId();c.classpath=""+a.PACKAGE_NAME;c.opentagStats=!0;a.sentPing?c.containerLoad=!1:(a.sentPing=(new Date).valueOf(),c.containerLoad=!0);c.isS3=!1;c.pageViewId=b.update();c.tags=[];return c}f.Define.clazz("qubit.opentag.Ping",a);a.useNewPingSource=!1;a.useAlsoOldPingSource=!1;a.prototype.oldSend=function(g,
d){for(var c=g.config,e="c="+c.clientId+"&p="+g.getContainerId()+"&l="+c.tellLoadTimesProbability+"&pv="+b.update()+"&d=",f=[],h=0;h<d.length;h++){var k=d[h].tag,l=d[h].loadTime;if(null!==l&&!isNaN(l)){var m=a.getPingID(k);!k.oldPingSent&&m&&null!==l&&void 0!==m&&(f.push('"'+m+'":'+l),k.oldPingSent=!0)}}c.pingServerUrl&&0<f.length&&(e+=encodeURIComponent("{"+f.join(",")+"}"),r.PostData("//"+c.pingServerUrl+"/tag2?"+e,null,"GET"))};a.prototype.sendErrors=function(a,b){};a.prototype.oldSendDedupe=function(g,
d){for(var c=g.config,e="c="+c.clientId+"&p="+g.getContainerId()+"&l="+c.tellLoadTimesProbability+"&pv="+b.update()+"&dd=",f=[],h=0;h<d.length;h++){var k=d[h],l=a.getPingID(k);void 0===l||k.oldDedupePingSent||(f.push(l),k.oldDedupePingSent=!0)}0<f.length&&c.pingServerUrl&&(e+=encodeURIComponent("["+f.join(",")+"]"),r.PostData("//"+c.pingServerUrl+"/tag2?"+e,null,"GET"))};a.getPingID=function(a){if(a.config.id)return a.config.id;var b=a.PACKAGE_NAME.lastIndexOf(".");return-1!==b?a.PACKAGE_NAME.substring(b+
1):a.PACKAGE_NAME};a.prototype.send=function(b,d){a.useNewPingSource?(this.newSend(b,d),a.useAlsoOldPingSource&&this.oldSend(b,d)):this.oldSend(b,d)};a.prototype.newSend=function(b,f){for(var c=b.config,e=d(b,c),h=e.tags,c=a.newPingServerUrl||c.pingServerUrl,k=0;k<f.length;k++){var l=f[k].tag,m=f[k].loadTime;if(null!==m&&!isNaN(m)){var p={},q=a.getPingID(l);!l.pingSent&&q&&null!==m&&void 0!==q&&(p.tagId=q,p.loadTime=m,p.fired=!0,h.push(p),l.pingSent=!0)}}c&&(0<h.length||e.containerLoad)&&(e=y.stringify(e),
r.PostData("//"+c,e,"POST","text/plain;charset=UTF-8"))};a.prototype.sendDedupe=function(b,d){a.useNewPingSource?(this.newSendDedupe(b,d),a.useAlsoOldPingSource&&this.oldSendDedupe(b,d)):this.oldSendDedupe(b,d)};a.prototype.newSendDedupe=function(b,f){for(var c=b.config,e=d(b,c),c=a.newPingServerUrl||c.pingServerUrl,h=e.tags,k=0;k<f.length;k++){var l=f[k],m=a.getPingID(l),p={};void 0===m||l.dedupePingSent||(p.tagId=""+m,p.fired=!1,p.loadTime=0,h.push(p),l.dedupePingSent=!0)}c&&(0<h.length||e.containerLoad)&&
(e=y.stringify(e),r.PostData("//"+c,e,"POST","text/plain;charset=UTF-8"))}})();h={_cookieName:"_qst_s",_sessionCookie:"_qsst_s",update:function(a){var b,d;b=f.Cookie.get(h._cookieName);d=f.Cookie.get(h._sessionCookie);if(b){if(b=parseInt(b,10),!d||parseInt(d,10)<(new Date).getTime()-18E5)b+=1}else b=1;f.Cookie.set(h._cookieName,b,365,a);f.Cookie.set(h._sessionCookie,(new Date).getTime().toString(),null,a);return b}};var y={};(function(){function a(a){return 10>a?"0"+a:a}function b(a){c.lastIndex=
0;return c.test(a)?'"'+a.replace(c,function(a){var b=k[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function d(c,f){var k,s,m,t,A=e,C,p=f[c];if(p instanceof Date)k=p,p=isFinite(k.valueOf())?k.getUTCFullYear()+"-"+a(k.getUTCMonth()+1)+"-"+a(k.getUTCDate())+"T"+a(k.getUTCHours())+":"+a(k.getUTCMinutes())+":"+a(k.getUTCSeconds())+"Z":null;else if(p instanceof String||p instanceof Number||p instanceof Boolean)p=p.valueOf();"function"===typeof l&&
(p=l.call(f,c,p));switch(typeof p){case "string":return b(p);case "number":return isFinite(p)?String(p):"null";case "boolean":case "null":return String(p);case "object":if(!p)return"null";e+=h;C=[];if("[object Array]"===Object.prototype.toString.apply(p)){t=p.length;for(k=0;k<t;k+=1)try{C[k]=d(k,p)||"null"}catch(r){C[k]='{"stack_exceeded": null}'}m=0===C.length?"[]":e?"[\n"+e+C.join(",\n"+e)+"\n"+A+"]":"["+C.join(",")+"]";e=A;return m}if(l&&"object"===typeof l)for(t=l.length,k=0;k<t;k+=1){if("string"===
typeof l[k]){s=l[k];try{m=d(s,p)}catch(q){m='{"stack_exceeded": null}'}m&&C.push(b(s)+(e?": ":":")+m)}}else for(s in p)if(Object.prototype.hasOwnProperty.call(p,s)){try{m=d(s,p)}catch(x){m='{"stack_exceeded": null}'}m&&C.push(b(s)+(e?": ":":")+m)}m=0===C.length?"{}":e?"{\n"+e+C.join(",\n"+e)+"\n"+A+"}":"{"+C.join(",")+"}";e=A;return m}}var f=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
e,h,k={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof y.stringify&&(y.stringify=function(a,b,c){var f;h=e="";if("number"===typeof c)for(f=0;f<c;f+=1)h+=" ";else"string"===typeof c&&(h=c);if((l=b)&&"function"!==typeof b&&("object"!==typeof b||"number"!==typeof b.length))throw Error("JSON.stringify");return d("",{"":a})});"function"!==typeof y.parse&&(y.parse=function(a,b){function c(a,e){var d,g,f=a[e];if(f&&"object"===typeof f)for(d in f)Object.prototype.hasOwnProperty.call(f,
d)&&(g=c(f,d),void 0!==g?f[d]=g:delete f[d]);return b.call(a,e,f)}var e;a=String(a);f.lastIndex=0;f.test(a)&&(a=a.replace(f,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return e=eval("("+a+")"),"function"===typeof b?c({"":e},""):e;throw new SyntaxError("JSON.parse");})})();(function(){function a(a){if(a)if(a.alphabet)for(this.alphabet=
a.alphabet,this.dict={},a=0;a<this.alphabet.length;a++)this.dict[this.alphabet[a]]=a;else this.alphabet=d,this.dict=e}function b(a,c){for(var e in c)if(a===c[e])return e;return null}for(var d=[],h=Math.pow(2,8),c=0;c<h;c++)d.push(String.fromCharCode(c));for(var e={},h=0;h<d.length;h++)e[d[h]]=h;f.Define.clazz("qubit.compression.LZW",a);a.prototype.encode=function(a){for(var b=this.alphabet.length,c={},e=[],d=0,g=a.charAt(d++),f,h=this.dict;f=a.charAt(d++);){var k=g+f;if(h.hasOwnProperty(k)||c.hasOwnProperty(k))g=
k;else{var l=h.hasOwnProperty(g)?h[g]:c[g];if(void 0===l)throw"Dictionary base is to small for those contents: "+g;e.push(l);c[k]=b++;g=f}}""!==g&&e.push(c.hasOwnProperty(g)?c[g]:h[g]);return e};a.prototype.decode=function(a){for(var c=this.dict,e=this.alphabet.length,d,g={},f=b(a[0],c),h=f,k=[f],t=1;t<a.length;t++){var l=a[t];d=b(l,c);null===d&&(g.hasOwnProperty(l)&&(d=g[l]),null===d&&(d=h+f));k.push(d);f=d.charAt(0);g[e++]=h+f;h=d}return k.join("")}})();(function(){function a(a){}for(var b={},d=
0;45>d;d++)b["abcdefghijklmnopqrstuvwxyz0123456789'%./:<>?[".charAt(d)]=d;for(var h={},d=0;45>d;d++)h['ABCDEFGHIJKLMNOPQRSTUVWXYZ*!-+()@{|}"]^_`~$&#'.charAt(d)]=d;for(var c={},d=0;45>d;d++)c["abcdefghijklmnopqrstuvwxyz0123456789'%./:<>?[".charAt(d)]='ABCDEFGHIJKLMNOPQRSTUVWXYZ*!-+()@{|}"]^_`~$&#'.charAt(d);var e="abcdefghijklmnopqrstuvwxyz0123456789'%./:<>?[".split(""),k=e.length,l=new f.compression.LZW({});f.Define.clazz("qubit.compression.Compressor",a);a.prototype.compress=function(a,b){for(var c=
(b||l).encode(a),e=[],d=0;d<c.length;d++)e.push(String.fromCharCode(c[d]));return e.join("")};a.prototype.compressAnsi=function(a,b){for(var d=(b||l).encode(a),g=[],f=0;f<d.length;f++){var h;h=d[f];var t=0,s=0>h;s&&(h=-h);var m="",p=!0;do t=h%k,p?(m=c[e[t]],p=!1):m=e[t]+m,h=(h-t)/k;while(0<h);h=s?"-"+m:m;g.push(h)}return g.join("")};a.prototype.decompressAnsi=function(a,c){for(var e=[],d="",g=0;g<a.length;g++){var f=a.charAt(g);if(h.hasOwnProperty(f)){for(var f=d+f,d="",t=0,A=0,m=!0,p=0;p<f.length;p++){var r=
f.charAt(f.length-1-p);m&&(m=!1,r="abcdefghijklmnopqrstuvwxyz0123456789'%./:<>?[".charAt(h[r]));t+=b[r]*Math.pow(k,A++)}f=t;e.push(f)}else d+=f}return(c||l).decode(e)};a.prototype.decompress=function(a,b){for(var c=[],e=0;e<a.length;e++)c.push(a.charCodeAt(e));return(b||l).decode(c)}})();(function(){function a(a){for(var b=[],e=0;e<a.length;e++){var d=c(a[e][0]);b.push([new RegExp(d,"g"),"*"+a[e][1]])}return b}function b(a,c){for(var e=0;e<c.length;e++)if(c[e][1]===a)return c[e][0];return null}function d(b){this._regexDefs=
m;this._defs=n;b&&b.definitions&&(this._regexDefs=a(b.definitions),this._defs=b.definitions)}function h(a,b){for(var c=[],e=0;e<a.length;e++){var d=!0;b&&(d=a.charCodeAt(e)<=b);var g=l.cookieAlphabetMap.hasOwnProperty(a.charAt(e));d&&!g?c.push("*"+a.charCodeAt(e)+"."):c.push(a.charAt(e))}return c.join("")}function c(a){return a.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function e(a){for(var b={},c="",e=0;e<a.length;e++){var d=a.charAt(e);p[d]?c+=d:(isNaN(b[c])&&(b[c]=a.split(c).length-1),c="")}a=
[];for(var g in b)b.hasOwnProperty(g)&&(c=b[g],c>=q&&g.length>=r&&a.push([g,c]));return a=a.sort(function(a,b){return a[0].length===b[0].length?0:b[0].length>a[0].length?1:-1})}var k=f.Define,l=f.Cookie,n=[['","referrer":[{"url":"http://',"1-"],['","referrer":[{"url":"https://',"2-"],[',"referrer":[{"url":"http://',"3-"],[',"referrer":[{"url":"https://',"4-"],[',"sessionStartTime":',"5-"],["www.google.co.uk","6-"],["www.google.","7-"],['"sessionStartTime":',"8-"],['"landing":"',"9-"],["http%3A%2F%2Fwww",
"10-"],['"landing":',"L"],['"time":',"A"],['"pageViews":',"P"],['"sessionCount":',"B"],['"referrer":',"R"],['"url":"http://www.',"J"],['"url":"https://www.',"M"],['"url":"',"I"],['"url":',"U"],["http://www.","W"],["https://www.","V"],["%2Fen%2Ftsuk%2F","K"],['"sessionLandingPage":',"F"],["http%3A%2F%2F","D"],["http://","H"],["https://","X"],['""',"O"],['",',"Y"],['":{}}',"z"],["<","S"],[">","G"],["[","Z"],["]","E"],["{","a"],["}","b"],["(","c"],[")","d"],["!","e"],["#","f"],["$","g"],["!","q"],["'",
"i"],[":","j"],["?","k"],["^","x"],["`","m"],["|","n"],["~","o"],["%","v"],[",","C"]],m=a(n);k.clazz("qubit.opentag.compression.Encoder",d);d.prototype.encode=function(a,b){for(var d=a.replace(/\*/g,"**"),g=e(d),f=0;f<this._regexDefs.length;f++)var k=this._regexDefs[f],d=d.replace(k[0],k[1]);d=d.replace(/;/g,"*-");d=d.replace(/&/g,"*.");d=d.replace(/\\/g,"*/");d=d.replace(/=/g,"*+");d=d.replace(/\n/g,"*N");d=d.replace(/ /g,"*_");d=d.replace(/\t/g,"*T");d=d.replace(/"/g,"*Q");f=e(d);f.concat(g);for(var g=
d.replace(/@/g,"@@"),k=[],l=0,n=0;l<f.length;l++){var m=new RegExp(c(f[l][0]),"g"),m=g.replace(m,"@"+n+"-");m!==g&&(k.push(f[l][0]),n++,g=m)}f=[g,k];g=f[1];(k=0<g.length)&&(d=f[0]);d=b?h(d,b):h(d);return k?"Y"+g.join("*")+"@"+d:"N"+d};for(var p={},k=0;65>k;k++)p["abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ+_.".charAt(k)]=!0;var r=4,q=2;d.prototype.decode=function(a){var c=null;if("N"===a.charAt(0))a=a.substring(1);else if("Y"===a.charAt(0)){var e=a.indexOf("@");if(0<=e&&(c=a.substring(1,
e),c=c.split("*"),a=a.substring(e+1),c&&0!==c.length&&a)){for(var e="",d=!1,g=!1,f="",h=0;h<a.length;h++){var k=a.charAt(h);"@"===k||d||g?d||g?(d=!1,"@"===k?e+="@":isNaN(+("-"+k))?g?(e=c&&"-"===k&&c[+f]?e+c[+f]:e+("@"+f+k),f="",g=!1):e+="@"+k:(g=!0,f+=k)):d=!0:e+=k}f&&(e+="@"+f);d&&(e+="@");a=e}}c="";d=e=!1;g="";for(f=0;f<a.length;f++)h=a.charAt(f),"*"===h||e||d?e||d?(e=!1,isNaN(+("-"+h))?d?(c="."===h?c+String.fromCharCode(+g):"-"===h&&b(g+"-",this._defs)?c+b(g+"-",this._defs):c+("*"+g+h),g="",d=
!1):"*"===h?c+="*":"-"===h?c+=";":"/"===h?c+="\\":"."===h?c+="&":"+"===h?c+="=":"N"===h?c+="\n":"_"===h?c+=" ":"T"===h?c+="\t":"Q"===h?c+='"':null!==b(h,this._defs)?(h=b(h,this._defs),c+=h):c+="*"+h:(g+=h,d=!0)):e=!0:c+=h;g&&(c+="*"+g);e&&(c+="*");return c}})();(function(){function a(a){this.testBinary=!1;this.binSupported=d;a&&(this.compressor=new f.compression.Compressor,this.encoder=new f.opentag.compression.Encoder({}))}var b=f.Cookie,d=!1;f.Define.clazz("qubit.opentag.compression.CookieCompressor",
a);a.prototype.compress=function(a,c){if("string"!==typeof a||""===a)return a;var e=this.encoder.encode(a),d;if(this.binSupported||this.testBinary){d=this.compressor.compress(e);d='"B'+this.encoder.encode(d,128)+'"';b.set("__qtag_test_bin__",d,void 0,void 0,!0);var g=b.get("__qtag_test_bin__",!0);b.rm("__qtag_test_bin__");g&&g!==d&&(d=null)}g=this.encoder.encode(this.compressor.compressAnsi(e));e=!c&&e.length<=g.length?"E"+e:"C"+g;return d&&d.length<e.length?d:e};a.prototype.decompress=function(a){if("string"!==
typeof a||""===a)return a;'"'===a.charAt(0)&&(a=a.substring(1,a.length-1));var b=a.charAt(0);a=a.substring(1);switch(b){case "E":return this.encoder.decode(a);case "C":return a=this.compressor.decompressAnsi(this.encoder.decode(a)),this.encoder.decode(a);case "B":return a=this.compressor.decompress(this.encoder.decode(a)),this.encoder.decode(a);default:throw"This code is not supported! Code: "+b;}}})();(function(){var a=f.Cookie,b=f.opentag.Utils,d=function(){};f.Define.clazz("qubit.opentag.Session",
d);var k=new f.opentag.compression.CookieCompressor({});d.readCompressedCookie=function(b){b=a.get(b,!0);return k.decompress(b)};d.setupSession=function(c){var e=c.config,f,l,n,m,p;f={};f.sessionCount=h.update(e.cookieDomain);p="qtag_"+c.getContainerId();var r="x_qtag_"+c.getContainerId();n=a.get(p);c=!!n;null===n&&(n=a.get(r,!0),n=k.decompress(n));if(n)try{n=y.parse(n)}catch(q){n={sc:0,sessionCount:0,pageViews:0,sessionStartTime:0,referrer:[],sessionLandingPage:"",__v:{}}}else n={sc:0,sessionCount:0,
pageViews:0,sessionStartTime:0,referrer:[],sessionLandingPage:"",__v:{}};l=(new Date).getTime();f.sessionCount!==parseInt(n.sc,10)?(n.sessionStartTime=l,n.sc=f.sessionCount,n.sessionCount+=1,n.referrer.push({url:d.getReferrer(),landing:b.getUrl().substring(0,300),time:l}),n.sessionLandingPage=b.getUrl().substring(0,300)):d.isReferrerDifferent()&&!d.referrerIsSameAsPrevious(n.referrer,l,18E5)&&(n.referrer.push({url:d.getReferrer(),landing:b.getUrl().substring(0,300),time:l}),n.sessionLandingPage=b.getUrl().substring(0,
300),n.sessionStartTime=l,n.sessionCount+=1);f.sessionCount=n.sessionCount;f.sessionStartTime=n.sessionStartTime;f.pageStartTime=l;n.pageViews+=1;f.pageViews=n.pageViews;f.sessionLandingPage=n.sessionLandingPage;f.referrer=n.referrer;5<f.referrer.length&&f.referrer.splice(2,f.referrer.length-5);m=y.stringify(n);for(l=0;k.compress(m).length>e.maxCookieLength&&5>l;)3<=n.referrer.length?n.referrer.splice(2,1):2===n.referrer.length?n.referrer=[n.referrer[0]]:1===n.referrer.length&&(n.referrer=[]),m=y.stringify(n),
l+=1;f.referrer=n.referrer;c&&a.rm(p);p=k.compress(m);a.rm(r);0<e.maxCookieLength&&a.set(r,p,365,e.cookieDomain,!0);f.setVariable=function(b,c,d){n.__v[b]=[c,d?d:0];b=k.compress(y.stringify(n));0<e.maxCookieLength?a.set(r,b,365,e.cookieDomain,!0):a.rm(r)};f.getCookie=function(b,c){var e=a.get(b,!0);if(e&&(c||0===b.indexOf("x_")))try{e=k.decompress(e)}catch(d){}else null!==e&&(e=a.decode(e));return e};f.getVariable=function(a){var b;if(a=n.__v[a])if(b=a[1],0===b||b>(new Date).getTime())return a[0];
return null};f.on=function(a,b,c){b.attachEvent?b.attachEvent("on"+a,c):b.addEventListener&&b.addEventListener(a,c,!1)};f.getTagCookie=function(){return d.readCompressedCookie(r)};return d.lastSession=f};d.referrerIsSameAsPrevious=function(a,e,f){var h,k;return 0<a.length?(h=d.getReferrer(),k=b.getUrl().substring(0,300),a=a[a.length-1],a.url===h&&a.landing===k&&a.time+f>e):!1};d.isReferrerDifferent=function(){var a,b;b=d.getReferrer();a=b.indexOf("://");if(-1===a)return!0;try{return 0!==b.substring(a+
3).indexOf(d.getDomain())?!0:!1}catch(f){return!0}};d.getReferrer=function(){return document.referrer?document.referrer.substring(0,300):"direct"};d.getDomain=function(){return document.location.host}})();(function(){function a(b){d.setIfUnset(b,a.defaultConfig);if(this.singleton){var e=f.opentag.Utils.getObjectUsingPath(this.PACKAGE_NAME+"."+this.CLASS_NAME,l);if(e.__instance)return e.__instance;e.__instance=this}a.SUPER.call(this,b)}function b(a,e){var f=a.toString(),f=f.replace(/\s*function\s*\([\w\s,_\d\$]*\)\s*\{/,
""),f=f.substring(0,f.lastIndexOf("}")),f=f.replace(/(["']\s*\+\s*)\s*_*\w+\s*\.\s*valueForToken\s*\(\s*'([^']*)'\s*\)/g,'$1"${$2}"'),f=f.replace(/\s*_*\w+\s*\.\s*valueForToken\s*\(\s*'([^']*)'\s*\)(\s*\+\s*["'])/g,'"${$1}"$2'),f=f.replace(/(["']\s*\+\s*)\s*_*\w+\s*\.\s*valueForToken\s*\(\s*"([^"]*)"\s*\)/g,'$1"${$2}"'),f=f.replace(/\s*_*\w+\s*\.\s*valueForToken\s*\(\s*"([^"]*)"\s*\)(\s*\+\s*["'])/g,'"${$1}"$2'),f=f.replace(/(\s*)_*\w+\s*\.\s*valueForToken\s*\(\s*'([^']*)'(\s*)\)/g,"$1${$2}$3"),f=
f.replace(/(\s*)_*\w+\s*\.\s*valueForToken\s*\(\s*"([^"]*)"(\s*)\)/g,"$1${$2}$3"),f=e.replaceTokensWithValues(f);d.geval(f)}var d=f.opentag.Utils,h=f.Define;f.Define.clazz("qubit.opentag.LibraryTag",a,f.opentag.BaseTag);a.defaultConfig={vendor:null,imageUrl:null,description:"",async:!1,isPrivate:!1,upgradeable:!0,html:"",parameters:[],prePostWindowScope:!1};a.prototype.pre=function(){};a.prototype.post=function(){};a.prototype.before=function(){a.SUPER.prototype.before.call(this);try{var c=this.config;
if(c&&c.pre)if("function"===typeof c.pre)this.pre=c.pre;else{var e=this.replaceTokensWithValues(String(c.pre));this.pre=d.expressionToFunction(e).bind(this)}this.config.prePostWindowScope&&this.pre!==a.prototype.pre&&this.pre.toString?b(this.pre,this):this.pre()}catch(f){return!0}return!1};a.prototype.after=function(c){a.SUPER.prototype.after.call(this,c);try{var e=this.config;if(e&&e.post)if("function"===typeof e.post)this.post=e.post;else{var f=this.replaceTokensWithValues(String(e.post));this.post=
d.expressionToFunction(f).bind(this)}this.config.prePostWindowScope&&this.post!==a.prototype.post&&this.post.toString?b(this.post,this):this.post(c)}catch(h){}};a.define=function(b,e){b=b.replace(/^[\.]+/g,"").replace(/[\.]+$/g,"").replace(/\.+/g,".");b=f.Define.vendorsSpaceClasspath(b);var k={};e.getDefaultConfig&&(k=e.getDefaultConfig());var l=e.CONSTRUCTOR,n={},p;for(p in e)"config"!==p&&(n[p]=e[p]);n=f.opentag.Utils.defineWrappedClass(b,a,n,m,function(a){a=a||{};a=d.overrideFromLeftToRight(k,
a);var b=f.opentag.LibraryTag.call(this,a);l&&l.call(this,a);if(b)return b});p=h.STANDARD_VS_NS+".";0!==b.indexOf(p)&&d.namespace(p+b,n);return n};a.getLibraryByClasspath=function(a){return d.getObjectUsingPath(a,f.Define.getVendorSpace())}})();(function(){function a(){}var b=f.opentag.LibraryTag,d=f.Define;a.library=function(){return b.define.apply(b,arguments)};a.libraryRef=function(){return b.getLibraryByClasspath.apply(b.getLibraryByClasspath,arguments)};d.namespace("qubit.Quick",a)})();(function(){function a(b){this.runQueue=
[];this.tags={};this.config={cookieDomain:"",maxCookieLength:1E3,gzip:!0,delayDocWrite:!1,clientId:"",name:"",tellLoadTimesProbability:null,pingServerUrl:null,trackSession:null,disabled:!1,containerId:"",scanTags:!1,noPings:!1};this.ignoreTagsState=!1;if(b){this.setConfig(b);b.name||(this.config.name="Cont-"+q++);a.register(this);a.NO_PINGS&&(this.config.noPings=!0);this.ping=new f.opentag.Ping(this.config);this._sendPingsTrigger=this.sendPings.bind(this);if(b.init)try{b.init.call(this,b)}catch(c){}var e=
this;this._tagLoadedHandler=function(a){e._containerAlreadySentPings&&e.sendPingsNotTooOften()}}return this}function b(a,c,e){a[e]&&(y[e]=y[e]||1,e+="("+y[e]+")",y[e]++);a[e]=c}var d=f.opentag.Utils,h=f.opentag.filter.BaseFilter,c=f.opentag.filter.Filter,e=f.opentag.BaseTag,k=f.opentag.Timed,l=f.opentag.Tags,m=f.opentag.Session,r=f.Cookie,q=1;try{window.opentag_consentGiven=function(){a.consentIsGiven=!0;for(var b=a.getContainers(),c=0;c<b.length;c++)try{b[c].run()}catch(e){}}.bind(this)}catch(x){}f.Define.clazz("qubit.opentag.Container",
a);var u=[];a.register=function(a){d.addToArrayIfNotExist(u,a)};a.prototype.isTellingLoadTimes=function(){var a=this.config.tellLoadTimesProbability;null===a&&(a=0);return a>Math.random()};a.prototype.destroy=function(a){this.destroyed=!0;this.unregister();if(a)for(var b in this.tags)a=this.tags[b],a instanceof e&&(a.destroy(),this.tags[b]=null,delete this.tags[b]);b=this.PACKAGE_NAME.split(".");b=b[b.length-1];a=d.getParentObject(this.PACKAGE_NAME);a[b]=null;delete a[b]};a.findContainersByName=function(a){for(var b=
this.getContainers(),c=[],e=0;e<b.length;e++)b[e].config.name===a&&c.push(b[e]);return c};a.getById=function(a){for(var b=this.getContainers(),c=0;c<b.length;c++)if(b[c].getContainerId()===a)return b[c];return null};a.prototype.unregister=function(b){a.unregister(this,b)};a.unregister=function(a,b){d.addToArrayIfNotExist(u,a);d.removeFromArray(u,a);if(b)for(var c in this.tags){var f=this.tags[c];f instanceof e&&(f.unregister(),this.tags[c]=null,delete this.tags[c])}};a.prototype.hasConsent=function(){return"Accepted"===
r.get("qubitconsent")};a.prototype.register=function(b){a.register(b||this)};a.getContainers=function(){return u};a.prototype.getContainers=function(){return a.getContainers()};a.prototype.onTagRegistered=function(a){};a.prototype.registerTag=function(a){var b=a.config.name;if(!this.tags[b]){this.tags[b]=a;a.onAfter(this._tagLoadedHandler);try{this.onTagRegistered(a)}catch(c){}}};a.prototype.registerTags=function(a){for(var b=0;b<a.length;b++)this.registerTag(a[b])};a.prototype.setConfig=function(a){for(var b in a)this.config[b]=
a[b]};a.prototype.run=function(){this.runTags({command:"runOnceIfFiltersPass"})};a.prototype.runWithoutFilters=function(){this.runTags({command:"run"})};a.prototype.getTagByname=function(a){return this.tags[a]};a.prototype.containerScriptLoadedSynchronously=function(){var a,b,c,e,d;e=document.getElementsByTagName("script");a=0;for(b=e.length;a<b;a+=1)if(c=e[a],(d=c.getAttribute("src"))&&0<d.indexOf(""+this.config.clientId+"-"+this.getContainerId()+".js"))return null===c.getAttribute("async")&&(!1===
c.getAttribute("defer")||""===c.getAttribute("defer")||null===c.getAttribute("defer"));return!0};a.prototype.prepareSessionIfNeeded=function(){var b=this.config.trackSession;if(!0!==b&&!1!==b){var b=this.tags,e;for(e in b)if(b.hasOwnProperty(e)){var d=b[e];d.resolveAllDynamicData();for(var d=d.getFilters(),f=0;f<d.length;f++){var g=d[f];if(g instanceof c&&g.isSession()){this.trackSession=!0;break}}if(this.trackSession)break}}else this.trackSession=b;a.TRACK_SESSION&&(this.trackSession=!0);this.trackSession&&
(this.session=m.setupSession(this))};a.prototype.runTags=function(b,c){if(this.destroyed)throw"Container has been destroyed.";if(c||!a.LOCKED&&!d.global().QUBIT_CONTAINERS_LOCKED){if(this.onBeforeRun)try{this.onBeforeRun()}catch(e){}var f=!this.containerScriptLoadedSynchronously(),h="runIfFiltersPass";b&&b.command&&(h=b.command);this.runningStarted=(new Date).valueOf();var l={};this.config.scanTags&&!this._scanned&&(this.scanForTags(),this._scanned=(new Date).valueOf());this.prepareSessionIfNeeded();
for(var s=this.getTagsInOrder(),m=0;m<s.length;m++)try{var p=s[m],n=p.config.name;if(this.includedToRun(p)){var r=p.resolveDependencies();if(0<r.length)for(var q=0;q<r.length;q++){var u=r[q],x=u.config.name;!l[x]&&this.tags[x]&&(l[x]=u,this._tagRunner(u,h,f))}l[n]||(l[n]=p,this._tagRunner(p,h,f))}}catch(y){}k.setTimeout(function(){this.sendPingsNotTooOften()}.bind(this),3100);this.waitForAllTagsToFinish()}};a.prototype.getTagsInOrder=function(){var a=[],b;for(b in this.tags){var c=this.tags[b],e=
c.config.priority;if(0<+e){for(var d=0,f=0;f<a.length;f++){var g=a[f];if(g)if(g=+g.config.priority,0<g&&g>e)d++;else break}a.splice(d,0,c)}else a.push(c)}return a};a.prototype._tagRunner=function(a,b,c){try{this.includedToRun(a)&&(c&&(a.forceAsynchronous=!0),this.config.delayDocWrite&&(a.delayDocWrite=!0),a.session=a.session||this.session,a[b]())}catch(e){}};a.prototype.getContainerId=function(){if(this.config.containerId)return this.config.containerId;if(this._pkgName)return this._pkgName;var a=
this.PACKAGE_NAME.split(".");return this._pkgName=a=a[a.length-1]};a.prototype.includedToRun=function(b){if(!b)return!1;var c=b.config;if(c.inactive||c.disabled&&!b.cookieSaysToRunEvenIfDisabled()||b.disabledByCookie())return!1;c=a.consentIsGiven||!c.needsConsent||this.hasConsent();b=b.state===e.prototype.STATE.INITIAL;return this.ignoreTagsState||c&&b};a.prototype.scanForTags=function(a,b){a&&(this.tags={});var c;c=b&&"object"===typeof b?this.findAllTags(b):this.findAllTagsByClassPath();this.registerTags(c);
return c};a.prototype.findAllTags=function(a,b){a=a||this.tagsPackageName||this.PACKAGE_NAME;return l.findAllTags(a,b)};a.prototype.findAllTagsByClassPath=function(a){a=a||this.PACKAGE_NAME;return l.findAllTagsByClassPath(a)};a.prototype.findAllFilters=function(a,b){a=a||this.tagsPackageName||this.PACKAGE_NAME;return l.findAllFilters(a,b)};a.prototype.waitForAllTagsToFinish=function(){if(!this._waitForAllTagsToFinishWaiting){this._lastWaited||(this._lastWaited=(new Date).valueOf());var a=15E3<(new Date).valueOf()-
this._lastWaited,a=this.allTagsFinished()||a;if(!this._showFinishedOnce&&a){if(this._lastWaited=null,this._showFinishedOnce=!0,this.runningFinished=(new Date).valueOf(),this._containerAlreadySentPings=(new Date).valueOf(),this.sendPingsNotTooOften(),this.onTagsInitiallyRun)this.onTagsInitiallyRun()}else a||(this._waitForAllTagsToFinishWaiting=!0,this._showFinishedOnce=!1,k.setTimeout(function(){this._waitForAllTagsToFinishWaiting=!1;this.waitForAllTagsToFinish()}.bind(this),100))}};a.prototype.onTagsInitiallyRun=
p;a.prototype.resetAllTags=function(a){for(var b in this.tags)if(this.tags.hasOwnProperty(b)){var c=this.tags[b];c.reset();a||c.resetFilters()}};a.prototype.reset=function(a){this._showFinishedOnce=this.runningStarted=this._waitForAllTagsToFinishWaiting=this.runningFinished=void 0;this.resetAllTags(a)};a.prototype.sendPingsNotTooOften=function(){this._sndLck=this._sndLck||{};k.runIfNotScheduled(this._sendPingsTrigger,2E3,this._sndLck)};a.prototype.sendPings=function(){if(!this.config.noPings){var a;
if(this.isTellingLoadTimes()){var b=this.getAllTagsByState(),c=[];b.run&&(c=l.getLoadTimes(b.run));this.lastPingsSentTime=(new Date).valueOf();this.ping.send(this,c);var c=l.getLoadTimes(),e=[];for(a=0;a<c.length;a++){var d=c[a].tag;d.config.dedupe&&d.sendDedupePing&&e.push(d)}0<e.length&&(this.lastDedupePingsSentTime=(new Date).valueOf(),this.ping.sendDedupe(this,e));if(b.other){c=l.getLoadTimes(b.other);e=[];for(a=0;a<c.length;a++)e.push(c[a]);0<e.length&&this.ping.send(this,e)}if(b.awaiting){c=
l.getLoadTimes(b.awaiting);b=[];for(a=0;a<c.length;a++)b.push(c[a]);0<b.length&&this.ping.send(this,b)}}}};a.prototype.getAllTagsByState=function(){return a.getAllTagsByState(this.tags)};a.getAllTagsByState=function(a){var c=null,d=null,f=null,g=null,k=null,l=null,m=e.prototype.STATE.EXECUTED_WITH_ERRORS,p;for(p in a){var n=a[p];if(n instanceof e){var r=n.config.name;0<n.scriptExecuted?(c=c||{},b(c,n,r)):n.locked?(l=l||{},b(l,n,r)):0>n.scriptExecuted||n.state>=m?(g=g||{},b(g,n,r)):n.filtersState()===
h.state.SESSION||0<n.filtersState()?(f=f||{},b(f,n,r)):n.config.needsConsent?(k=k||{},b(k,n,r)):(d=d||{},b(d,n,r))}}return{run:c,failed:g,awaiting:f,consent:k,locked:l,other:d}};var y={};a.prototype.allTagsFinished=function(){for(var a in this.tags)if(this.tags.hasOwnProperty(a)){var b=this.tags[a];if(b instanceof f.opentag.BaseTag){var c=b.filtersState();if(!b.config.disabled){var e=0>b.filtersState()&&!b.locked,d=!(b.finished()||b.config.runner&&!b.isRunning);if(e&&d&&(b=0<+b.awaitingDependencies,
c!==h.state.SESSION&&!b))return!1}}}return!0};a.prototype.getPageVariables=function(){var a=[],b;for(b in this.tags)if(this.tags.hasOwnProperty(b))for(var c=this.tags[b].getPageVariables(),e=0;e<c.length;e++)d.addToArrayIfNotExist(a,c[e]);return a};a.getPageVariableByName=function(a){for(var b=this.getAllPageVariables(),c=[],e=0;e<b.length;e++)b[e].config.name===a&&c.push(b[e]);return c};a.prototype._getCookieNameForDisabling=function(){return"qubit.opentag.disableContainerRunning_"+this.getContainerId()+
this.config.name};a.prototype.disabledByCookie=function(){return!!r.get(this._getCookieNameForDisabling())};a.prototype.setCookieToDisable=function(){r.set(this._getCookieNameForDisabling(),"true")};a.prototype.rmCookieToDisable=function(){r.rm(this._getCookieNameForDisabling())};a.rmAllDisablingCookies=function(){d.rmCookiesMatching("qubit.opentag.disableContainerRunning_")};a.setCookieForDisabledContainersToRun=function(){r.set("qubit.opentag.forceContainerRunning","true")};a.rmCookieForDisabledContainersToRun=
function(){r.rm("qubit.opentag.forceContainerRunning")}})();(function(){function a(d){b.setIfUnset(d,{url:null,html:"",locationPlaceHolder:"NOT_END",locationObject:"BODY",async:!0});a.SUPER.call(this,d)}var b=f.opentag.Utils;f.Define.clazz("qubit.opentag.CustomTag",a,f.opentag.LibraryTag)})();(function(){var a={callbacks:{},unfired_events:[],early_callbacks:null,currentUV:null},b,d="universal_variable";a._isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)};a._targetChanged=
function(b,c,e){if(null===e)return"null"===c?!1:!0;if(void 0===e)return c===e?!1:!0;c=y.parse(c);c=a._getNested(c,b);b=a._getNested(e,b);return!a._jsonIsEqual(c,b)};a._processCallbacks=function(){var b;if(a.early_callbacks&&0<a.early_callbacks.length){for(b=0;b<a.early_callbacks.length;b+=1)a.push(a.early_callbacks[b]);a.early_callbacks=null}};a._keyStringToArr=function(a){a=a.replace(/^\s+/,"").replace(/\s+$/,"");if(""===a)return[];a=a.replace(/\[(\w+)\]/g,".$1");a=a.replace(/^\./,"");return a.split(".")};
a._getNested=function(b,c){for(var e=a._keyStringToArr(c),d;0<e.length;)if(d=e.shift(),b.hasOwnProperty(d))b=b[d];else return;return b};a._jsonIsEqual=function(b,c){"string"!==typeof b&&(b=y.stringify(b,a._stripEvents));"string"!==typeof c&&(c=y.stringify(c,a._stripEvents));return b===c};a._stripEvents=function(a,b){if("events"!==a)return b};a._on=function(b,c){var e;e=b.split(":");b=e[0];e=e[1];a.callbacks[b]=a.callbacks[b]||[];e?a.callbacks[b].push({keyString:e,func:c}):a.callbacks[b].push({func:c})};
a._trigger=function(d,c){var e,f;if(a.callbacks[d])for(e=0;e<a.callbacks[d].length;e+=1)"function"===typeof a.callbacks[d][e].func&&((f=a.callbacks[d][e].keyString)?"change"===d&&a._targetChanged(f,a.currentUV,b)&&a.callbacks[d][e].func(c):a.callbacks[d][e].func(c))};a._eventsPush=function(d){var c,e;b.events[b.events.length]=d;d.time=d.time||(new Date).getTime();if(a.callbacks.event)for(c=0,e=a.callbacks.event.length,c;c<e;c+=1)a.callbacks.event[c].func(d);d.has_fired=!0};a._getUnfiredEvents=function(){for(var d=
0,d=0;d<b.events.length;d+=1)b.events[d].has_fired||(a.unfired_events.push(b.events.splice(d,1)[0]),d-=1)};a._fireEvents=function(){for(;0<a.unfired_events.length;)b.events.push(a.unfired_events.shift())};a._resetEventsPush=function(){b.events=b.events||[];-1!==b.events.push.toString().indexOf("[native code]")&&(b.events.push=a._eventsPush,a._getUnfiredEvents(),a._fireEvents())};a._checkForChanges=function(){a.callbacks.change&&0<a.callbacks.change.length&&!a._jsonIsEqual(a.currentUV,b)&&(a._trigger("change",
b),a.currentUV=y.stringify(b,a._stripEvents))};a._setUVLocation=function(b){d=b;a._initUV()};a._initUV=function(){window[d]=window[d]||{events:[]};b=window[d];b.events||(b.events=[])};a.push=function(b){a._isArray(b)&&("on"===b[0]?a._on(b[1],b[2]):"trigger"===b[0]&&b[1]&&a._trigger(b[1]))};a.init=function(b,c){c&&(d=c);a._initUV();!window.uv_listener||a._isArray(window.uv_listener)?(a.early_callbacks=window.uv_listener||null,window.uv_listener=a,b||a.start()):c&&window.uv_listener._setUVLocation(d)};
a.start=function(){a.currentUV=y.stringify(b,a._stripEvents);setInterval(function(){a._initUV();a._resetEventsPush();a._checkForChanges()},500);a._processCallbacks()};r.UVListener=a})();(function(){function a(){}function b(a,e,d){!d||void 0!==a[e]&&""!==a[e]&&null!==a[e]||(a[e]=d)}var d=f.Cookie,h=f.opentag.Utils;f.opentag.Log.setLevelFromCookie();a.run=function(){var b=!1,e;a:{try{var h=m.TAGSDK_MAIN_DISABLED_FUNCTION;if(h&&h()){e=!0;break a}}catch(k){}e=0<=document.location.href.indexOf("opentag_disabled=true")?
!0:!1}if(!e){e=!1;if(d.get("opentag_debug_tool")||0<=document.location.href.indexOf("opentag_debug_tool"))e=!0;!e&&(e=!1,d.get("opentag_debug")||0<=document.location.href.indexOf("opentag_debug"))&&(e=!0);e&&(m.TAGSDK_NS_OVERRIDE=f.DEBUG_MODE?!1:!0,b=!0);f.DEBUG_MODE&&(m.TAGSDK_NS_OVERRIDE=!1);try{r.UVListener.init()}catch(l){}a.runAllContainers(b)}};a.runAllContainers=function(c){try{for(var e=f.opentag.Container.getContainers(),d=0;d<e.length;d++){var g=e[d],k=g.config;if(!g.runningStarted&&!g.configuredInMain){k.scanTags=
!0;var l=h.getParentObject(g.PACKAGE_NAME).ClientConfig;l&&b(g.config,"clientId",l.id);var p=h.getParentObject(g.PACKAGE_NAME).SystemDefaults;p&&(b(k,"pingServerUrl",p.pingServerUrl),b(k,"tellLoadTimesProbability",p.tellLoadTimesProbability));g.configuredInMain=!0;c?(g.destroy(!0),a.loadDebugVersion(g)):m.QUBIT_OPENTAG_STOP_MAIN_EXECUTION?function(){var a=f.opentag.RUN_STOPPED_EXECUTON;f.opentag.RUN_STOPPED_EXECUTON=function(){try{a&&a()}finally{g.run()}}}(g):g.run()}}}catch(r){}};a.loadDebugVersion=
function(a){var b=document.createElement("script"),d,g=a.config.scriptURL,h;(h=f.opentag.Utils.getParentObject(a.PACKAGE_NAME).ClientConfig)&&h.clientId?h=h.clientId:(h=a.PACKAGE_NAME.split("."),h=h[h.length-2].substring(1));a=a.getContainerId();g&&(d=g,d.lastIndexOf("-debug.js")!==d.length-9&&(d=d.substring(0,d.length-3),d+="-debug.js"));b.src=d&&"//d3c3cq33003psk.cloudfront.net/opentag-"+h+"-"+a+"-debug.js"!==d?d:"//s3-eu-west-1.amazonaws.com/opentag/opentag-"+h+"-"+a+"-debug.js";document.getElementsByTagName("head")[0].appendChild(b)};
f.Define.namespace("qubit.opentag.Main",a)})();var G=!1;try{"object"===typeof module&&module.exports&&(module.exports=d,G=!0)}catch(D){}!G&&window&&(window.uv=d());var H={},L=[],K=!1,M=!1,I=f.Define.global(),G={allEventsByType:H,subscribe:function(a,b){if(M)I.uv.on(a,b);else L.push({on:[a,b]})},getEventHistory:function(a){return this.allEventsByType[a]},publish:function(a,b){M?I.uv.emit(a,b):L.push({emit:[a,b]})},connect:function(){k()}};G.connect();f.Define.namespace("qubit.qprotocol.PubSub",G);
(function(){function a(b){a.SUPER.apply(this,arguments)}var b=f.qprotocol.PubSub,d=f.opentag.Utils;f.Define.clazz("qubit.opentag.pagevariable.QProtocolVariable",a,f.opentag.pagevariable.BaseVariable);a.prototype.init=function(){if(this.initialized)return!1;this.initialized=(new Date).valueOf();this.callHandlersOnRead=!0;if(!this.handlerAttached){var a=this,c=this.getValueAndPath(this.value);this.eventName=c[0];this.objectPath=c[1];this.updateValue();b.subscribe(this.eventName,function(b){a.updateValue(b)});
this.handlerAttached=(new Date).valueOf()}};a.prototype.getValueAndPath=function(a){var b=a,e;if(b){var d=a.indexOf(":");-1!==d&&(b=a.substring(0,d),e=a.substring(d+1))}return[b,e]};a.prototype.getValue=function(){this.init();return this.currentValue};a.prototype.getEventsHistory=function(){return b.getEventHistory(this.eventName)};a.prototype.updateValue=function(a){if(!a){var b=this.getEventsHistory();b&&(a=b.current)}b=this.objectPath;a=a&&b?d.getObjectUsingPath(b,a):a;this._updateCurrentValue(a);
return a};a.prototype.startObservingForChanges=function(){};a.prototype.stopObservingForChanges=function(){}})();(function(){function a(b){a.SUPER.apply(this,arguments)}f.Define.clazz("qubit.opentag.pagevariable.UniversalVariable",a,f.opentag.pagevariable.Expression)})()})();
(function(){function b(d,h,k){this.collectLogs=!!b.COLLECT;this.collectLocally=k;this.collection=[];this.getPrefix=function(){var b="";h&&("function"===typeof h?b=h(this.ref):h.CLASS_NAME?b=h.CLASS_NAME:h.constructor&&h.constructor.name&&(b=h.constructor.name),b&&(b+=" -> "));return(d||"")+b}}function h(d,h,k,l,m,q,u,D){var H=b.LEVEL>=D;if(0<=b.COLLECT_LEVEL||H)h=m?[l,u,k]:[h+d.getPrefix()+l,q,k],h[3]=D,d.collect(h,D),H&&d.printMessage.apply(d,h)}var d=qubit.opentag.Utils,k=null;d.clazz("Log",b);
b.LEVEL_FINEST=4;b.LEVEL_FINE=3;b.LEVEL_INFO=2;b.LEVEL_WARN=1;b.LEVEL_ERROR=0;b.LEVEL_NONE=-1;b.MAX_LOG_LEN=1E4;b.prototype.MAX_LOG_LEN=-1;b.LEVEL=b.LEVEL_NONE;b.COLLECT_LEVEL=b.LEVEL_FINE;b.COLLECT=!0;var l=[];b.logsCollection=l;b.rePrintAll=function(d,h,l,m){var r=b.LEVEL;void 0!==d&&(b.LEVEL=d);try{if(b.COLLECT){try{l||k.clear()}catch(q){}var u=m||b.logsCollection,D=0;for(l=0;l<u.length;l++)(function(k){var l=u[k];k=l[3];void 0!==k&&b.LEVEL>=k&&(D++,h?setTimeout(function(){void 0!==d&&(b.LEVEL=
d);try{b.print.apply(b,l)}finally{b.LEVEL=r}},D*h):b.print.apply(b,l))})(l)}}catch(H){}finally{b.LEVEL=r}};var m=!!d.global().webkitURL;b.isStyleSupported=function(){return m};var q={};b.setConsole=function(b){return k=b=b||q};b.delayPrint=-1;var u=(new Date).valueOf();b.prototype.printMessage=function(d,h,k,l){if(0<b.delayPrint){var m=b.delayPrint,q=u-(new Date).valueOf();0<q&&(m+=q);try{setTimeout(function(){this.print(d,h,k,l)}.bind(this),m)}catch(G){setTimeout(function(){this.print(d,h,k,l)}.bind(this),
m)}u=(new Date).valueOf()+m}else this.print(d,h,k,l)};b.prototype.print=function(d,h,k,l){b.print(d,h,k,l)};b.print=function(d,h,l,m){if(!(void 0!==m&&b.LEVEL<m))try{if(k&&k.log)if(h&&b.isStyleSupported())if(l&&k[l])k[l]("%c"+d,h);else k.log("%c"+d,h);else if(l&&k[l])k[l](d);else k.log(d)}catch(r){}};b.prototype.collect=function(d,h){void 0===h&&(h=b.COLLECT_LEVEL);var k=!1,m=this.collectLogs&&b.COLLECT&&b.COLLECT_LEVEL>=+h;m&&(l.push(d),k=!0);this.collectLocally&&m&&(this.collection.push(d),k=!0);
0<b.MAX_LOG_LEN&&l.length>b.MAX_LOG_LEN&&l.splice(0,l.length-b.MAX_LOG_LEN);if(0<b.MAX_LOG_LEN||0<this.MAX_LOG_LEN)m=b.MAX_LOG_LEN,0<this.MAX_LOG_LEN&&(m=this.MAX_LOG_LEN),this.collection.length>m&&this.collection.splice(0,this.collection.length-m);return k?d:null};b.clearAllLogs=function(){try{k.clear()}catch(b){}finally{l.splice(0,l.length)}};b.getCollectedByLevel=function(b,d){d=d||l;for(var h=[],k=0;k<d.length;k++){var m=d[k];m[0][4]===b&&h.push(m)}return h};b.prototype.rePrint=function(d,h,k){b.rePrintAll(d,
h,!k,this.collection)};b.prototype.FINEST=function(d,k){h(this,"FINEST: ",!1,d,k,"color:#CCCCCC;",!1,b.LEVEL_FINEST)};b.prototype.FINE=function(d,k){h(this,"FINE: ",!1,d,k,"color:#999999;",!1,b.LEVEL_FINE)};b.prototype.INFO=function(d,k,l){h(this,"INFO: ","info",d,k,l,l,b.LEVEL_INFO)};b.prototype.WARN=function(d,k){h(this,"WARN: ","warn",d,k,"color:#26A110;",!1,b.LEVEL_WARN)};b.prototype.ERROR=function(d,k){h(this,"ERROR: ","error",d,k,"color:red;",!1,b.LEVEL_ERROR)};b.setConsole(d.global().console)})();
function fitTextarea(b){"textarea"===b.tagName.toLowerCase()&&(b.style.overflow="hidden",b.style.height="0px",b.scrollHeight,b.style.height=25+b.scrollHeight+"px",b.style.overflow="")}function nextNode(b){for(;!b.tagName;)b=b.nextSibling;return b}
function toggleShowSibling(b,h){for(var d=h||b.nextSibling;d&&!d.style;)d=d.nextSibling;if(d){var k=!1;d.cmNode&&"none"===d.cmNode.style.display?(d.cmNode.style.display="",k=!0):d.cmNode||"none"!==d.style.display?(d.style.display="none",d.cmNode&&(d.cmNode.style.display="none")):(d.style.display="",k=!0,"TEXTAREA"===d.tagName&&attachEditor(d),fitTextarea(d));(d=b.children[0])&&"true"===d.getAttribute("plus")&&(d.innerHTML=k?"-":"+")}}
function attachEditor(b){b.cm=CodeMirror.fromTextArea(b,{lineNumbers:!0,mode:"javascript",theme:"ambiance",tabMode:"indent",matchBrackets:!0,extraKeys:{"Ctrl-Q":function(b){b.foldCode(b.getCursor())}},foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"]});b.cm.on("change",function(){b.value=b.cm.getValue()});b.cmNode=b.nextSibling}
function getParametersAndConfigForTagNode(b,h,d){var k=b.getElementsByTagName("input");b=b.reference.config;for(var l=0;l<k.length;l++){if(!h&&-1!==k[l].className.indexOf("red"))return"red";if(void 0!==k[l].pindex){var m=k[l].pindex;b.parameters[m].inputVariable=k[l].value;b.parameters[m].variable=void 0;if(k[l].value)try{var q=qubit.opentag.Utils.gevalAndReturn(k[l].value),q=q?q.result:q;b.parameters[m].variable={value:q}}catch(u){logError("Error reading configuration"+u)}}else if(!d&&void 0!==k[l].cname)switch(m=
k[l].cname,m){case "url":case "html":case "urlLocation":case "vendor":case "imageUrl":case "url":b[m]=k[l].value;break;default:try{b[m]=qubit.opentag.Utils.gevalAndReturn(k[l].value).result}catch(f){}}}return d?{parameters:b.parameters}:b}function applyParametersAndConfigToTag(b,h){b.parameters=h.parameters;for(var d in h)b[d]=h[d]}
function classPath(b){if(b){b=b.split(".");for(var h=0;h<b.length;h++){var d=b[h],d=d.replace(/\s+/g,"_"),d=d.replace(/[\W+]/g,"");d.match(/^\d+/)&&(d="_"+d);b[h]=d}return b.join(".").replace(/^[\.]+/g,"").replace(/[\.]+$/g,"").replace(/\.+/g,".")}return b}function getLibraryReferenceNode(b){for(;null!==b&&!b.reference;)b=b.parentNode;return b}window.__tmp__qubit__test_page_8_=null;
function extractFunctionOrString(b){var h=qubit.opentag.Utils.trim(b);return 0===h.indexOf("function")?(qubit.opentag.Utils.geval("window.__tmp__qubit__test_page_8_="+h),window.__tmp__qubit__test_page_8_):b}var IS_IE=!1;-1!==navigator.appName.indexOf("Internet Explorer")&&(IS_IE=!0);
function getXMLHttpRequest(){var b;try{b=new ActiveXObject("Microsoft.XMLHTTP")}catch(h){try{b=new ActiveXObject("Msxml2.XMLHTTP")}catch(d){try{b=new XMLHttpRequest}catch(k){throw"Your browser does not support AJAX!";}}}IS_IE?window.onerror=function(){}:b.onerror=function(){};return b}
function GET(b,h,d){var k=getXMLHttpRequest();k.onreadystatechange=function(){4===k.readyState&&h(k.responseText,k)};d=void 0===d?!0:d;try{k.onerror=function(b){logError("Error while sending GET:"+b)}}catch(l){}b=fakeParam(b);k.open("GET",b,d);k.send()}
function POST(b,h,d,k){var l=getXMLHttpRequest();l.onreadystatechange=function(){4===l.readyState&&d(l.responseText,l)};k=void 0===k?!0:k;try{l.onerror=function(b){logError("Error while sending POST:"+b)}}catch(m){}b=fakeParam(b);l.open("POST",b,k);l.setRequestHeader("Content-type","application/x-www-form-urlencoded");l.send(h)}function fakeParam(b){return b&&-1!==b.lastIndexOf("?")?b+"&fparam="+(new Date).getTime()*Math.random():b+"?fparam="+(new Date).getTime()*Math.random()}
function theProgressBar(b,h){var d=!1,k=document.getElementById("progress-bar-template").innerHTML;if(d)return!1;theProgressBar.title=b;var d=!0,l=document.createElement("div");l.className="progress-bar";l.innerHTML=k;document.body.appendChild(l);l.bar=l.children[0].children[0];l.titleNode=l.bar.children[0];l.titleNode.innerHTML=theProgressBar.title;l.progress=l.bar.children[1];var m=function(){var b=h();100<=b?(l.titleNode.innerHTML=theProgressBar.title+" 100% Done.",l.progress.style.width="100%",
setTimeout(function(){d=!1;document.body.removeChild(l)},200)):(l.titleNode.innerHTML=theProgressBar.title+" "+Math.floor(b)+"%",l.progress.style.width=Math.floor(b)+"%",setTimeout(m,20))};m();return!0}
function qconsole(){this.init=function(){if(!this.initialized){this.initialized=!0;var b=document.getElementById("console-template").innerHTML;this.container=document.createElement("div");this.container.className="qconsole";this.container.innerHTML=b;this.msgContainer=this.container.children[1];document.body.appendChild(this.container);this.msgContainer.scrollTop=this.msgContainer.scrollHeight;var h=this;this.container.ondblclick=function(){info("[double click] Clearing & hiding console...");h.clear();
h.hide()}}};this.log=function(b){var h=document.getElementById("console-msg-template").innerHTML,d=document.createElement("div");d.className="msg";d.innerHTML=h;d.msg=d.children[1];d.header=d.children[0];d.msg.innerHTML=" >>> "+b;this.msgContainer.appendChild(d);this.msgContainer.scrollTop=this.msgContainer.scrollHeight};this.clear=function(){this.msgContainer.innerHTML=""};this.show=function(){qubit.opentag.Utils.addClass(this.container,"shown");qubit.opentag.Utils.removeClass(this.container,"hidden");
this.hidden=!1};this.hide=function(){qubit.opentag.Utils.removeClass(this.container,"shown");qubit.opentag.Utils.addClass(this.container,"hidden");this.hidden=!0};this.init()}var Utils=qubit.opentag.Utils;
function runTagHandler(b){var h=getParametersAndConfigForTagNode(b);if("red"===h)logError("Please fill all highlighed parameter values.\n They are required for tag to run.",2E3);else{var d=APP_PATH+"getClassPath?classPath=libraries."+b.reference.PACKAGE_NAME+".local&file=UVConf.js";GET(d,function(k,l){var m=!0;200!==l.status&&(m=!1,log("UVConfig not found. Proceeding normally."));try{m&&(log("Evaluating UVConf.js from "+d),qubit.opentag.Utils.geval(k))}catch(q){error("Exception while running UVConf.js: "+
q)}finally{runTag(b,h)}})}}
function runTag(b,h){try{var d={},k=b.classReference,l=b.reference;applyParametersAndConfigToTag(d,h);try{for(var m=d.parameters,q=0;q<m.length;q++)for(var u=m[q],f=0;f<l.config.parameters.length;f++){var x=l.config.parameters[f];if(x.token===u.token){u.uv=x.uv;break}}}catch(B){}var p=l.preNode.value;String(p)!==l.config.pre&&String(p)!==String(l.pre)&&(d.pre=extractFunctionOrString(p));var r=l.postNode.value;String(r)!==l.config.post&&String(r)!==String(l.post)&&(d.post=extractFunctionOrString(r));
var y=l.scriptNode.value;String(y)!==l.config.script&&String(y)!==String(l.script)&&(d.script=extractFunctionOrString(y));var G=new k(d);info("triggering run() for "+G.config.name+" ...");G.run();G.log.INFO("Currently executed tag instance is exposed as <pre>window.instance<pre>");info("Currently executed tag instance is exposed as <pre>window.instance<pre>Please open web console to see more logs.<br/>To view library the logs run:<pre>instance.log.rePrint(5);</pre>in web console.",5E3);window.instance=
G}catch(D){logError("Error while executing configuration:"+D)}}
function saveConfig(b){b=getLibraryReferenceNode(b);var h=b.reference;b=getParametersAndConfigForTagNode(b,!0,!0);for(var d=0;d<b.parameters.length;d++)b.parameters[d].variable=void 0,delete b.parameters[d].variable;b=json.serialize({parameters:b.parameters},{prettyPrint:!0});d=h.PACKAGE_NAME+".local";b=encodeURIComponent("//:import CurrentSDK\n"+("qubit.opentag.Utils.namespace('"+d+"');\n")+d+".Config = "+b+";");POST(APP_PATH+"saveConfig","classPath=libraries."+h.PACKAGE_NAME+".local&config="+b,
function(b,d){var h=qubit.opentag.Utils.gevalAndReturn(b);h&&h.result.ok?info("Saved"):logError(b)})}
function saveNewVersion(b,h){(h||window.event).ignoreEvent=!0;b=getLibraryReferenceNode(b);var d=b.reference,k=prompt("Please enter the name of the new version, eg 'v1'.\n\n");if(k){var k=classPath(k),d=d.PACKAGE_NAME,l=d.split(".");POST(APP_PATH+"saveNewVersion","location=libraries&classPath="+d+"&version="+(l[0]+"."+l[1])+"."+k,function(b,d){var h=qubit.opentag.Utils.gevalAndReturn(b);h&&h.result.ok?(info("Created new version."),info("Rebuilding system...",1E4),rebuildAndReload()):logError("Error while creating new version: "+
b)})}}function rebuildAndReload(){if(window.buildLocationString){var b="path="+encodeURIComponent(window.buildLocationString);GET(APP_PATH+"rebuild?"+b,function(b,d){var k=qubit.opentag.Utils.gevalAndReturn(b);k&&k.result.ok?(info("System has been rebuilt for "+window.buildLocationString,1E4),info("Reloading page."),location.reload()):logError("Rebuild failed! "+b)})}}var editUVURL=LIBRARIES_REPO_LOC+"shared/templates/UVConf.js";
function editUVURLHandler(b){GET(editUVURL,function(h,d){200!==d.status?logError(h):editUV(b,h)})}function editUV(b,h){openInEditorAndCreate("libraries."+b.reference.PACKAGE_NAME+".local","UVConf.js",!0,h)}function openInEditorHandler(b){openInEditorAndCreate("libraries."+b.reference.PACKAGE_NAME,"Tag.js",!1)}
function openInEditorAndCreate(b,h,d,k){k="classPath="+b+"&file="+h+"&create="+!!d+"&data="+encodeURIComponent(k);POST(APP_PATH+"openInEditor",k,function(b,d){var h=qubit.opentag.Utils.gevalAndReturn(b);h&&h.result.ok||(logError(b),logError("Make sure that CLASSPATH of your library matches its location!"))})}
function reloadTagHandler(b){var h=qubit.opentag.Utils,d=b.reference,k=b.libraryWidget,l=b.classReference.versionClassPath,m="classPath=libraries."+d.PACKAGE_NAME+"&file=Tag.js";reloadTests(b);POST(APP_PATH+"getClassPath",m,function(m,u){200!==u.status&&logError("Error loading tag: "+m);try{var f=getParametersAndConfigForTagNode(b,!0,!0);try{h.getObjectUsingPath(d.PACKAGE_NAME).Tag=void 0}catch(x){}qubit.opentag.Utils.geval(m);var B=h.getObjectUsingPath(d.PACKAGE_NAME+".Tag");B.versionClassPath=l;
k.renderLibraryToNode(B,null,null,f)}catch(p){logError("Error loading tag: "+p)}})}function cancelEvent(b){b.stopPropagation?b.stopPropagation():b.cancelBubble=!0}var Utils=qubit.opentag.Utils,testSuiteCodeTemplateURL=LIBRARIES_REPO_LOC+"shared/templates/TestsSuite.js";function addEditTests(b){GET(testSuiteCodeTemplateURL,function(h,d){200!==d.status?logError(h):addEditStandardTests(b,h)})}
function addEditStandardTests(b,h){if(b=getLibraryReferenceNode(b)){var d=b.reference,k=h.replace("_PACKAGE_",d.PACKAGE_NAME),k=k.replace("_TAG_",d.PACKAGE_NAME+".Tag"),l=d.PACKAGE_NAME.split(".").join("/"),k=k.replace("_TAGPATH_",l+"/Tag.js");openInEditorAndCreate("libraries."+d.PACKAGE_NAME+".local","TestsSuite.js",!0,k)}}var bddSuiteCodeTemplateURL=LIBRARIES_REPO_LOC+"shared/templates/BDDSuite.js";
function addEditDescribeTests(b){GET(bddSuiteCodeTemplateURL,function(h,d){200!=d.status?logError(h):addEditBDDTests(b,h)})}function addEditBDDTests(b,h){if(b=getLibraryReferenceNode(b)){var d=b.reference,k=h.replace("_PACKAGE_",d.PACKAGE_NAME),k=k.replace("_TAG_",d.PACKAGE_NAME+".Tag"),l=d.PACKAGE_NAME.split(".").join("/"),k=k.replace("_TAGPATH_",l+"/Tag.js");openInEditorAndCreate("libraries."+d.PACKAGE_NAME+".local","BDDSuite.js",!0,k)}}function reloadTests(b){_reloadTest(b,"BDDSuite.js")}
function _reloadTest(b,h){var d=qubit.opentag.Utils,k=b.reference,l=b.libraryWidget;POST(APP_PATH+"getClassPath","classPath=libraries."+k.PACKAGE_NAME+".local&file="+h,function(h,q){200!==q.status&&log("Error loading test (probably no tests). "+h);try{var u=getParametersAndConfigForTagNode(b,!0,!0);try{d.getObjectUsingPath(k.PACKAGE_NAME).local.TestsSuite=void 0}catch(f){}qubit.opentag.Utils.geval(h);var x=d.getObjectUsingPath(k.PACKAGE_NAME+".Tag");l.renderLibraryToNode(x,null,null,u)}catch(B){log("Error loading test: "+
B)}finally{reloadBDDTests(b)}})}
function reloadBDDTests(b){var h=qubit.opentag.Utils,d=b.reference,k=b.libraryWidget;POST(APP_PATH+"getClassPath","classPath=libraries."+d.PACKAGE_NAME+".local&file=BDDSuite.js",function(l,m){200!==m.status&&log("Error loading test (probably no tests). "+l);try{var q=getParametersAndConfigForTagNode(b,!0,!0);try{h.getObjectUsingPath(d.PACKAGE_NAME).local.BDDSuite=void 0}catch(u){}qubit.opentag.Utils.geval(l);var f=h.getObjectUsingPath(d.PACKAGE_NAME+".Tag");k.renderLibraryToNode(f,null,null,q)}catch(x){log("Error loading test: "+
x)}})}var testsRunning=!1;
function runAllTests(b){if(testsRunning)info("Wait for currently running tests to finish.");else{testsRunning=!0;for(var h=document.getElementsByTagName("div"),d=0,k=0,l=[],m=0;m<h.length;m++){var q=h[m];"true"===q.getAttribute("library-node")&&(++d,l.push(q))}var u=function(f){try{var h=l[f];h&&runTestsHandler(h,function(){++k;k<d&&setTimeout(function(){u(k)},5);k===d&&(testsRunning=!1,b&&b())})}catch(m){}};u(0);theProgressBar("Running test suites...",function(){return 0===k?0:k/d*100})}}
function runTestsHandler(b,h){try{var d=b.reference,k=qubit.opentag.Utils,l=k.getObjectUsingPath(d.PACKAGE_NAME+".local.TestsSuite"),m=k.getObjectUsingPath(d.PACKAGE_NAME+".local.BDDSuite"),q=function(){var d=!1;l&&!l.isFinished()?d=!0:m&&!m.isFinished&&(d=!0);if(!d){d=!1;if(m)for(var q=m.children,u=0;u<q.length;u++)if("failed"===q[u].result.status){d=!0;break}q=!1;l&&l.failedTests&&0<l.failedTests.length&&(q=!0);if(m||l)q||d?k.addClass(b,"tests-failed"):k.addClass(b,"tests-passed");h&&h()}};l||m?
(l&&runSuite(l,q),m&&runBDDSuite(m,q)):(h&&h(),k.addClass(b,"tests-notests"),log("No tests detected for "+d.config.name))}catch(u){logError("Error while executing tests suite:"+u)}}function runSuite(b,h){b?(b.onFinished=function(){h&&h()},b.run()):h&&h()}function runBDDSuite(b,h){if(b){var d=b.resultCallback;b.resultCallback=function(){d.apply(b,arguments);b.isFinished=!0;if(h)try{h()}catch(k){window.log("Error while running test:"+k)}};b.execute()}else h&&(b.isFinished=!0,h())}Utils=qubit.opentag.Utils;
function toggleUVSelector(b){"Close UV Browser"===b.innerHTML?(document.getElementById("uv-selector-holder").innerHTML="",b.innerHTML="Browse UV"):(openUVVariableSelector(),b.innerHTML="Close UV Browser")}function openUVVariableSelector(){var b=document.getElementById("uv-selector-holder");b.innerHTML="";renderUVSelector(b)}var uvPopupTemplate=document.getElementById("uv-popup-template").innerHTML;
function renderUVSelector(b,h){b.innerHTML="";var d=document.createElement("div");d.innerHTML=uvPopupTemplate;b.appendChild(d);var k=d.children[0].children[1].children[0].children[0],l=d.children[0].children[2];loadUVVariables(function(){for(var b=window.UVS,d=0;d<b.length;d++)(function(b){b.onclick=function(){l.value=b.expr;l.className="result";h&&h(b.expr)}})(renderUVSelectorItemYoNode(k,b[d]))})}var uvPopupItemTemplate=document.getElementById("uv-popup-item-template").innerHTML;
function renderUVSelectorItemYoNode(b,h){var d=document.createElement("div");d.innerHTML=uvPopupItemTemplate;var k=d.children[0].children[1];d.children[0].children[0].innerHTML=h.name;k.innerHTML=h.description;d.expr=h.expression;b.appendChild(d);return d}
function loadUVVariables(b){window.UVS?b&&b(UVS):GET(LIBRARIES_REPO_LOC+"shared/bin/html/data/uv.data",function(h,d){200!==d.status&&log("Error loading UV data: "+h);try{for(var k=h.split("\n"),l=[],m={},q=0;q<k.length;q++){var u=k[q].split("\t"),f={name:u[1],expression:u[2],description:u[3]};m[f.expression]=f;l.push(f)}window.UVS=l;window.EUVS=m;b(l)}catch(x){logError("Error loading UVs: "+x)}})}
(function(){function b(b,d){for(var f=0;f<d.length;f++)if("function"===typeof d[f]&&b instanceof d[f])return!0;return!1}function h(b,d){for(var f=0;f<d.length;f++)if(typeof b===d[f])return!0;return!1}function d(b,d){for(var f=0;f<d.length;f++)d[f]===b&&d.splice(f,1);return d}function k(b){return'"'+b.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"'}function l(b,d){return b?" "+d:d}function m(b,d,f,h,k){var l=" ";""===f&&(l="");return(f||h?0===k.length?[l,b,k.join(","),d]:[l,b,"\n",f,u,k.join(",\n"+
f+u),"\n",f,d]:[b,k.join(","),d]).join("")}var q={};q.checkIfInstanceOf=b;var u="  ",f=function(p,r,q,x,D){if(isNaN(D)||!(x>=D)){var H,B,K,M,I=!1,a,O=!0,g=!1,s=!1,c=!1,e=!1;r&&(r.prettyPrint&&(e=!0),r.raw&&(g=r.raw),r.excludedInstances&&(H=r.excludedInstances),r.excludedTypes&&(B=r.excludedTypes),r.excludedNames&&(K=r.excludedNames),r.own&&(M=r.hasOwn),r.fakeFunctions&&(s=r.fakeFunctions),r.realFunctions&&(c=r.realFunctions),r.includeFunctions&&(I=r.includeFunctions),r.excludeOnTrue&&(a=r.excludeOnTrue),
r.dateAsString&&(O=r.dateAsString));var z="",J="";if(e){for(e=0;e<x;e++)z+=u;J="\n"}if(p instanceof Date)return!g||O?k(p.toISOString()):p.valueOf();if(I||"function"!==typeof p){if("number"===typeof p)return l(z,String(p));if("string"===typeof p)return l(z,k(p));if(null===p)return l(z,"null");if(void 0===p)return g?l(z,"undefined"):void 0;if("boolean"===typeof F)return l(z,String(p));if(I&&"function"===typeof p&&s)return"(function(){})";if(I&&"function"===typeof p&&c)return l(z,p.toString());a:{if(p instanceof
Object)for(F=0;F<q.length;F++)if(q[F]===p){F=!0;break a}F=!1}if(!F){q.push(p);++x;if(p instanceof Array){K=[];for(e=0;e<p.length;e++){if(a)try{if(a(p))continue}catch(n){}if(!H||!b(p,H))if(!B||!h(p,B)){try{var v=f(p[e],r,q,x,D)}catch(P){return d(p,q),k(String(P))}void 0!==v&&K.push(v)}}d(p,q);return m("[","]",z,J,K)}var v=[],E;for(E in p){var F=p[E];if(!M||p.hasOwnProperty(E)){if(a)try{if(a(p))continue}catch(w){}if(!H||!b(F,H))if(!B||!h(F,B)){if(I=K)a:{for(I=0;I<K.length;I++)if(E===K[I]){I=!0;break a}I=
!1}if(!I)try{var t=f(F,r,q,x,D);if(void 0!==t){var A='"'+E.replace(/\"/g,'\\"')+'":'+t;v.push(A)}}catch(C){return d(p,q),k(String(C))}}}}d(p,q);return m("{","}",z,J,v)}}}};q.serialize=function(b,d){var h;d&&(h=d.level);return f(b,d,[],0,h)};var x=(0,eval("this"))||function(){return this}()||this.window;q.parse=function(b){if(/[^,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]/.test(b.replace(/"(\\.|[^"\\])*"/g,"")))throw"insecure json!";b="json.___tmp = ("+b+")";x.execScript?x.execScript(b):x.eval.call(x,b);return q.___tmp};
x.json=q;try{module.exports=q}catch(B){}})();
(function(){function b(b){b&&(this.parentContainer=b.parentContainer,this.container=b.container,this.className=b.className,this.maxTime=b.maxTime,this.closeable=b.closeable,this.init())}b.prototype.init=function(){this.container=this.container||document.createElement("div");this.container.className+=" qubit-notification "+(this.className?this.className:"")};b.prototype.drawCloseButton=function(){var b=this;this.closeable&&(this.closeButton=document.createElement("div"),0===this.container.childNodes.length?
this.container.appendChild(this.closeButton):this.container.insertBefore(this.closeButton,this.container.childNodes[0]),this.closeButton.className="notification-close-button",this.closeButton.onclick=function(){b.destroy()})};b.prototype.show=function(){this.container.style.display=""};b.prototype.hide=function(){this.container.style.display="none"};b.prototype.setContent=function(b){this.content!==b&&(this.content=b,this.container.innerHTML="","object"===typeof b?this.container.appendChild(b):this.container.innerHTML=
b,this.drawCloseButton());return b};b.prototype.paint=function(){this.painted||(this.parentContainer.appendChild(this.container),this.painted=!0)};b.prototype.destroy=function(){try{if(this.onDestroy)this.onDestroy()}finally{this.container.parentNode&&this.container.parentNode.removeChild(this.container)}};window.Notification=b})();
(function(){function b(b){b&&(this.maxTime=+b.maxTime||6E4,this.notifiers={},this.className=b.className,this.parentContainer=b.parentContainer||document.body,this.container=b.container||document.createElement("div"),this.init())}var h=window.Notification;b.prototype.notify=function(b,k,l,m,q){if(!this.notifiers[b]){l=new h({parentContainer:this.container,maxTime:l,className:m,closeable:q});var u=this;l.onDestroy=function(){delete u.notifiers[b]};this.notifiers[b]=l;l.paint()}this.notifiers[b].show();
this.notifiers[b].setContent(k);this.notifiers[b].timestamp=(new Date).valueOf()};b.prototype.done=function(b,h,l){this.notify(b,h);var m=this;setTimeout(function(){m.notifiers[b]&&(m.notifiers[b].destroy(),delete m.notifiers[b])},l)};b.prototype.init=function(){this.setParentContainer(this.parentContainer);var b=this,h;h=function(){b.container&&b.container.parentNode&&(b.oldNotifiersCheck(),setTimeout(h,500))};h()};b.prototype.setParentContainer=function(b){this.parentContainer=b;this.parentContainer.appendChild(this.container);
this.container.className.lastIndexOf(" qubit-notificationmanager"===-1)&&(this.container.className+=" qubit-notificationmanager "+this.className)};b.prototype.oldNotifiersCheck=function(){var b,h;for(b in this.notifiers)this.notifiers.hasOwnProperty(b)&&(h=this.notifiers[b].maxTime||this.maxTime,(new Date).valueOf()-this.notifiers[b].timestamp>h&&this.notifiers[b].destroy())};b.prototype.clear=function(){for(var b in this.notifiers)this.notifiers.hasOwnProperty(b)&&this.notifiers[b].destroy()};window.NotificationManager=
b})();var Utils=qubit.opentag.Utils,parameterTemplate=document.getElementById("parameter-template").innerHTML,parametersTemplate=document.getElementById("parameters-template").innerHTML;function Parameters(b){b&&(this.config=b,this.init())}Utils.clazz("ui.Parameters",Parameters);Parameters.prototype.paint=function(){this.painted=!0;this.config.parentContainer.appendChild(this.container)};
Parameters.prototype.init=function(){var b=document.createElement("div");b.innerHTML=parametersTemplate;b.className="parameters-container";this.container=b;for(var h=b.children[1].children[0],d=b.children[1].children[1],k=this.config.params,l=0;l<k.length;l++){var b=document.createElement("div"),m=k[l];b.innerHTML=parameterTemplate;var q=b.getElementsByTagName("input")[0];q.pindex=l;b.paramNode=q;b.uvNode=b.getElementsByTagName("input")[1];b.getElementsByTagName("label")[0].innerHTML=m.name+" (token: <pre style='display:inline'>"+
m.token+"</pre>)";var u=!1;m.uv?(u=!0,b.uvNode.value=m.uv):(Utils.addClass(b.uvNode,"no-uv"),b.uvNode.value="edit script to set universal variable");m=void 0!==m.inputVariable?m.inputVariable:"";q.value=m;q.className=m||u?"":"red";u&&(q.setAttribute("onfocus",null),q.setAttribute("onblur",null));h.appendChild(b)}0===k.length?(d.style.display="none",h.innerHTML="<div class='no-params'>No parameters defined.</div>"):d.style.display=""};var excluded="parameters PACKAGE dependencies CONSTRUCTOR dedupe priv name description inactive vendor loadDependenciesOnLoad variables".split(" ");
function propertyExcludedFromConfig(b){for(var h=0;h<excluded.length;h++)if(b===excluded[h])return!0;return!1}var hidden=["filterTimeout","isPrivate",,"usesDocumentWrite","timeout","singleton","locationPlaceHolder","locationDetail","locationObject","noMultipleLoad","__proto__"];function propertyHiddenFromConfig(b){for(var h=0;h<hidden.length;h++)if(b===hidden[h])return!0;return!1}
function prepareConfigElement(b,h,d){var k=document.createElement("div");k.innerHTML=d;k.children[0].className="config";k.getElementsByTagName("input")[0].cname=b;k.getElementsByTagName("label")[0].innerHTML=b;void 0!==h&&(k.getElementsByTagName("input")[0].value=h);k.getElementsByTagName("input")[0].entered=!0;return k}var configTemplate=document.getElementById("config-template").innerHTML,hiddenConfigTemplate=document.getElementById("toggled-config-template").innerHTML;
function addConfig(b,h){var d=document.createElement("div");d.innerHTML=hiddenConfigTemplate;d.className="config-header";var k=d.children[0].children[0];k.innerHTML="<span plus='true'>+</span> Configuration";toggleShowSibling(k);var l=d.children[0].children[1];b.appendChild(d);for(var m in h)propertyExcludedFromConfig(m)||propertyHiddenFromConfig(m)||(k=prepareConfigElement(m,h[m],configTemplate),l.appendChild(k));d=document.createElement("div");d.innerHTML=hiddenConfigTemplate;d.className="config-header";
l.appendChild(d);k=d.children[0].children[0];l=d.children[0].children[1];toggleShowSibling(k);k.innerHTML="<span plus='true'>+</span> Advanced";for(m in h)!propertyExcludedFromConfig(m)&&propertyHiddenFromConfig(m)&&(k=prepareConfigElement(m,h[m],configTemplate),l.appendChild(k))}var prePostTemplate=document.getElementById("pre-post-script-template").innerHTML;
function addPrePostTemplate(b,h){var d=document.createElement("div");d.innerHTML=prePostTemplate;var k=d.getElementsByTagName("textarea"),l=k[0],m=k[1],k=k[2],q=h.config.post?h.config.post:String(h.post),u=h.config.script?h.config.script:String(h.script);l.value=String(h.config.pre?h.config.pre:String(h.pre));m.value=String(q);k.value=String(u);l.style.display="none";m.style.display="none";k.style.display="none";h.preNode=l;h.postNode=m;h.scriptNode=k;b.appendChild(d)}var testTemplate=document.getElementById("unit-test-template").innerHTML;
function addTest(b,h){var d=document.createElement("div");d.innerHTML=testTemplate;d.className="unit-test";h.testNode=d;h.statusNode=d.children[0];h.nameNode=d.children[1];h.nameNode.innerHTML=h.name;h.onFinished=function(){this.failed?Utils.addClass(this.statusNode,"failed"):this.passed&&Utils.addClass(this.statusNode,"passed")};b.appendChild(d)}
function addBDDTest(b,h){var d=document.createElement("div");d.innerHTML=testTemplate;d.className="unit-test";h.testNode=d;h.statusNode=d.children[0];h.nameNode=d.children[1];h.nameNode.innerHTML=h.description;var k=h.resultCallback;h.resultCallback=function(b){k.apply(h,arguments);"failed"===h.result.status?Utils.addClass(h.statusNode,"failed"):"passed"===h.result.status&&Utils.addClass(h.statusNode,"passed")};b.appendChild(d)}var testsSuiteTemplate=document.getElementById("unit-tests-suite-template").innerHTML;
function addTestsSuite(b,h){var d=document.createElement("div");d.className="unit-tests-suite";d.innerHTML=testsSuiteTemplate;var k=Utils.getObjectUsingPath(h.PACKAGE_NAME+".local.TestsSuite"),l=Utils.getObjectUsingPath(h.PACKAGE_NAME+".local.BDDSuite");b.appendChild(d);renderTestsToNode(d.children[1],k,l)}
function renderTestsToNode(b,h,d){b.innerHTML="";if(d){d.unitTestsNode=b;d=d.children;for(var k=0;k<d.length;k++)addBDDTest(b,d[k])}if(h)for(h.unitTestsNode=b,d=h.tests,k=0;k<d.length;k++)addTest(b,d[k])}function prepareVendorNode(b){var h=document.createElement("div");h.innerHTML="<a class='plain' href='#-2'>"+b+"</a>";h.className="vendor";h.children[0].onclick=function(){var b=this.ishidden?"show":"hide";this.ishidden=!this.ishidden;this.parentNode.className="vendor "+b};return h}
function findTags(b,h){h=h||[];Utils.traverse(b,function(d,k,l,m){d&&d.prototype&&"superclass"!==l&&d.prototype instanceof qubit.opentag.BaseTag&&d!==qubit.opentag.BaseTag&&d!==qubit.opentag.LibraryTag&&d!==qubit.opentag.CustomTag&&b.Tag!==d&&h.push(d)},{objectsOnly:!0,track:!0});return h}
(function(){function b(b){this.config=b||{};b&&(this.libraryNode=document.createElement("div"),this.config.parentContainer.appendChild(this.libraryNode),this.init(this.paint.bind(this)))}new Log("Library");var h=document.getElementById("library-template").innerHTML,d=qubit.opentag.Utils;d.clazz("ui.Library",b);b.prototype.paint=function(b){this.painted=!0;this.renderLibraryToNode(this.config.libraryClass,this.libraryNode,b||"hide")};b.prototype.init=function(b){var h=APP_PATH+"getClassPath?classPath=libraries."+
this.config.libraryClass.prototype.PACKAGE_NAME+".local&file=Config.js";try{GET(h,function(h){try{d.geval(h)}catch(l){}b&&b()})}catch(m){(b,m)&&b()}};b.prototype.renderLibraryToNode=function(b,l,m,q){q=q||{};var u=new b;u.unregister();if(q.parameters&&u.config.parameters)for(var f=0;f<q.parameters.length;f++)for(var x=q.parameters[f].token,B=0;B<u.config.parameters.length;B++)u.config.parameters[B].token===x&&(u.config.parameters[B].inputVariable=q.parameters[f].inputVariable);q=u.PACKAGE_NAME+"."+
u.CLASS_NAME;l||(l=document.getElementById(q),d.removeClass(l,"tests-failed"),d.removeClass(l,"tests-passed"),d.removeClass(l,"tests-notests"));l.setAttribute("library-node","true");l.innerHTML=h;f="";b.versionClassPath&&(f=b.prototype.PACKAGE_NAME.replace(b.versionClassPath+".",""),f=f.replace(/\._(\d)/g,".$1"),f="<span class='version-title'> ("+f+") </span>");l.children[0].children[1].innerHTML=u.config.name+f+"<a href='#-3' onclick='saveNewVersion(this, arguments[0]);'> clone </a>";d.addClass(l,
"library");m&&d.addClass(l,m);l.reference=u;l.libraryWidget=this;l.classReference=b;l.id=q;b=u.config.parameters;m=l.children[7].children[0];l=l.children[7].children[1];try{var p=d.getObjectUsingPath(u.PACKAGE_NAME+".local.Config");if(p&&p.parameters)for(var r=p.parameters,p=0;p<b.length;p++){var y=b[p];for(q=0;q<r.length;q++)if(y.token&&y.token===r[q].token){var G=b[p].inputVariable,D=b[p].uv;b[p]=r[q];G&&(b[p].inputVariable=G);D&&(b[p].uv=D);break}}}catch(H){}m.children[0].innerHTML=(u.config.imageUrl?
"<img class='logo' src='"+u.config.imageUrl+"' align='right' />":"")+u.config.description;(new ui.Parameters({parentContainer:l,params:b})).paint();addConfig(l,u.config);addPrePostTemplate(l,u);addTestsSuite(l,u)}})();qubit.VENDOR_SPACE_CP="";var Utils=qubit.opentag.Utils,log=new Log("Main");window.LIBRARIES={};
function renderAllLibrariesToPage(){var b=document.getElementById("libraries");b.innerHTML="";var h=[],d=qubit.vs;if(!d)try{d=qubit.vs}catch(k){}for(var l in d)if("PACKAGE_NAME"!==l&&"CLASSPATH"!==l){var m=d[l],q=prepareVendorNode(l),u;for(u in m)try{var f=m[u].Tag,x=[l,u].join(".");if(f){var B=new f({}),x=f.prototype.PACKAGE_NAME;B.unregister();B instanceof qubit.opentag.LibraryTag&&h.push([q,f,B])}for(var p=findTags(m[u]),r=0;r<p.length;r++){var y=new p[r]({});y.unregister();p[r].versionClassPath=
x;h.push([q,p[r],y])}}catch(G){window.console&&console.log?(console.log("Failed to load tag configuration, possible syntax error:"+G),info("Failed to load tag configuration, possible syntax error:"+G)):logError("Failed to load tag configuration, possible syntax error:"+G)}h.sort(function(b,d){var f=b[1],a=d[1],h=b[2].config,g=d[2].config;return h.name===g.name?(g=h="",f.versionClassPath&&(h=f.prototype.PACKAGE_NAME.replace(f.versionClassPath+".","")),a.versionClassPath&&(g=a.prototype.PACKAGE_NAME.replace(a.versionClassPath+
".","")),compareVersions(h,g)):h.name>g.name?1:h.name===g.name?0:-1});D+=h.length;b.appendChild(q)}var D=h.length,H=0;theProgressBar("Rendering...",function(){return H/D*100});var L=!1;(function(b){var d=0,f=function(){for(var a=0;8>a;a++){H++;if(d===b.length){L||setTimeout(bodyLoaded,200);L=!0;return}var h=b[d][1],g=new ui.Library({parentContainer:b[d][0],libraryClass:h});LIBRARIES[h.PACKAGE_NAME+"."+h.CLASS_NAME]=g;d++}setTimeout(f,4)};f()})(h)}var total=1,counted=0;
function loadAllLibs(b){GET(LIBRARIES_REPO_LOC+"shared/bin/html/scripts.txt",function(h){var d=[];h=h.split(",");h.push("shared/bin/html/js/build-location.js");total=1;counted=0;if(!b){b=[];for(var k=0;k<h.length;k++)h[k]&&-1==h[k].indexOf("CurrentSDK")&&b.push(h[k])}theProgressBar("Loading scipts",function(){return 0===counted?0:counted/(b.length+total)*100});var l=0,m=function(){if(l!==b.length){var h=l;l++;var k=LIBRARIES_REPO_LOC+b[h];setTimeout(function(){_loadSingle(k,h,m,b,d)},0)}};m()})}
function compareVersions(b,h){var d=b.replace(/\./g,".").split("."),k=h.replace(/\./g,".").split("."),l=null;if(d.length&&k.length){var m=d[0].replace(/[^\d+]/g,".").split("."),m=m[m.length-1],q=k[0].replace(/[^\d+]/g,".").split("."),q=q[q.length-1],u=d[0].substring(0,d[0].lastIndexOf(m)),f=k[0].substring(0,k[0].lastIndexOf(q));u!==f||isNaN(+m)||isNaN(+q)?d[0]>k[0]?l=!0:d[0]<k[0]&&(l=!1):+m<+q?l=!0:+m>+q&&(l=!1)}if(null===l)for(m=1;m<d.length&&m<k.length;m++)if(q=k[m],u=d[m],"0"!==u.charAt(0)&&"0"!==
q.charAt(0)||0===m||(u="0."+u,q="0."+q),!isNaN(+u)&&!isNaN(+q))if(+u<+q){l=!0;break}else{if(+u>+q){l=!1;break}}else if(u<q){l=!0;break}else if(u>q){l=!1;break}d.length!==k.length&&null===l&&(l=d.length<k.length);return!0===l?1:null===l?0:-1}function _loadSingle(b,h,d,k,l){GET(b,function(m,q){try{l[h]={expr:m,url:b},log(b),counted++,k.length===counted&&_allScriptsFetched(l)}finally{d&&d()}})}
function _allScriptsFetched(b){for(var h=0;h<b.length;h++)try{eval(b[h].expr)}catch(d){logError("Failed to load: "+b[h].url+"\nException: "+d)}theProgressBar.title+=", rendering... ";listScripts(b);setTimeout(function(){counted++;renderAllLibrariesToPage();window.toggleConsole();qubit.opentag.Log.LEVEL=3;qubit.opentag.Log.COLLECT_LEVEL=5},50)}
function keepRunningTests(){-1!==location.href.indexOf("runTests=true")&&(info("Running tests..."),runAllTests(function(){countdown("Automatically running tests... ",10);setTimeout(keepRunningTests,1E4)}))}function countdown(b,h,d){if(!(0>=h)){info(b+h+(d||""),1E3,"countdown");var k=h-1;setTimeout(function(){countdown(b,k)},1E3)}}function listScripts(b){}function bodyLoaded(){setTimeout(keepRunningTests,1E3)}
window.Main=function(){window.qlog=new qconsole;window.toggleConsole=function(){qlog.hidden?qlog.show():qlog.hide()};window.logError=function(b,h){log("<span style='color: red'>"+b+"</span>");info("<span style='color: #FF766F'>"+b+"</span>",h||5E3)};window.info=function(b,h,d){DefaultNotificationsMgr.notify(d||(new Date).valueOf(),b,h||2800,"",!0);log(b)};window.log=function(b){qlog.log(b)};Suite.log=Test.log=function(b){log(b)};loadAllLibs();window.DefaultNotificationsMgr=new NotificationManager({maxTime:4E3})};
