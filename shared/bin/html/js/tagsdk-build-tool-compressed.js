(function(){Function.prototype.bind=Function.prototype.bind||function(b){var g=this;return function(){return g.apply(b,arguments)}}})();var global=this;try{global=(0,eval)("this")||function(){return this}()||window}catch(e$$12){}global.VERSION="1.0.2-b1";var EMPTY_FUN=function(){},UNDEF=void 0;global.APP_PATH=global.APP_PATH||"/";global.LIBRARIES_REPO_LOC=global.LIBRARIES_REPO_LOC||"/";
(function(){var b,g;(function(){Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),d=this,n=function(){},c=function(){return d.apply(this instanceof n?this:a,b.concat(Array.prototype.slice.call(arguments)))};n.prototype=this.prototype;c.prototype=new n;return c})})();var e={__anonymous__:!0},l=null;try{l=(0,eval)("this")||
function(){return this}()}catch(k){}var e=l,f=e.qubit||{};e.qubit||(e.qubit=f);if(f.VERSION&&"3.0.2-r2"!==f.VERSION)try{console.warn("There is already 'qubit.VERSION' set to: "+f.VERSION)}catch(m){}f.VERSION="3.0.2-r2";try{module.exports=e}catch(p){}var r=function(){};(function(){function a(){}function b(c,h,d,n,f){c=c.split(".");var v=a.NAMESPACE_BASE||e,g=null,k=null;f&&(v=l);f=v;v=d||v;for(d=0;d<c.length-1;d+=1)k=c[d],v[k]=v[k]||{},v=v[k];g=v;k=c[c.length-1];l.TAGSDK_NS_OVERRIDE&&(n=!1);void 0!==
h?void 0!==g[k]&&n||(g[k]=h):g[k]=g[k]||{};h&&(h.CLASSPATH=c.join("."),c.splice(c.length-1,1),h.PACKAGE_NAME=c.join("."));return{root:f,object:g,instance:g[k]}}a.global=function(){return l};a.STANDARD_CS_NS="qubit.cs";a.clientSpaceClasspath=function(){return window.qubit.CLIENT_CONFIG?"qubit.cs.d"+window.qubit.CLIENT_CONFIG.id:a.STANDARD_CS_NS};a.globalNamespace=function(a,h,d,n){return b(a,h,d,n,!0)};a.namespace=function(a,h,d,n){return b(a,h,d,n,!1)};a.clientNamespace=function(c,h,d,n){return a.namespace(a.clientSpaceClasspath()+
"."+c,h,d,n)};a.clazz=function(c,h,d,n,b){a.namespace(c,h,n,!0);"function"===typeof d&&(h.SUPER=d,h.superclass=d,h.prototype=new d(b),h.prototype.SUPER=d,h.prototype.CLASS=h);c=c.split(".");h.prototype?(h.prototype.CLASSPATH=c.join("."),h.prototype.CLASS_NAME=c[c.length-1],c.splice(c.length-1,1),h.prototype.PACKAGE_NAME=c.join(".")):(h.CLASSPATH=c.join("."),h.STATIC_NAME=c[c.length-1],c.splice(c.length-1,1),h.PACKAGE_NAME=c.join("."));return h};a.clazz("qubit.Define",a);a.clientClazz=function(c,h,
d,n,b){return a.clazz(a.clientSpaceClasspath()+"."+c,h,d,n,b)};a.STANDARD_VS_NS="qubit.vs";a.vendorsSpaceClasspath=function(c){var h=f.VENDOR_SPACE_CP,h=void 0===h||null===h?a.STANDARD_VS_NS:h;return c?h?h+"."+c:c:h};var d=a.vendorsSpaceClasspath(),n;n=d?a.namespace(d,{},null,!0).instance:a.global();a.getVendorSpace=function(){return n};a.vendorNamespace=function(c,h,d,n){c=a.vendorsSpaceClasspath(c);return a.namespace(c,h,d,n)};a.vendorClazz=function(c,h,d,n,b){c=a.vendorsSpaceClasspath(c);return a.clazz(c,
h,d,n,b)}})();(function(){function a(a){}for(var b={},d=0;93>d;d++)b["abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ*!-#$&+()@'%./:<>?[\"]^_`{|}~\\;=".charAt(d)]=d;f.Define.clazz("qubit.Cookie",a);a.cookieAlphabet="abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ*!-#$&+()@'%./:<>?[\"]^_`{|}~\\;=";a.cookieAlphabetMap=b;a.decode=function(a){return unescape(a)};a.encode=function(a){return escape(a)};a.set=function(d,c,h,b,q){if(h){var e=new Date;e.setTime(e.getTime()+864E5*
h);h="; expires="+e.toGMTString()}else h="";q||(d=a.encode(d),c=a.encode(c));d=d+"="+c+h+"; path=/;";b&&(d+=" domain="+b);document.cookie=d};a.get=function(d,c){for(var h=d+"=",b=document.cookie.split(";"),q=0;q<b.length;q++){for(var e=b[q];" "===e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(h))return h=e.substring(h.length,e.length),c||(h=a.decode(h)),h}return null};a.getAllForName=function(d,c){if(!d)return[];for(var h=d+"=",b=document.cookie.split(";"),q=[],e=0;e<b.length;e++){for(var f=
b[e];" "===f.charAt(0);)f=f.substring(1,f.length);0===f.indexOf(h)&&(f=f.substring(h.length,f.length),c&&(f=a.decode(f)),q.push(f))}return q};a.getAll=function(d){for(var c=document.cookie.split(";"),h=[],b=0;b<c.length;b++){for(var q=c[b];" "===q.charAt(0);)q=q.substring(1,q.length);var e=q.substring(0,q.indexOf("=")),q=q.substring(e.length+1,q.length);d&&(q=a.decode(q));h.push([e,q])}return h};a.rm=function(d,c){a.set(d,"",-1,c)}})();(function(){function a(){}function b(a,c){for(var d=q.length,
h=0;h<d;h++)if(a===q[h][0])return q[h][1];q[q.length]=[a,c];return!1}function d(a,c,h,n,A){var f=!1,g=!1,z=!1,u=!1,l=!1,k=l=!1;c&&(f=(l=!!c.all)||c.nodes,u=l||c.win,g=l,k=!!c.emptyForMaxDeep,z=c.noFunctions&&!l,void 0!==c.noOwn&&(g=!!c.noOwn),void 0!==c.noFunctions&&(z=!!c.noFunctions),void 0!==c.win&&(u=!!c.win),void 0!==c.nodes&&(f=!!c.nodes),l=!!c.copyReference);if(void 0===h||h)void 0!==h&&h--;else return k?void 0:a;if(!(a&&a instanceof Object))return a;if(!f){try{if(a instanceof Node)return a}catch(M){if(a instanceof
ActiveXObject&&void 0!==a.nodeType)return a}if(a===document)return a}if(!u&&a===e)return a;f=a instanceof Array?[]:{};a instanceof Date&&(f=new Date(a));!z&&a instanceof Function&&(z=String(a).replace(/\s+/g,""),f=z.indexOf("{[nativecode]}")+14===z.length?function(){return a.apply(A||this,arguments)}:function(){return a.apply(this,arguments)});void 0===n&&(q=[],n=0);if(z=b(a,f))return z;if(f instanceof Array)for(z=0;z<a.length;z++)f[f.length]=a[z]===a[z]?d(a[z],c,h,n+1,a):a[z];else{var z=0,B;for(B in a){if(g||
a.hasOwnProperty(B))f[B]=a[B]===a[B]?d(a[B],c,h,n+1,a):a[B];z++}}c.proto&&(f.prototype=d(a.prototype,c,h,n+1,a));l&&(f.___copy_ref=a);return f}function n(a,c,d,h,b,q,A,f){d=d||{};void 0===d.hasOwn&&(d.hasOwn=!0);if(!d.objectsOnly||a instanceof Object)if(void 0===f||f){void 0!==f&&f--;if(!d||!d.nodes)try{if(a instanceof Node)return}catch(v){if(a instanceof ActiveXObject&&void 0!==a.nodeType)return}if(a!==e){void 0===h&&(g=[],h=0);var u;a:{for(u=0;u<h&&u<g.length;u++)if(a===g[u]){u=!0;break a}u=!1}if(!(u||
(g[h]=a,b=b||a,b&&q&&b[q]!==b[q]||c(a,b,q,A)))){q=0;u="";for(var l in a){if(!d.hasOwn||a.hasOwnProperty(l))try{var k=a[l];d.track&&(u=A?A+"."+l:l);n(k,c,d,h+1,b,l,u,f)}catch(B){}q++}}}}}var c=f.Define,h=f.Cookie,e=c.global();c.clazz("qubit.opentag.Utils",a);a.global=c.global;a.namespace=c.namespace;a.clazz=c.clazz;a.getObjectUsingPath=function(a,c){c=c||e;for(var d=a.split("."),h=0;h<d.length;h++)c&&d[h]&&(c=c[d[h]]);return c};a.getParentObject=function(c){var t=c.lastIndexOf(".");c=c.substring(0,
t);return a.getObjectUsingPath(c)};a.variableExists=function(a){return void 0!==a&&null!==a};a.ANON_VARS=[];a.getAnonymousAcessor=function(c){var t=a.indexInArray(c,a.ANON_VARS);-1===t&&(t=a.addToArrayIfNotExist(a.ANON_VARS,c));return"qubit.opentag.Utils.ANON_VARS["+t+"]"};a.replaceAll=function(a,c,d){return a.replace(new RegExp(c.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1"),"g"),d)};a.secureText=function(a){"string"!==typeof a&&(a+="");a=a.replace(/</g,"&lt;");return a=a.replace(/>/g,"&gt;")};a.getUrl=
function(){return document.location.href};a.getQueryParam=function(c){var t,d,h,b;t=a.getUrl();if(0<t.indexOf("?"))for(b=t.substring(t.indexOf("?")+1).split("&"),t=0,d=b.length;t<d;t+=1)if(h=b[t],0<h.indexOf("=")&&(h=h.split("="),2===h.length&&h[0]===c))return h[1];return null};a.getElementValue=function(a){return(a=document.getElementById(a))?a.textContent||a.innerText:null};var q=[];a.objectCopy=function(a,c){c=c||{};var h=d(a,c,c.maxDeep);q=[];return h};var g=[];a.traverse=function(a,c,d){n(a,
c,d,void 0,void 0,void 0,void 0,d.maxDeep)};a.prepareQuotedString=function(a){return"string"===typeof a?'"'+a.replace(/\"/g,'\\"')+'"':a};a.expressionToFunction=function(c,d){return a.gevalAndReturn("function ("+(d||"")+") {"+c+"}").result};a.defineWrappedClass=function(a,d,h,b,n){var q=function(){return n?n.apply(this,arguments):d.apply(this,arguments)};c.clazz(a,q,d,b);for(var A in h)h.hasOwnProperty(A)&&"CONSTRUCTOR"!==A&&(q.prototype[A]=h[A]);return q};a.copyAandAddFromB=function(a,c,d){a=this.objectCopy(a,
{maxDeep:d||8});for(var h in c)c.hasOwnProperty(h)&&(a[h]=c[h]);return a};a.keys=function(a){if(a instanceof Object){if(Object.keys)return Object.keys(a);var c=[],d;for(d in a)a.hasOwnProperty(d)&&(c[c.length]=d);return c}throw"keys() called on non-object!";};a.getSrcElement=function(a){var c;a=a||window.event;a.srcElement?c=a.srcElement:a.target&&(c=a.target);return c};a.addToArrayIfNotExist=function(a,c,d){for(var h=0,b=!1;h<a.length;h+=1)if(d&&d(a[h],c)||a[h]===c){b=!0;break}b||(a[a.length]=c,
h=-1);return h};a.indexInArray=function(a,c){for(var d=0,h=!1;d<a.length;d++)if(a[d]===c){h=!0;break}return h?d:-1};a.removeFromArray=function(a,c){for(var d=0,h=0;d<a.length;d+=1)a[d]===c&&(a.splice(d,1),h++);return h};a.addClass=function(c,d){var h;try{c.classList.add(d)}catch(b){null===c.className?c.className=d:(h=c.className.split(" "),a.addToArrayIfNotExist(h,d),c.className=h.join(" "))}};a.removeClass=function(c,d){var h;try{c.classList.remove(d)}catch(b){null===c.className?c.className="":(h=
c.className.split(" "),a.removeFromArray(h,d),c.className=h.join(" "))}};a.gevalAndReturn=function(c){var d=l;d.qubitopentagutilsgevalandreturn__var_test__=void 0;d.qubitopentagutilsgevalandreturn__var_test__error=void 0;a.geval("try{this.qubitopentagutilsgevalandreturn__var_test__=("+c+");}catch(ex){this.qubitopentagutilsgevalandreturn__var_test__error = ex;}");c=d.qubitopentagutilsgevalandreturn__var_test__;var h=d.qubitopentagutilsgevalandreturn__var_test__error;try{d.qubitopentagutilsgevalandreturn__var_test__=
void 0,d.qubitopentagutilsgevalandreturn__var_test__error=void 0,delete d.qubitopentagutilsgevalandreturn__var_test__,delete d.qubitopentagutilsgevalandreturn__var_test__error}catch(b){}return{result:c,error:h}};a.trim=function(a){try{return String(a).trim()}catch(c){return String(a).replace(/^\s+|\s+$/g,"")}};a.setIfUnset=function(a,c){if(a&&c)for(var d in c)c.hasOwnProperty(d)&&!a.hasOwnProperty(d)&&(a[d]=c[d])};a.overrideFromBtoA=function(a,c){if(a&&c)for(var d in c)c.hasOwnProperty(d)&&(a[d]=
c[d]);return a};a.geval=function(a){return window&&window.execScript?window.execScript(a):e.eval.call(e,a)};var u=[];a.bodyAvailable=function(a){if(document.body){if(u){for(var c=0;c<u.length;c++)try{u[c]()}catch(d){}u=!1}a()}else u.push(a)};a.rmCookiesMatching=function(a){for(var c=h.getAll(),d=0;d<c.length;d++){var b=c[d][0];0===b.match(a)&&h.rm(b)}};var k=[],B=!1,m=!1;a.bodyReady=function(a){if(m)return a&&a(),!0;if(B=B||!(!document.body||"complete"!==document.readyState)){m=!0;for(var c=0;c<k.length;c++)try{k[c]()}catch(d){}a&&
a()}else a&&k.push(a);return B};var A=e.onload;e.onload=function(c){a.bodyReady();A&&A(c)};(function(){var c,d=!1,h=1,b,n,q,A;n=function(a){!0===a&&(h-=1);if(!h||!0!==a&&!d){if(!document.body)return setTimeout(n,1);d=!0;if(!0!==a&&(h-=1,0<h))return;for(;0<b.length;)a=b.shift(),a()}};A=function(){if(!d){try{document.documentElement.doScroll("left")}catch(a){setTimeout(A,1);return}n()}};q=function(){if(!b){b=[];if("complete"===document.readyState)return setTimeout(n,1);if(document.addEventListener)document.addEventListener("DOMContentLoaded",
c,!1),window.addEventListener("load",n,!1);else if(document.attachEvent){document.attachEvent("onreadystatechange",c);window.attachEvent("onload",n);var a=!1;try{a=null===window.frameElement||void 0===window.frameElement}catch(d){}document.documentElement.doScroll&&a&&A()}}};document.addEventListener?c=function(){document.removeEventListener("DOMContentLoaded",c,!1);n()}:document.attachEvent&&(c=function(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",c),n())});(function(a){q();
d?setTimeout(a,1):b.push(a)})(function(){B=!0;a.bodyReady()})})()})();(function(){function a(a){a&&(this._rate=a.rate||10,this._smallestRate=-1,a.start&&this.startPooling(),this.config=a);this.inervals=[];this._lck_obj={};this._binded_pool=this._pool.bind(this)}f.Define.clazz("qubit.opentag.Timer",a);a.prototype.timers=[];a.prototype.startPooling=function(a){a&&this.config.dynamic&&(0>this._smallestRate||this._smallestRate>a)&&(this._smallestRate=Math.min(Math.floor(a/2),1500));this.started||(this.started=
!0,setTimeout(this._binded_pool,0))};a.prototype._pool=function(){this.maxFrequent(function(){},5E3,this._lck_obj);this.callTimers();0!==this.timers.length?setTimeout(this._binded_pool,this._smallestRate>this._rate?this._smallestRate:this._rate):(this.started=!1,this._smallestRate=-1)};a.prototype.callTimers=function(){this.lastCalled=(new Date).valueOf();for(var a=0;a<this.timers.length;a++){var b=this.timers[a];if((new Date).valueOf()>=b.time){try{b.execute()}catch(c){}this.timers.splice(a,1);--a}}};
a.prototype.cancellAll=function(){this.timers=[]};a.prototype.setRate=function(a){this._rate=a};a.prototype.maxFrequent=function(a,b,c){c||(a.__maxFrequent__timer_opentag_qubit_=a.__maxFrequent__timer_opentag_qubit_||{},c=a.__maxFrequent__timer_opentag_qubit_);var h=c.____last__timed__max__frequent____;if(!h||(new Date).valueOf()-h>b)h=(new Date).valueOf(),c.____last__timed__max__frequent____=h,a()};a.prototype.runIfNotScheduled=function(a,b,c){c=c||a;if(c.__lastRun__&&(new Date).valueOf()<b+c.__lastRun__)return this.schedule(a,
b,c);c.__lastRun__=(new Date).valueOf();a();return!0};a.prototype.schedule=function(a,b,c){if(c.___scheduled___)return!1;c.___scheduled___=(new Date).valueOf();this.setTimeout(function(){c.___scheduled___=!1;c.__lastRun__=(new Date).valueOf();a()},b);return!0};var b=1;a.prototype.setTimeout=function(a,n){var c={id:b++,time:(new Date).valueOf()+ +n,execute:a};this.timers.push(c);this.startPooling(n);return c};a.prototype.setInterval=function(a,b){var c=setInterval(a,b);this.inervals.push(c);return c}})();
(function(){f.Define.namespace("qubit.opentag.Timed",new f.opentag.Timer({rate:37,dynamic:!0}));var a=f.opentag.Timed;a.tillTrue=function(b,d,n){var c=function(){b()?d():a.setTimeout(c,n||33)};c()}})();var s;s=s||{};s.fileLoader={};s.fileLoader.load=function(a,b,d,n,c,h){var e,q,f,g;g=!1;f=function(c){return function(){g||(g=!0,c&&!q&&(q={url:document.location.href}),d(a,q,c))}};try{b&&(e=b(a))}catch(l){e=!1,d(a,"Exception loading pre",!0)}finally{!1!==e&&(b=s.fileLoader.createScriptEl(a,c,!1,h),
d&&(b.onload=f(!1),b.onerror=f(!0),b.onreadystatechange=function(){"complete"!==this.readyState&&"loaded"!==this.readyState||setTimeout(function(){f(!1)()},1)}),n||(n=window.document.getElementsByTagName("head")[0]),n.appendChild(b))}};s.fileLoader.createScriptEl=function(a,b,d,n){var c,h=document.createElement("script");h.type="text/javascript";h.src=s.fileLoader.tidyUrl(a)+(d?"?"+(new Date).getTime():"");!1!==b?(h.async="true",h.defer="true"):(h.async="false",!1!==h.async&&(h.async=!1),h.defer=
"false");for(c in n)n.hasOwnProperty(c)&&h.setAttribute(c,n[c]);return h};s.fileLoader.tidyUrl=function(a){return"http:"===a.substring(0,5)||"https:"===a.substring(0,6)?a:"//"+a};(function(){function a(a){this.config={order:0,include:!0,name:"Filter-"+d++,script:void 0,session:void 0};this.session=null;if(a){for(var h in a)a.hasOwnProperty(h)&&(this.config[h]=a[h]);a.session&&this.setSession(a.session);this.register(this)}}var b=f.opentag.Utils,d=0,n=[];f.Define.clazz("qubit.opentag.filter.BaseFilter",
a);a.state={DISABLED:-3,SESSION:-2,PASS:-1,FAIL:0};a.prototype.reset=function(){this.enable()};a.prototype.disable=function(){this.config.disabled=!0};a.prototype.enable=function(){this.config.disabled=!1};a.prototype.match=function(){return!0};a.prototype.setSession=function(a){this.session=a};a.prototype.getSession=function(){return this.session};a.prototype.getState=function(){var c=a.state.PASS;if(this.config.disabled)return a.state.DISABLED;this.config.script&&(c=this.config.script.call(this,
c));isNaN(+c)&&(c=a.state.FAIL);this.lastState=+c;return c};a.getFilters=function(){return n};a.prototype.register=function(){a.register(this)};a.register=function(a){b.addToArrayIfNotExist(n,a)}})();f.Define.namespace("qubit.opentag.filter.pattern.PatternType",{CONTAINS:"CONTAINS",MATCHES_EXACTLY:"MATCHES_EXACTLY",STARTS_WITH:"STARTS_WITH",ENDS_WITH:"ENDS_WITH",REGULAR_EXPRESSION:"REGULAR_EXPRESSION",ALL_URLS:"ALL_URLS"});(function(){function a(b){this._lockObject={};var c={patternType:d.CONTAINS,
pattern:""};if(b)for(var h in b)b.hasOwnProperty(h)&&(c[h]=b[h]);a.SUPER.call(this,c)}var b=f.opentag.Utils,d=f.opentag.filter.pattern.PatternType;f.Define.clazz("qubit.opentag.filter.URLFilter",a,f.opentag.filter.BaseFilter);a.prototype.PATTERNS=d;a.prototype.getURL=function(a){return a||b.getUrl()};a.prototype.match=function(a){a=this.getURL(a);var c=!0,h=this.config.pattern;switch(this.config.patternType){case d.CONTAINS:c=0<=a.toLowerCase().indexOf(h.toLowerCase());break;case d.MATCHES_EXACTLY:c=
a.toLowerCase()===this.config.pattern.toLowerCase();break;case d.STARTS_WITH:c=0===a.toLowerCase().indexOf(h.toLowerCase());break;case d.ENDS_WITH:c=a.lastIndexOf(h.toLowerCase())+h.length===a.length;break;case d.REGULAR_EXPRESSION:c=(new RegExp(h)).test(a);break;case d.ALL_URLS:c=!0}return c}})();(function(){function a(c){var h={};if(c){for(var d in c)c.hasOwnProperty(d)&&("customStarter"===d&&c[d]?this.customStarter=c[d]:"customScript"===d&&c[d]&&(this.customScript=c[d]),h[d]=c[d]);this.uid="f"+
n++}this.tagsToRun=[];a.SUPER.call(this,h)}var b=f.opentag.filter.BaseFilter,d=f.opentag.Utils,n=0;f.Define.clazz("qubit.opentag.filter.Filter",a,f.opentag.filter.URLFilter);a.prototype.customStarter=function(a,d,b){d(!1)};a.prototype.isSession=function(){return this.config.sessionDisabled||null===this.customStarter&&null===this.customScript?!1:!0};a.prototype.customScript=function(a){return!0};a.prototype.match=function(c){var d=!0;try{this.customScript&&(void 0===this._matchState&&(this._matchState=
!!this.customScript(this.getSession())),d=this._matchState)}catch(b){d=!1}return d&&a.SUPER.prototype.match.call(this,c)};a.prototype.runTag=function(c){if(this.starterExecuted)!0===this.reRun?c.run():c.runOnce();else if(d.addToArrayIfNotExist(this.tagsToRun,c),!this._starterWasRun){this._starterWasRun=!0;var h=function(a){this.reRun=a;this.starterExecuted=(new Date).valueOf();this._processQueuedTagsToRun()}.bind(this);this.customStarter?this.customStarter(this.getSession(),h,c):a.prototype.customStarter(this.getSession(),
h,c)}};a.prototype._processQueuedTagsToRun=function(){for(var a=0;a<this.tagsToRun.length;a++){var d=this.tagsToRun[a];!0===this.reRun?d.run():d.runOnce()}};a.prototype.getState=function(c){c&&this.setSession(c);c=a.SUPER.prototype.getState.call(this);if(c===b.state.DISABLED)return b.state.DISABLED;c===b.state.PASS&&this.isSession()&&(c=b.state.SESSION);this.config.script&&(c=this.config.script.call(this,c,this.getSession()));return this.lastState=c};a.prototype.reset=function(){this._matchState=
void 0;a.SUPER.prototype.reset.call(this);this.starterExecuted=this._starterWasRun=void 0;this.tagsToRun=[];this.reRun=void 0}})();s.GlobalEval={};s.GlobalEval.globalEval=function(a){window.execScript?window.execScript(a):window.eval.call(window,a)};s.HtmlInjector={};s.HtmlInjector.inject=function(a,b,d,n,c){var h,e,q,f;if(0<=d.toLowerCase().indexOf("<script")){c=document.createElement("div");c.innerHTML="a"+d;e=c.getElementsByTagName("script");q=[];d=0;for(h=e.length;d<h;d+=1)q.push(e[d]);f=[];d=
0;for(h=q.length;d<h;d+=1){e=q[d];var g={attributes:s.HtmlInjector.getAttributes(e)};e.src?g.src=e.src:g.script=e.innerHTML;f.push(g);e.parentNode.removeChild(e)}c.innerHTML&&0<c.innerHTML.length&&(c.innerHTML=c.innerHTML.substring(1));s.HtmlInjector.doInject(a,b,c);s.HtmlInjector.loadScripts(f,0,n,a)}else c=document.createElement("div"),c.innerHTML=d,s.HtmlInjector.doInject(a,b,c),n&&n()};s.HtmlInjector.doInject=function(a,b,d){if(0<d.childNodes.length){for(var e=document.createDocumentFragment();0<
d.childNodes.length;)e.appendChild(d.removeChild(d.childNodes[0]));b?s.HtmlInjector.injectAtStart(a,e):s.HtmlInjector.injectAtEnd(a,e)}};s.HtmlInjector.injectAtStart=function(a,b){0===a.childNodes.length?a.appendChild(b):a.insertBefore(b,a.childNodes[0])};s.HtmlInjector.injectAtEnd=function(a,b,d){d||(d=1);a===document.body&&"complete"!==document.readyState&&50>d?setTimeout(function(){s.HtmlInjector.injectAtEnd(a,b,d+1)},100):a.appendChild(b)};s.HtmlInjector.loadScripts=function(a,b,d,e){var c,h,
f=!1;for(c=a.length;b<c;b+=1)if(h=a[b],h.src){f=!0;break}else s.GlobalEval.globalEval(h.script);f&&s.fileLoader.load(h.src,null,function(){s.HtmlInjector.loadScripts(a,b+1,d,e)},e,!1,h.attributes);d&&b===c&&d()};s.HtmlInjector.getAttributes=function(a){var b,d,e,c,h={};if(a){d=a.attributes;b=d.length;for(a=0;a<b;a++)e=d[a].value,c=d[a].name.toLowerCase(),""===e||"id"!==c&&"class"!==c&&"charset"!==c&&"data-"!==c.substr(0,5)||(h[c]=e);return h}};(function(){function a(){k=k||{write:document.write,writeln:document.writeln}}
function b(){document.write=k.write;document.writeln=k.writeln;k=null}var d=f.opentag.filter.BaseFilter,e=f.opentag.Utils,c=s.HtmlInjector,h=s.fileLoader,g=f.opentag.filter.Filter,q=function(){};f.Define.clazz("qubit.opentag.TagsUtils",q);var z=!1;q.bodyLoaded=function(){return z?!0:z=!(!document.body||"loading"===document.readyState)};q.bodyAvailable=function(a){return!!document.body};var u={};q.loadScript=function(a){var c=a.url,d=function(d,h,b){u[c].error=h;b?(u[c].state="failure",a.onerror()):
(u[c].state="success",a.onsuccess())};if(u[c]){if(a.noMultipleLoad)return d(c,u[c].error,"failure"===u[c].state);u[c].count+=1}else u[c]={count:1,state:null};var b=!a.async,e=q.bodyLoaded();b&&!e?q.writeScriptURL(c,function(a,h){d(c,h,!a)}):h.load(c,!1,d,a.node,a.async)};var k=null;q.redirectDocumentWritesToArray=function(c,d){a();document.write=function(a){c.push(a)};document.writeln=function(a){c.push(a)}};q.flushDocWritesArray=function(a,c,d,h,b){if(c&&a){a=a.splice(0,a.length);try{return q.injectHTML(c,
d,a.join("\n"),b||r),!0}catch(e){}}else return!1;b&&b();return!0};q.unlockDocumentWrites=function(){k&&b()};var B=q.prototype.PACKAGE_NAME+".TagsUtils._writeScriptURL_callbacks",m={};f.Define.namespace(B,m,l,!0);var A=0,w=(new Date).valueOf();q.writeScriptURL=function(c,d){var t="_"+w+"_"+A++,f=B+"."+t,g=!1;m[t]=function(a){g||(g=!0,a?d(!1,"error while loading script "+c):d(!0),m[t]=void 0,delete q.writeScriptURL.callbacks[t])};var z='if(this.readyState === "loaded" || this.readyState === "complete"){ try {'+
f+"(true)} catch (ex) {}}",l="try{"+f+"(false)}catch(ex){}",f="try{"+f+"(true)}catch(ex){}";c=h.tidyUrl(c);z="<script onload='"+l+"'  onerror='"+f+"' onreadystatechange='"+z+"' type='text/javascript'  src='"+c+"'>\x3c/script>";k?(b(),document.write(z),a()):document.write(z);e.bodyReady(function(){g||(g=!0,d(!0))})};q.writeScriptURL.callbacks={};var t=d.state.SESSION,C=d.state.PASS,y=d.state.FAIL;q.filtersState=function(a,c,h,b){a=a.sort(function(a,c){try{var d=c.config.order,h=a.config.order;isNaN(-h)&&
(h=0);isNaN(-d)&&(d=0);return d-h}catch(b){return 0}});var e=C;if(!a||0===a.length)return e;for(var e=null,w=!1,q=!1,A=0,f,n,z=[],l,u,k=0;k<a.length;k++)if(l=a[k],l.setSession(c),l.match())if(f=l.getState(),0<f){if(0===A||A>f)A=f}else f===d.state.DISABLED?w=!0:f===t?(q=!0,n=e=l,z.push(l)):e=l;else u=l;a=!1;null===e?(a=!0,e=w?C:y):e=e.config.include?f:f===C?y:C;0<A&&(e===C||a)&&(e=A);if(e===t||e===C&&q){if(!n.config.include)return y;e=t;if(n instanceof g&&n.isSession()&&b)for(b=0;b<z.length;b++)try{z[b].runTag(h)}catch(v){}}h.config.dedupe&&
e===C&&u&&u instanceof g&&u.isSession()&&(h.sendDedupePing=!0,e=y);return e};q.injectHTML=function(a,d,h,b){return c.inject(a,d?0:1,h,b||r)};q.getHTMLLocationForTag=function(a){a=a.prepareLocationObject(a.config.locationObject);switch(a){case "HEAD":a=document.getElementsByTagName("head")[0];break;case "BODY":a=document.body;break;default:a=a?document.getElementById(a):document.body}return a}})();(function(){function a(b){this.config={};this.parameters=null;if(b){this.uniqueId="BV"+d++;a.ALL_VARIABLES[this.uniqueId]=
this;for(var c in b)this.config[c]=b[c];void 0!==b.value&&(this.value=b.value);void 0!==b.defaultValue&&(this.defaultValue=b.defaultValue);return a.register(this)}}var b=f.opentag.Utils,d=0;f.Define.clazz("qubit.opentag.pagevariable.BaseVariable",a);a.ALL_VARIABLES={};a.pageVariables=[];a.register=function(d){if(d instanceof a){for(var c=0;c<a.pageVariables.length;c++){var b=a.pageVariables[c];if(d===b)return b}a.pageVariables.push(d);return d}return null};a.prototype.getValue=function(){return this.value};
a.prototype.setValue=function(a){this.value=a};a.prototype.getDefaultValue=function(){return this.defaultValue};a.prototype.setDefaultValue=function(a){this.defaultValue=a};a.prototype.exists=function(a){var c=b.variableExists(this.getValue());a&&(c=c||b.variableExists(this.getDefaultValue()));return c};a.prototype.getRelativeValue=function(a,c){var d=this.getValue();b.variableExists(d)||(d=c);var e;a&&!b.variableExists(d)&&(e=this.getDefaultValue(),b.variableExists(e)&&(d=e));return d};a.prototype.replaceToken=
function(a,c,d,e){var f=this.exists();d=f?this.getValue():d;a="\\$\\{"+a+"\\}";return e||d instanceof Array?(e=f?this.getValueAccessorString():b.getAnonymousAcessor(d),c.replace(new RegExp(a,"g"),e)):c.replace(new RegExp(a,"g"),d)};a.prototype.getAccessorString=function(){return"qubit.opentag.pagevariable.BaseVariable.ALL_VARIABLES."+this.uniqueId};a.prototype.getValueAccessorString=function(){return this.getAccessorString()+".getValue()"}})();(function(){function a(d){this._lockExprObject={};a.SUPER.apply(this,
arguments)}var b=f.opentag.Utils;f.Define.clazz("qubit.opentag.pagevariable.Expression",a,f.opentag.pagevariable.BaseVariable);a.prototype.getValue=function(){var d,e;try{if(-1===this.value.indexOf("[#]")){var c=b.gevalAndReturn(this.value);d=c.result;this.failMessage=null;e=c.error}else d=a.parseUVArray(this.value)}catch(h){e=h}e&&(d="could not read value of expression: \n"+this.value+"\nexact cause: "+e,this.failMessage!==d&&(this.failMessage=d),d=null);return d};a.parseUVArray=function(a){var e=
a.split("[#]");a=b.gevalAndReturn(e[0]).result;var c=[],e=e[1];0===e.indexOf(".")&&(e=e.replace(".",""));for(var h=0;h<a.length;h++){var f=b.getObjectUsingPath(e,a[h]);c.push(f)}return c};a.prototype.replaceToken=function(d,b,c,h){this.getValue()instanceof Array&&(h=!0);return a.SUPER.prototype.replaceToken.call(this,d,b,c,h)}})();(function(){function a(d){a.SUPER.apply(this,arguments)}var b=f.opentag.Utils;f.Define.clazz("qubit.opentag.pagevariable.DOMText",a,f.opentag.pagevariable.BaseVariable);
a.prototype.getValue=function(){return b.getElementValue(this.value)}})();(function(){function a(d){a.SUPER.apply(this,arguments);this._lockObject={}}var b=f.opentag.Timed;f.Define.clazz("qubit.opentag.pagevariable.Cookie",a,f.opentag.pagevariable.BaseVariable);a.prototype.getValue=function(){var a=f.Cookie.get(this.value);b.maxFrequent(function(){}.bind(this),2E3,this._lockObject);return a}})();(function(){function a(d){a.SUPER.apply(this,arguments)}var b=f.opentag.Utils;f.Define.clazz("qubit.opentag.pagevariable.URLQuery",
a,f.opentag.pagevariable.BaseVariable);a.prototype.getValue=function(){return b.getQueryParam(this.value)}})();(function(){function a(){}function b(a,c){var d=[];try{var h=a.parameters;if(h)for(var e=0;e<h.length;e++)a.getVariableForParameter(h[e])===c&&d.push(h[e])}catch(w){}return d}var d=f.opentag.Utils,e=f.opentag.TagsUtils,c=f.opentag.pagevariable.BaseVariable,h=f.opentag.pagevariable.Expression,g=f.opentag.pagevariable.DOMText,q=f.opentag.pagevariable.Cookie,z=f.opentag.pagevariable.URLQuery;
f.Define.clazz("qubit.opentag.TagHelper",a);a.injectHTMLForLoader=function(a,c,d,b){if(b=void 0!==b?b:a.getHtml()){var h="END"===a.config.locationPlaceHolder,w=e.getHTMLLocationForTag(a);a.injectHTMLNotFinished=!0;try{w?e.injectHTML(w,h,b,function(){a.injectHTMLNotFinished=!1;if(c)try{c()}catch(d){}}.bind(a)):d&&"loading"===document.readyState?(document.write(b),a.injectHTMLNotFinished=!1):a.injectHTMLFailed=(new Date).valueOf()}catch(t){a.injectHTMLNotFinished=!1,a.injectHTMLFailed=(new Date).valueOf()}}};
a.getAllVariablesWithParameters=function(a){for(var c=a.getPageVariables(),d=[],h=0;h<c.length;h++)for(var e=c[h],w=b(a,e),t=0;t<w.length;t++)d.push({parameter:w[t],variable:e});return d};a.allParameterVariablesReadyForTag=function(a,c){for(var d=!0,h=a.getPageVariables(),e=0;e<h.length;e++){var w=h[e];try{var t=b(a,w),f=w.exists();!f&&c&&(0<t.length&&(f=!!t[0].defaultValue),f=f||w.exists(!0));if(!f){d=!1;break}}catch(q){d=!1;break}}return d};a.validateAndGetVariableForParameter=function(c){c.hasOwnProperty("variable")&&
c.variable&&(c.variable=a.initPageVariable(c.variable));return c.variable};a.initPageVariable=function(a){if(!a||a instanceof c)return a;if("string"===typeof a){var b=d.getObjectUsingPath(a);if(b&&b instanceof c)return b}switch(a.type){case "2":return new h(a);case "3":return new z(a);case "4":return new q(a);case "5":return new g(a);case "EPRESSION":return new h(a);case "URL_PARAMETER":return new z(a);case "COOKIE_VALUE":return new q(a);case "DOM_VALUE":return new g(a);default:return new c(a)}}})();
(function(){function a(a){this.calls={}}var b=f.Define,d=f.opentag.Utils;a.prototype.on=function(a,c){this.calls[a]=this.calls[a]||[];return d.addToArrayIfNotExist(this.calls[a],c)};a.prototype.call=function(a){if(a=this.calls[a])for(var c=0;c<a.length;c++)try{a[c]()}catch(d){}};a.prototype.remove=function(a,c){return d.removeFromArray(this.calls[a],c)};a.prototype.removeAll=function(a){var c=0,b;for(b in this.calls)this.calls.hasOwnProperty(b)&&(c+=d.removeFromArray(this.calls[b],a));return c};b.clazz("qubit.Events",
a)})();(function(){function a(a){this.urlsFailed=this.urlsLoaded=0;this.events=new f.Events({});this._depLoadedHandler=function(){this.dependenciesLoaded()&&this.awaitingDependencies&&this._triggerLoadingAndExecution()}.bind(this);this.config={name:"Tag-"+g++,async:!0,usesDocumentWrite:!1,timeout:this.LOADING_TIMEOUT,dependencies:[],url:null,urlLocation:null,locationPlaceHolder:"END",locationObject:null,dontWaitForInjectionLocation:!1,noMultipleLoad:!1,loadDependenciesOnLoad:!1};this.delayDocWrite=
!1;this.dependencies=[];this._lockObject={count:0};this._lockObjectDepsLoaded={};this.genericDependencies=this.genericDependencies||[];if(a){if(!a.name){var c="Tag-"+g++;this.config.name=c}this.addState("INITIAL");for(var d in a)this.config[d]=a[d];a.genericDependencies&&(this.genericDependencies=this.genericDependencies.concat(a.genericDependencies));a.dependencies&&(this.dependencies=a.dependencies.concat(this.dependencies));a.PACKAGE&&(this._package=a.PACKAGE);this.onInit()}}function b(){if(this.cancelled)this._handleCancel();
else{this.waitForDependenciesFinished=(new Date).valueOf();var a=this._fullBodyNeededAndUnLoaded(),c=this._bodyNeededButNotAvailable();a||c?this.waitForDependenciesFinished=!1:(this.timeoutCountdownStart||(this.timeoutCountdownStart=(new Date).valueOf()),this.allDependenciesLoaded()?this._markLoadedSuccesfuly():this._loadingOutOfTimeFrames()?(this.loadingTimedOut=(new Date).valueOf(),this.allDependenciesLoaded(!0)?this._markLoadedSuccesfuly():(this.addState("TIMED_OUT"),this.loadingDependenciesFailed=
(new Date).valueOf(),this._triggerOnLoadTimeout())):this.waitForDependenciesFinished=!1);this.waitForDependenciesFinished?this.addState("LOADED_DEPENDENCIES"):this._setTimeout(b.bind(this),65)}}var d=f.opentag.Utils,e=f.opentag.TagsUtils,c=f.opentag.Timed,h=f.opentag.TagHelper,g=0;f.Define.clazz("qubit.opentag.GenericLoader",a);a.prototype.onInit=r;a.prototype.LOADING_TIMEOUT=5E3;a.prototype.getHtml=function(){return this.config.html?this.config.html:this.htmlContent?d.trim(this.htmlContent):null};
a.prototype._executeScript=function(){var a=!1;try{this.script(),a=!0}catch(c){this.addState("EXECUTED_WITH_ERRORS"),this.executedWithErrors=(new Date).valueOf(),this._onError(c)}finally{this._onExecute(a)}};a.prototype.getTimeout=function(){return this._getTimeout()};a.prototype._getTimeout=function(a){var c=+this.config.timeout,b=this.dependencies;if(-1!==c&&0<b.length){var h=0;a=a||[];if(-1===d.indexInArray(a,this)){a[a.length]=this;for(var e=0;e<b.length;e++){var f=b[e]._getTimeout(a);f>h&&(h=
f)}0<h&&(c+=h)}else return 0}return c};a.prototype._onExecute=function(a){this.onExecute(a)};a.prototype.onExecute=r;a.prototype._flushDocWrites=function(a){var c=!0;this._docWriteNotFlushed=!1;try{var b=e.getHTMLLocationForTag(this);b&&this._securedWrites&&0<this._securedWrites.length&&((c=e.flushDocWritesArray(this._securedWrites,b,"END"===this.config.locationPlaceHolder,this.log,a))?this._docWriteFlushed=(new Date).valueOf():this._docWriteNotFlushed=(new Date).valueOf())}catch(d){this._onError(d)}a&&
a();this._securedWrites&&0<this._securedWrites.length&&(c=!1,this._docWriteNotFlushed=(new Date).valueOf());return c};a.prototype.log=r;a.prototype.finished=function(){return!!this.runIsFinished};a.prototype.script=function(){};a.prototype.before=function(){this.beforeRun=(new Date).valueOf();try{this.onBefore()}catch(a){this._onError(a)}};a.prototype.onBefore=r;a.prototype.after=function(a){this.afterRun=(new Date).valueOf();try{this.onAfter(a)}catch(c){this._onError(c)}};a.prototype.onAfter=function(a){};
a.prototype.runOnce=function(){this._runOnceTriggered||this.scriptExecuted||(this._runOnceTriggered=(new Date).valueOf(),this.run())};a.CANCEL_ALL=!1;a.prototype.runCounter=0;a.prototype.run=function(){if(this.cancelled||a.CANCEL_ALL)return this._handleCancel(),!1;if(this.isRunning)return!1;this.lastRun&&this.reset();this.lastRun=this.isRunning=(new Date).valueOf();this.runCounter++;this._ignoreDeps=!!this.ignoreDependencies;return this._ignoreDeps||this.dependenciesLoaded()?this._triggerLoadingAndExecution():
(this._attachDepsEventsToContinue(),!1)};a.prototype._triggerLoadingAndExecution=function(){this.awaitingDependencies=-(new Date).valueOf();this.load();this._ignoreDeps?this.execute():this.waitForDependenciesAndExecute();return!0};a.prototype._attachDepsEventsToContinue=function(){this.awaitingDependencies=(new Date).valueOf();for(var a=this.dependencies,c=0;c<a.length;c++)try{a[c].events.on("success",this._depLoadedHandler)}catch(b){}};a.prototype.dependenciesLoaded=function(){for(var a=this.dependencies,
c=0;c<a.length;c++)if(a[c]!==this&&!(0<+a[c].scriptExecuted))return!1;return!0};a.prototype._setTimeout=function(a,b){this._wasTimed=(new Date).valueOf();return c.setTimeout(a,b)};a.prototype._handleCancel=function(){this.addState("CANCELLED");try{this.onCancel()}catch(a){this._onError(a)}};a.prototype.waitForDependenciesAndExecute=function(){this.cancelled?this._handleCancel():this.loadedDependencies?this.execute():this.loadingDependenciesFailed?(this._markFailure(),this._markFinished()):this._setTimeout(this.waitForDependenciesAndExecute.bind(this),
30)};a.prototype.execute=function(){this._triggerExecution()};a.prototype._triggerExecution=function(){if(this.cancelled)this._handleCancel();else if(!this.scriptExecuted){var a=!0;if(this.shouldWaitForDocWriteProtection())a=!1;else{if(!this._beforeEntered){this._beforeEntered=(new Date).valueOf();a=!1;try{a=this.before()}catch(c){this._onError(c)}if(a){this._markFailure();this._markFinished();return}}a=this.loadExecutionURLsAndHTML(this._triggerExecution.bind(this))}if(!this.scriptExecuted)if(this.unexpectedFail&&
(a=!0),a){this._flushDocWrites();this.scriptLoadingFailed||this.injectHTMLFailed||this.unexpectedFail?this._markFailure():(this.scriptExecuted=(new Date).valueOf(),this.addState("EXECUTED"),this._executeScript());if(this.cancelled)return this._handleCancel(),!1;a=0<this.scriptExecuted;try{this.afterRun||(this.afterRun=(new Date).valueOf(),this.after(a))}catch(b){this.executedWithErrors=(new Date).valueOf()}this.executedWithErrors||a&&this.events.call("success");this._flushDocWrites();this._markFinished()}else this._setTimeout(this._triggerExecution.bind(this),
30)}};a.prototype._markFailure=function(){this.scriptExecuted=-(new Date).valueOf();this.addState("FAILED_TO_EXECUTE")};a.prototype._markFinished=function(){this.runIsFinished=(new Date).valueOf();this.isRunning=!1;a.LOCK_DOC_WRITE===this&&(this._flushDocWrites(),e.unlockDocumentWrites(),a.LOCK_DOC_WRITE=!1);this.onFinished(!0)};a.prototype.onFinished=r;a.prototype.onCancel=r;a.prototype.onFinished=r;a.prototype.shouldWaitForDocWriteProtection=function(){if(this.willSecureDocumentWrite())if(!a.LOCK_DOC_WRITE)a.LOCK_DOC_WRITE=
this,this._secureWriteAndCollectForExecution();else if(a.LOCK_DOC_WRITE!==this)return this._lockedDocWriteInformed||(this._lockedDocWriteInformed=(new Date).valueOf()),!0;return!1};a.prototype.runWithoutDependencies=function(){this.ignoreDependencies=!0;this.run()};a.prototype.loadExecutionURLsAndHTML=function(a){if(this.cancelled)return this._handleCancel(),!0;this._loadExecutionURLsAndHTMLInformed||(this._loadExecutionURLsAndHTMLInformed=!0);this._triggerURLsLoading(a);return this.loadURLsNotFinished||
(this._flushDocWrites(),this._triggerHTMLInjection(),this._flushDocWrites(),this.injectHTMLNotFinished||(this._flushDocWrites(),this._docWriteNotFlushed))?!1:!0};a.prototype._triggerURLsLoading=function(a){!this._urlLoadTriggered&&this.config.url&&(this._urlLoadTriggered=!0,this.loadURLs(!1,a))};a.prototype._triggerHTMLInjection=function(){!this._injectHTMLTriggered&&this.getHtml()&&(this._injectHTMLTriggered=!0,this.injectHTML())};a.prototype.STATE={INITIAL:0,STARTED:1,LOADING_DEPENDENCIES:2,LOADED_DEPENDENCIES:4,
LOADING_URL:8,LOADED_URL:16,EXECUTED:32,EXECUTED_WITH_ERRORS:64,FAILED_TO_LOAD_DEPENDENCIES:128,FAILED_TO_LOAD_URL:256,FAILED_TO_EXECUTE:512,TIMED_OUT:1024,UNEXPECTED_FAIL:2048,CANCELLED:4096};a.prototype.addState=function(a){if(this.STATE.hasOwnProperty(a)){this.state|=this.STATE[a];try{this.onStateChange(a)}catch(c){this._onError(c)}}};a.prototype.onStateChange=r;a.prototype.cancel=function(){this.cancelled=(new Date).valueOf()};a.prototype.state=a.prototype.STATE.INITIAL;a.prototype._markLoadedSuccesfuly=
function(){this.loadedDependencies=(new Date).valueOf();this.onAllDependenciesLoaded()};a.prototype._secureWriteAndCollectForExecution=function(){this._securedWrites||(this._securedWrites=[],e.redirectDocumentWritesToArray(this._securedWrites,this.log))};a.prototype.allDependenciesLoaded=function(a,c){return 0===this.getDependenciesToBeLoaded(a,c).length};a.prototype.getDependenciesToBeLoaded=function(a,c){var b=c||[];this.injectionLocationReady()||b.push("injection location");var d,h=this.dependencies;
for(d=0;d<h.length;d++)h[d]!==this&&(0<+h[d].scriptExecuted||b.push("dependant Tag with name -> "+(h[d].config?h[d].config.name:"anonymous")));for(d=0;d<this.genericDependencies.length;d++)this.genericDependencies[d](this)||b.push("this.genericDependencies["+d+"] (index: "+d+")");return b};a.prototype.docWriteAsksToWaitForBody=function(){return!(!this.delayDocWrite||!this.config.usesDocumentWrite)};a.prototype._bodyNeededButNotAvailable=function(){return this._dontWaitForInjections()?!1:this._isBodyLocationNeeded()&&
!e.bodyAvailable()};a.prototype._isBodyLocationNeeded=function(){return this.isLoadingAsynchronously()?this._isBodyLocationSet()?!0:"HEAD"===this.config.locationObject&&"END"===this.config.locationPlaceHolder:!1};a.prototype._isBodyLocationSet=function(){var a=this.config.locationObject;return!a||"BODY"===a};a.prototype._fullBodyNeededAndUnLoaded=function(){if(this._dontWaitForInjections())return!1;var a=!1;this._isBodyLocationNeeded()&&(a="END"===this.config.locationPlaceHolder);return(a=a||this.fullbodyNeeded||
this.docWriteAsksToWaitForBody())&&!d.bodyReady()};a.prototype._dontWaitForInjections=function(){return this.config.dontWaitForInjectionLocation||this.dontWaitForInjectionLocation||a.dontWaitForInjectionLocation};a.prototype.injectionLocationReady=function(){return this._dontWaitForInjections()?!0:this._fullBodyNeededAndUnLoaded()?!1:this.isLoadingAsynchronously()?!!e.getHTMLLocationForTag(this):!0};a.prototype._loadingOutOfTimeFrames=function(){return 0>this.getTimeout()?!1:(new Date).valueOf()-
this.timeoutCountdownStart>this.getTimeout()};a.prototype.loadDependencies=function(){this._loadDependencies()};a.prototype.addClientDependenciesList=function(a,c){return this.addDependenciesList(a,f.Define.clientSpaceClasspath())};a.prototype.addDependenciesList=function(c,b){if(c&&0!==c.length){this.failedDependenciesToParse||(this.failedDependenciesToParse=[]);for(var h=this.dependencies,e=0;e<c.length;e++){var f=c[e],g=!1;if(f instanceof a)h.push(f);else if("string"===typeof f){var A=f;b&&(f=
b+"."+f);var w=d.getObjectUsingPath(f);w?w instanceof a?h.push(w):g=!0:this.failedDependenciesToParse.push(A)}else g=!0;g&&(this.badDepsObjects=this.badDepsObjects||[],d.addToArrayIfNotExist(this.badDepsObjects,f))}}};a.prototype._loadDependencies=function(a){a=a||[];var c=this.dependencies;if(-1===d.indexInArray(a,this)){a[a.length]=this;for(var b=0;b<c.length;b++)c[b].load(a)}};a.prototype.onError=r;a.prototype._onError=function(a){try{this.onError(a)}catch(c){}};a.prototype._triggerOnLoadTimeout=
function(){this.onLoadTimeout()};a.prototype.onLoadTimeout=r;a.prototype.onScriptsLoadSuccess=r;a.prototype.onScriptLoadError=r;a.prototype.onAllDependenciesLoaded=r;a.prototype.onBeforeLoad=r;a.prototype.load=function(){if(!this.loadStarted){this.loadStarted=(new Date).valueOf();try{this.onBeforeLoad()}catch(a){this._onError(a)}this.addState("LOADING_DEPENDENCIES");try{!this._ignoreDeps&&this.config.loadDependenciesOnLoad&&this.loadDependencies()}catch(c){throw c;}b.call(this)}};a.prototype._singleUrlLoadHandler=
function(a,c,b){++this.urlsLoaded;a||++this.urlsFailed;if(this.urlsLoaded===c.length)if(this.loadURLsNotFinished=!1,a&&0===this.urlsFailed){this.addState("LOADED_URL");this.urlsLoaded=(new Date).valueOf();try{b&&b(!0)}catch(d){this._onError(d)}finally{this.onScriptsLoadSuccess()}}else{a="error loading urls. Failed "+this.urlsFailed;this._onError(a);this.addState("FAILED_TO_LOAD_URL");this.urlsLoaded=-(new Date).valueOf();try{this.scriptLoadingFailed=!0,b&&b(!1)}catch(h){this._onError(h)}finally{this.onScriptLoadError(a)}}};
a.prototype.loadURLs=function(a,c){var b=a||this.config.url;this.addState("LOADING_URL");try{!b||b instanceof Array||(b=[b]);for(var d=0;d<b.length;d++){this.loadURLsNotFinished=!0;var h=b[d],h=this.prepareURL(h);this.loadURL(h,function(a){this._singleUrlLoadHandler(a,b,c)}.bind(this))}}catch(e){this.loadURLsNotFinished=!1,this.addState("UNEXPECTED_FAIL"),this.unexpectedFail=(new Date).valueOf(),this._onError(e)}};a.prototype.prepareLocationObject=function(a){return a};a.prototype.prepareURL=function(a){return a};
a.prototype.prepareHTML=function(a){return a};a.prototype.loadURL=function(a,c,b){this.addState("LOADING_URL");e.loadScript({onsuccess:function(){try{c&&c(!0)}catch(a){}}.bind(this),onerror:function(){try{c&&c(!1)}catch(a){}}.bind(this),url:a,node:b||this.config.urlLocation,async:this.isLoadingAsynchronously(),noMultipleLoad:this.config.noMultipleLoad})};a.prototype.reset=function(){this._securedWrites=this.delayDocWrite=this.scriptLoadingFailed=this.scriptExecuted=this.runIsFinished=this.loadingTimedOut=
this.loadingDependenciesFailed=this.loadedDependencies=this.loadURLsNotFinished=this.loadStarted=this.injectHTMLFailed=this.filtersRunTriggered=this.beforeRun=this.afterRun=this._urlLoadTriggered=this._runOnceTriggered=this._lockedDocWriteInformed=this._loadExecutionURLsAndHTMLInformed=this._injectHTMLTriggered=void 0;this.state=0;this.unexpectedFail=void 0;this.urlsLoaded=this.urlsFailed=0;this.timeoutCountdownStart=this.awaitingDependencies=this._beforeEntered=this.cancelled=this._lastRun=this.isRunning=
this.waitForDependenciesFinished=void 0;this.addState("INITIAL")};a.prototype.isLoadingAsynchronously=function(){return this._wasTimed?!0:!(!this.config.async&&!this.forceAsynchronous)};a.prototype.willSecureDocumentWrite=function(){return this.config.usesDocumentWrite&&this.isLoadingAsynchronously()};a.prototype.injectHTML=function(a){var c=!this.docWriteAsksToWaitForBody(),b=this.prepareHTML(this.getHtml());b&&h.injectHTMLForLoader(this,a,c,b)};a.prototype.clone=function(){return new a(this.config)}})();
(function(){function a(c){d.setIfUnset(c,{filterTimeout:c&&c.filterTimeout||this.FILTER_WAIT_TIMEOUT,PACKAGE:c&&c.PACKAGE,dedupe:!1,needsConsent:!1,inactive:!1,variables:null,runner:null,disabled:!1,locked:!1});a.SUPER.apply(this,arguments);this.namedVariables={};this.parameters=[];this.filters=[];this.session=null;if(c){this.addState("INITIAL");try{a.register(this)}catch(b){}this.setupConfig(c);this.uniqueRefString=null;if(c.init)try{c.init.call(this,c)}catch(h){}this.onTagInit()}}function b(a,c){var d=
a.namedVariables,e=h.initPageVariable(d[c]);return d[c]=e}var d=f.opentag.Utils,e=f.opentag.TagsUtils,c=f.opentag.filter.BaseFilter,h=f.opentag.TagHelper,g=f.opentag.pagevariable.BaseVariable,l=f.Cookie,k=f.Define;k.clazz("qubit.opentag.BaseTag",a,f.opentag.GenericLoader);a.prototype.setupConfig=function(a){if(a){a.filters&&this.addFilters(a.filters);a.parameters&&this.addParameters(a.parameters);if(a.variables)for(var c in a.variables)if(a.variables.hasOwnProperty(c)){var b=this.getParameterByTokenName(c);
if(b){var d=a.variables[c];b.variable=d;void 0!==d.defaultValue&&(b.defaultValue=d.defaultValue);void 0!==d.uv&&(b.uv=d.uv)}}a.locked&&this.lock()}};a.prototype.valueForToken=function(a,c){var d=this.getParameterByTokenName(a);if(d)return void 0===c&&this.loadingTimedOut&&(c=!0),this.getParameterValue(d,c);if((d=this.namedVariables)&&d[a]&&(d=b(this,a)))return d.getRelativeValue(c)};a.prototype.addParameters=function(a){this.parameters=this.parameters.concat(a)};a.prototype.LOADING_TIMEOUT=5E3;a.prototype.FILTER_WAIT_TIMEOUT=
-1;a.prototype.run=function(){if(this.destroyed)throw"Tag is destroyed.";this.resolveAllDynamicData();if(this.config.runner){var a=!1;try{this.addState("AWAITING_CALLBACK"),a=this._runner=(new Date).valueOf(),this.config.runner.call(this)}catch(c){}return a}this._runner=!1;return this.start()};a.prototype.lock=function(){this.locked=!0;this._unlock=null};a.prototype.unlock=function(){this.locked=!1;this._unlock&&(this._unlock(),this._unlock=!1)};a.prototype.start=function(){return this.locked?(this._unlock=
function(){return a.SUPER.prototype.run.call(this)}.bind(this),!1):a.SUPER.prototype.run.call(this)};a.prototype.startOnce=function(){return this.locked?(this._unlock=function(){return a.SUPER.prototype.runOnce.call(this)}.bind(this),!1):a.SUPER.prototype.runOnce.call(this)};a.prototype.getFilters=function(){return this.filters};a.prototype.runOnceIfFiltersPass=function(){this._runOnceIfFiltersPassTriggered||this.scriptExecuted||(this._runOnceIfFiltersPassTriggered=(new Date).valueOf(),this.runIfFiltersPass())};
a.prototype.runIfFiltersPass=function(){if(this.destroyed)throw"Tag is destroyed.";this.resolveAllDynamicData();var a=this.filtersState(!0);this.addState("FILTER_ACTIVE");this.filtersRunTriggered||(this.filtersRunTriggered=(new Date).valueOf());if(a===c.state.SESSION)this.addState("AWAITING_CALLBACK"),this.awaitingCallback=(new Date).valueOf();else if(a===c.state.PASS){this.filtersPassed=(new Date).valueOf();try{this.onFiltersPassed()}catch(b){}this.run()}else if(a===c.state.FAIL)this._markFiltersFailed(),
this._markFinished();else if(0<a){var d=this.config.filterTimeout;if(0>d||(new Date).valueOf()-this.filtersRunTriggered>d){if(!this._awaitingForFilterInformed){this._awaitingForFilterInformed=(new Date).valueOf();try{this.onFiltersDelayed()}catch(h){}}this._setTimeout(this.runIfFiltersPass.bind(this),a)}else this._markFiltersFailed(),this._markFinished(),this.filtersRunTimedOut=(new Date).valueOf()}try{this.onFiltersCheck(a)}catch(e){}return a};a.prototype._markFiltersFailed=function(){this.addState("FILTERS_FAILED");
this.filtersPassed=-(new Date).valueOf()};a.prototype.STATE={INITIAL:0,FILTER_ACTIVE:1,AWAITING_CALLBACK:2,FILTERS_FAILED:4,STARTED:8,LOADING_DEPENDENCIES:16,LOADED_DEPENDENCIES:32,LOADING_URL:64,LOADED_URL:128,EXECUTED:256,EXECUTED_WITH_ERRORS:512,FAILED_TO_LOAD_DEPENDENCIES:1024,FAILED_TO_LOAD_URL:2048,FAILED_TO_EXECUTE:4096,TIMED_OUT:8192,UNEXPECTED_FAIL:16384,CANCELLED:32768};a.prototype.addState=function(c){a.SUPER.prototype.addState.call(this,c);try{a.onStateChange(this)}catch(b){}this.stateStack=
[];c=this.STATE;var d=this.state,h=this.stateStack;d&c.INITIAL&&h.push("Initial state.");d&c.FILTER_ACTIVE&&h.push("Tag running with filters pass triggered.");d&c.FILTERS_FAILED&&h.push("Filters failed to pass.");d&c.AWAITING_CALLBACK&&h.push("Awaiting callback to run this tag. Not pooling.");d&c.STARTED&&h.push("Tag is initialized and loading has been started.");d&c.LOADING_DEPENDENCIES&&h.push("Dependencies are being loaded.");d&c.LOADED_DEPENDENCIES&&h.push("Dependencies loading process has been finished.");
d&c.LOADING_URL&&h.push("External URL is being loaded.");d&c.LOADED_URL&&h.push("External URL has been loaded.");d&c.EXECUTED&&h.push("Main script has been executed.");d&c.EXECUTED_WITH_ERRORS&&h.push("Main script has been executed but errors occured.");d&c.FAILED_TO_LOAD_DEPENDENCIES&&h.push("Dependencies has failed to load.");d&c.FAILED_TO_LOAD_URL&&h.push("URL location failed to load.");d&c.FAILED_TO_EXECUTE&&h.push("Script failed to execute.");d&c.TIMED_OUT&&h.push("Script timed out awaiting for dependencies.");
d&c.UNEXPECTED_FAIL&&h.push("Script occured UNEXPECTED exception and is failed.");d&c.CANCELLED&&h.push("Tag has been cancelled.")};a.prototype.onTagInit=r;a.onStateChange=r;a.prototype.onFiltersDelayed=r;a.prototype.onFiltersPassed=r;a.prototype.onFiltersCheck=r;a.prototype.state=a.prototype.STATE.INITIAL;a.prototype.arePageVariablesLoaded=function(a){return h.allParameterVariablesReadyForTag(this,a)};a.prototype.getDependenciesToBeLoaded=function(c,d){var b=d||[];this.arePageVariablesLoaded(c)||
b.push("page variables");return a.SUPER.prototype.getDependenciesToBeLoaded.call(this,c,b)};a.prototype.resolveAllDynamicData=function(){this.resolvePageVariables();this.resolveDependencies();this.resolveFilters()};a.prototype.resolveDependencies=function(){var a=this.failedDependenciesToParse;a&&(this.failedDependenciesToParse=null,this.addDependenciesList(a,k.clientSpaceClasspath()));return this.dependencies};a.prototype.addClientVariablesMap=function(a){return this.unresolvedClientVariablesMap=
this.addVariablesMap(a,k.clientSpaceClasspath())};a.prototype.resolvePageVariables=function(){var a=this.unresolvedClientVariablesMap;a&&(this.unresolvedClientVariablesMap=null,this.addClientVariablesMap(a));return this.getPageVariables()};a.prototype.addVariablesMap=function(a,c){if(a){var b={},h=this.namedVariables,e;for(e in a)if(a.hasOwnProperty(e)){var f=a[e];if(f instanceof g)h[e]=f;else if("string"===typeof f){var l=f;c&&(f=c+"."+f);d.getObjectUsingPath(f)?h[e]=f:b[e]=l}}return b}};a.prototype.prepareURL=
function(a){return this.replaceTokensWithValues(a)};a.prototype.prepareLocationObject=function(a){return this.replaceTokensWithValues(a)};a.prototype.prepareHTML=function(a){a&&(a=this.replaceTokensWithValues(a));return a};a.prototype._executeScript=function(){if(this.config&&this.config.script)if("function"===typeof this.config.script)this.script=this.config.script;else{var c=this.replaceTokensWithValues(String(this.config.script));this.script=d.expressionToFunction(c).bind(this)}a.SUPER.prototype._executeScript.call(this)};
a.prototype.replaceTokensWithValues=function(a){if(!a||-1===a.indexOf("${"))return a;var c=this.parameters;if(c)for(var d=0;d<c.length;d++){var b=this.getVariableForParameter(c[d]);if(b){var h=c[d].token,e=this.valueForToken(h);a=b.replaceToken(h,a,e)}}return a};a.prototype.getParameter=function(a){var c=this.parameters,d=null;if(c)for(var b=0;b<c.length;b++)c[b].name===a&&(d=c[b]);return d};a.prototype.setParameterValueByTokenName=function(a,c){var d=this.getParameterByTokenName(a);return null!==
d?(d.variable={value:c},!0):!1};a.prototype.getParameterValue=function(a,c){var b="string"===typeof a?this.getParameter(a):a;if(b){var h=this.getVariableForParameter(b);if(h)try{var e;c&&""!==b.defaultValue&&(e=d.gevalAndReturn(b.defaultValue).result);return e=h.getRelativeValue(c,e)}catch(f){}}};a.prototype.filtersState=function(a){return e.filtersState(this.filters,this.session,this,a)};a.prototype.addFilter=function(a){d.addToArrayIfNotExist(this.filters,a)};a.prototype.addFilters=function(a){for(var c=
0;c<a.length;c++)this.addFilter(a[c])};a.prototype.addClientFiltersList=function(a){return this.unresolvedClientFilterClasspaths=this.addFiltersList(a,k.clientSpaceClasspath())};a.prototype.resolveFilters=function(){var a=this.unresolvedClientFilterClasspaths;a&&(this.unresolvedClientFilterClasspaths=null,this.addClientFiltersList(a));return this.filters};a.prototype.addFiltersList=function(a,b){for(var h=[],e=0;e<a.length;e++)try{var f=a[e],g=null;"string"===typeof f&&(g=f,b&&(f=b+"."+f),f=d.getObjectUsingPath(f));
"function"===typeof f&&(f=new f);!f instanceof c&&(f=null);f?this.addFilter(f):g&&d.addToArrayIfNotExist(h,g)}catch(l){this.failedFilters=this.failedFilters||[],this.failedFilters.push(a[e])}return h};a.prototype.reset=function(){a.SUPER.prototype.reset.call(this);this.resetFilters();this._runner=this.filtersRunTriggered=this._runOnceIfFiltersPassTriggered=this.pingSent=this.dedupePingSent=this.filtersPassed=void 0};a.prototype.resetFilters=function(){for(var a=0;a<this.filters.length;a++)this.filters[a].reset()};
a.prototype.getParameterByTokenName=function(a){var c=null;if(this.parameters)for(var d=this.parameters,b=0;b<d.length;b++)d[b].token===a&&(c=d[b]);return c};a.prototype.removeFilter=function(a){d.removeFromArray(this.filters,a)};var u=0,m=[],B={},p={};a.register=function(a){var c=d.addToArrayIfNotExist(m,a);a._tagIndex=-1===c?m.length-1:c;a.config.id?(c="Q"+a.config.id,p[c]=a,a.uniqueId=c):p[a.CLASSPATH]=a};a.getById=function(a){return p[String(a)]};a.prototype.getById=a.getById;a.prototype.unregister=
function(c){a.unregister(c||this)};a.prototype.destroy=function(){this.destroyed=!0;this.cancel();a.unregister(this)};a.unregister=function(a){d.removeFromArray(m,a);a._tagIndex=-1};a.getTags=function(){return m};a.getAccessorsMap=function(){return B};a.prototype.getTags=function(){return m};a.prototype.getPageVariables=function(){var a=this.parameters,c=[];if(a)for(var h=0;h<a.length;h++){var e=this.getVariableForParameter(a[h]);null!==e&&d.addToArrayIfNotExist(c,e)}if(this.namedVariables)for(var f in this.namedVariables)d.addToArrayIfNotExist(c,
b(this,f));return c};a.prototype.getAccessorString=function(){this._accessorsMapKey||(this._accessorsMapKey="_"+u++,B[this._accessorsMapKey]=this);return"qubit.opentag.BaseTag.getAccessorsMap()."+this._accessorsMapKey};a.prototype.getVariableForParameter=function(a){var c,d=this.namedVariables;d&&d[a.token]&&(c=b(this,a.token));c||(c=h.validateAndGetVariableForParameter(a));return c};a.prototype.printVariablesState=function(){for(var a=[],c=h.getAllVariablesWithParameters(this),d=0;d<c.length;d++){var b=
c[d].parameter,e=c[d].variable,f;f=b&&b.token?this.valueForToken(b.token):e.getRelativeValue(!0);b={name:e.config.name,exists:e.exists(),token:b?b.token:null,value:f,variable:e};a.push(b)}return a};a.prototype._triggerOnLoadTimeout=function(){this.onLoadTimeout()};a.prototype.getId=function(){return this._getUniqueId()};a.prototype._getUniqueId=function(){return this.config.id?this.config.id:0===String(this.CLASSPATH).indexOf(k.STANDARD_CS_NS)?this.CLASSPATH.substring(k.STANDARD_CS_NS.length+1):this.CLASSPATH+
"#"+this.config.name};a.prototype.cookieSaysToRunEvenIfDisabled=function(){var a=this._getUniqueId(),c=!!l.get("qubit.tag.forceAllToRun");c||(c=!!l.get("qubit.tag.forceRunning_"+a));return c};a.prototype.setCookieForcingTagToRun=function(){var a=this._getUniqueId();l.set("qubit.tag.forceRunning_"+a,"true")};a.setCookieForcingTagsToRun=function(){l.set("qubit.tag.forceAllToRun","true")};a.prototype.setCookieToDisable=function(){var a=this._getUniqueId();l.set("qubit.tag.disableRunning_"+a,"true")};
a.prototype.rmCookieToDisable=function(){var a=this._getUniqueId();l.rm("qubit.tag.disableRunning_"+a)};a.prototype.disabledByCookie=function(){var a=this._getUniqueId();return!!l.get("qubit.tag.disableRunning_"+a)};a.rmCookieForcingTagsToRun=function(){l.rm("qubit.tag.forceAllToRun")};a.prototype.rmCookieForcingTagToRun=function(){var a=this._getUniqueId();l.rm("qubit.tag.forceRunning_"+a)};a.rmAllDisablingCookies=function(){d.rmCookiesMatching("qubit.tag.disableRunning_")};a.rmAllCookiesForcingTagToRun=
function(){d.rmCookiesMatching("qubit.tag.forceRunning_");a.rmCookieForcingTagsToRun()}})();(function(){var a=f.opentag.Utils,b=f.opentag.filter.BaseFilter,d=function(){};f.Define.clazz("qubit.opentag.Tags",d);d.getById=function(a){return f.opentag.BaseTag.getById(String(a))};d.getAllTagsByState=function(){return f.opentag.Container.getAllTagsByState(d.getTags())};d.findTagByName=function(a){for(var b=this.getTags(),d=[],e=0;e<b.length;e++)b[e].config.name===a&&d.push(b[e]);return d};d.findTagByMatch=
function(a){for(var b=this.getTags(),d=[],e=0;e<b.length;e++)b[e].config.name.match(a)&&d.push(b[e]);return d};d.findTagContainers=function(a){for(var b=d.getContainers(),e=[],f=0;f<b.length;f++){var g=b[f].tags,l;for(l in g)if(g[l]===a){e.push(b[f]);break}}return e};d.getTags=function(){return f.opentag.BaseTag.getTags()};d.resetAllTags=function(){for(var a=d.getTags(),b=0;b<a.length;b++)a[b].reset()};d.getContainersPageVariables=function(){for(var a=d.getContainers(),b=[],e=0;e<a.length;e++)b=b.concat(a.getPageVariables());
return b};d.getAllPageVariables=function(){for(var a=d.getTags(),b=[],e=0;e<a.length;e++)b=b.concat(a[e].getPageVariables());return b};d.cancelAll=function(){for(var a=d.getTags(),b=0;b<a.length;b++)a[b].cancel()};d.resetAll=function(){for(var a=d.getTags(),b=0;b<a.length;b++)a[b].reset()};d.getPageVariableByName=function(a){for(var b=d.getAllPageVariables(),e=[],f=0;f<b.length;f++)b[f].config.name===a&&e.push(b[f]);return e};d.getLoadTime=function(a){var b=a.beforeRun,d=a.runIsFinished;return isNaN(d)?
{tag:a,loadTime:null}:{tag:a,loadTime:d-b}};d.getLoadTimes=function(a){var b=[];if(a instanceof f.opentag.BaseTag)return b.push([d.getLoadTime(a[e])]),b;a=a||d.getTags();if(a instanceof Array)for(e=0;e<a.length;e++)a[e]instanceof f.opentag.BaseTag&&b.push(d.getLoadTime(a[e]));else for(var e in a)a[e]instanceof f.opentag.BaseTag&&b.push(d.getLoadTime(a[e]));return b};d.forceAllContainersAndTagsToRunIfDisabled=function(){f.opentag.Container.setCookieForDisabledContainersToRun();f.opentag.BaseTag.setCookieForcingTagsToRun()};
d.rmAllContainersAndTagsForcingFlags=function(){f.opentag.Container.rmCookieForDisabledContainersToRun();f.opentag.BaseTag.rmAllCookiesForcingTagToRun()};d.getContainers=function(){return f.opentag.Container.getContainers()};d.findAllTagsByClassPath=function(c){var b=[],e=[];try{e.push(f.opentag.CustomTag),e.push(f.opentag.LibraryTag)}catch(g){}for(var l=d.getTags(),n=0;n<l.length;n++){var k=l[n];0>a.indexInArray(e,k)&&0===k.PACKAGE_NAME.indexOf(c)&&b.push(k)}return b};d.findAllTags=function(a,b){var e=
f.opentag.BaseTag,g=[];try{g.push(f.opentag.CustomTag),g.push(f.opentag.LibraryTag)}catch(l){}return d.findAllInstances(a,e,g,b)};var e=function(c,b,d,e){var f=[];"string"===typeof c&&(c=a.getObjectUsingPath(c));if(c){var g={objectsOnly:!0};e&&(g.maxDeep=!0);e=function(c,e,g,l){if(b(c)){for(e=0;e<d.length;e++)if(d[e]===c)return!0;a.addToArrayIfNotExist(f,c);return!0}return!1}.bind(this);a.traverse(c,e,g)}return f};d.findAllInstances=function(a,b,d,f){return e(a,function(a){return a instanceof b},
d,f)};d.findAllInheriting=function(a,b,d,f){return e(a,function(a){return a.prototype instanceof b},d,f)};d.findAllFilters=function(a,e){var g=[];try{g.push(f.opentag.filter.Filter),g.push(f.opentag.filter.URLFilter)}catch(l){}return d.findAllInheriting(a,b,g,e)}})();b={};g=void 0;b.update=function(){var a,b;b=function(){return Math.floor(1+65536*Math.random()).toString(36).substring(1)};window.__pageViewId__||(a=(new Date).getTime().toString(36),window.__pageViewId__=a+b()+b()+b());return window.__pageViewId__};
s.PostData=function(a,b,d){var e,c,h,f,g,l,k;k=2;g=!1;l=function(){0<k&&setTimeout(function(){g||(k-=1,e())},5E3)};c=navigator.userAgent.toLowerCase();h=-1!==c.indexOf("msie");c.indexOf("msie 9");c=-1!==c.indexOf("msie 7")||-1!==c.indexOf("msie 6");f=("https:"===document.location.protocol?"https:":"http:")+a;d=d||"POST";e=function(){var a;try{a=null;try{a=new XMLHttpRequest}catch(c){}a&&!h?a.open(d,f,!0):"undefined"!==typeof XDomainRequest?(a=new XDomainRequest,a.open(d,f)):a=null;try{a.withCredentials=
!1}catch(e){}a.setRequestHeader&&a.setRequestHeader("Content-Type","text/plain;charset=UTF-8");a.onload=function(){g=!0};a.onreadystatechange=function(){};a.ontimeout=function(){};a.onerror=function(){};a.onprogress=function(){};a.send(b)}catch(n){try{try{s.fileLoader.load(f)}catch(w){window.console&&window.console.log&&window.console.log(n)}}catch(t){}}l()};c?s.fileLoader.load(f):e()};(function(){function a(){}f.Define.clazz("qubit.opentag.Ping",a);a.prototype.send=function(e,d){for(var f=e.config,
c="c="+f.clientId+"&p="+e.getContainerId()+"&l="+f.tellLoadTimesProbability+"&pv="+b.update()+"&d=",h=[],g=0;g<d.length;g++){var l=d[g].tag,k=d[g].loadTime;if(null!==k&&!isNaN(k)){var u=a.getPingID(l);!l.pingSent&&u&&null!==k&&void 0!==u&&(h.push('"'+u+'":'+k),l.pingSent=!0)}}f.pingServerUrl&&0<h.length&&(c+=encodeURIComponent("{"+h.join(",")+"}"),s.PostData("//"+f.pingServerUrl+"/tag2?"+c,null,"GET"))};a.prototype.sendErrors=function(a,b){};a.prototype.sendDedupe=function(e,d){for(var f=e.config,
c="c="+f.clientId+"&p="+e.getContainerId()+"&l="+f.tellLoadTimesProbability+"&pv="+b.update()+"&dd=",h=[],g=0;g<d.length;g++){var l=d[g],k=a.getPingID(l);void 0===k||l.dedupePingSent||(h.push(k),l.dedupePingSent=!0)}0<h.length&&f.pingServerUrl&&(c+=encodeURIComponent("["+h.join(",")+"]"),s.PostData("//"+f.pingServerUrl+"/tag2?"+c,null,"GET"))};a.getPingID=function(a){if(a.config.id)return a.config.id;var b=a.PACKAGE_NAME.lastIndexOf(".");return-1!==b?a.PACKAGE_NAME.substring(b+1):a.PACKAGE_NAME}})();
g={_cookieName:"_qst_s",_sessionCookie:"_qsst_s",update:function(a){var b,d;b=f.Cookie.get(g._cookieName);d=f.Cookie.get(g._sessionCookie);if(b){if(b=parseInt(b,10),!d||parseInt(d,10)<(new Date).getTime()-18E5)b+=1}else b=1;f.Cookie.set(g._cookieName,b,365,a);f.Cookie.set(g._sessionCookie,(new Date).getTime().toString(),null,a);return b}};var x={};(function(){function a(a){return 10>a?"0"+a:a}function b(a){c.lastIndex=0;return c.test(a)?'"'+a.replace(c,function(a){var c=g[a];return"string"===typeof c?
c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function d(c,e){var g,k,n,w,t=h,q,y=e[c];if(y instanceof Date)g=y,y=isFinite(g.valueOf())?g.getUTCFullYear()+"-"+a(g.getUTCMonth()+1)+"-"+a(g.getUTCDate())+"T"+a(g.getUTCHours())+":"+a(g.getUTCMinutes())+":"+a(g.getUTCSeconds())+"Z":null;else if(y instanceof String||y instanceof Number||y instanceof Boolean)y=y.valueOf();"function"===typeof l&&(y=l.call(e,c,y));switch(typeof y){case "string":return b(y);case "number":return isFinite(y)?
String(y):"null";case "boolean":case "null":return String(y);case "object":if(!y)return"null";h+=f;q=[];if("[object Array]"===Object.prototype.toString.apply(y)){w=y.length;for(g=0;g<w;g+=1)try{q[g]=d(g,y)||"null"}catch(m){q[g]='{"stack_exceeded": null}'}n=0===q.length?"[]":h?"[\n"+h+q.join(",\n"+h)+"\n"+t+"]":"["+q.join(",")+"]";h=t;return n}if(l&&"object"===typeof l)for(w=l.length,g=0;g<w;g+=1){if("string"===typeof l[g]){k=l[g];try{n=d(k,y)}catch(p){n='{"stack_exceeded": null}'}n&&q.push(b(k)+(h?
": ":":")+n)}}else for(k in y)if(Object.prototype.hasOwnProperty.call(y,k)){try{n=d(k,y)}catch(r){n='{"stack_exceeded": null}'}n&&q.push(b(k)+(h?": ":":")+n)}n=0===q.length?"{}":h?"{\n"+h+q.join(",\n"+h)+"\n"+t+"}":"{"+q.join(",")+"}";h=t;return n}}var e=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,h,f,g={"\b":"\\b",
"\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof x.stringify&&(x.stringify=function(a,c,b){var e;f=h="";if("number"===typeof b)for(e=0;e<b;e+=1)f+=" ";else"string"===typeof b&&(f=b);if((l=c)&&"function"!==typeof c&&("object"!==typeof c||"number"!==typeof c.length))throw Error("JSON.stringify");return d("",{"":a})});"function"!==typeof x.parse&&(x.parse=function(a,c){function b(a,d){var e,h,f=a[d];if(f&&"object"===typeof f)for(e in f)Object.prototype.hasOwnProperty.call(f,
e)&&(h=b(f,e),void 0!==h?f[e]=h:delete f[e]);return c.call(a,d,f)}var d;a=String(a);e.lastIndex=0;e.test(a)&&(a=a.replace(e,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return d=eval("("+a+")"),"function"===typeof c?b({"":d},""):d;throw new SyntaxError("JSON.parse");})})();(function(){function a(a){if(a)if(a.alphabet)for(this.alphabet=
a.alphabet,this.dict={},a=0;a<this.alphabet.length;a++)this.dict[this.alphabet[a]]=a;else this.alphabet=d,this.dict=h}function b(a,c){for(var d in c)if(a===c[d])return d;return null}for(var d=[],e=Math.pow(2,8),c=0;c<e;c++)d.push(String.fromCharCode(c));for(var h={},e=0;e<d.length;e++)h[d[e]]=e;f.Define.clazz("qubit.compression.LZW",a);a.prototype.encode=function(a){for(var c=this.alphabet.length,b={},d=[],e=0,h=a.charAt(e++),f,g=this.dict;f=a.charAt(e++);){var l=h+f;if(g.hasOwnProperty(l)||b.hasOwnProperty(l))h=
l;else{var t=g.hasOwnProperty(h)?g[h]:b[h];if(void 0===t)throw"Dictionary base is to small for those contents: "+h;d.push(t);b[l]=c++;h=f}}""!==h&&d.push(b.hasOwnProperty(h)?b[h]:g[h]);return d};a.prototype.decode=function(a){for(var c=this.dict,d=this.alphabet.length,e,h={},f=b(a[0],c),g=f,l=[f],w=1;w<a.length;w++){var t=a[w];e=b(t,c);null===e&&(h.hasOwnProperty(t)&&(e=h[t]),null===e&&(e=g+f));l.push(e);f=e.charAt(0);h[d++]=g+f;g=e}return l.join("")}})();(function(){function a(a){}for(var b={},d=
0;45>d;d++)b["abcdefghijklmnopqrstuvwxyz0123456789'%./:<>?[".charAt(d)]=d;for(var e={},d=0;45>d;d++)e['ABCDEFGHIJKLMNOPQRSTUVWXYZ*!-+()@{|}"]^_`~$&#'.charAt(d)]=d;for(var c={},d=0;45>d;d++)c["abcdefghijklmnopqrstuvwxyz0123456789'%./:<>?[".charAt(d)]='ABCDEFGHIJKLMNOPQRSTUVWXYZ*!-+()@{|}"]^_`~$&#'.charAt(d);var h="abcdefghijklmnopqrstuvwxyz0123456789'%./:<>?[".split(""),g=h.length,l=new f.compression.LZW({});f.Define.clazz("qubit.compression.Compressor",a);a.prototype.compress=function(a,c){for(var b=
(c||l).encode(a),d=[],e=0;e<b.length;e++)d.push(String.fromCharCode(b[e]));return d.join("")};a.prototype.compressAnsi=function(a,b){for(var d=(b||l).encode(a),e=[],f=0;f<d.length;f++){var k;k=d[f];var w=0,t=0>k;t&&(k=-k);var n="",v=!0;do w=k%g,v?(n=c[h[w]],v=!1):n=h[w]+n,k=(k-w)/g;while(0<k);k=t?"-"+n:n;e.push(k)}return e.join("")};a.prototype.decompressAnsi=function(a,c){for(var d=[],h="",f=0;f<a.length;f++){var k=a.charAt(f);if(e.hasOwnProperty(k)){for(var k=h+k,h="",w=0,t=0,C=!0,y=0;y<k.length;y++){var m=
k.charAt(k.length-1-y);C&&(C=!1,m="abcdefghijklmnopqrstuvwxyz0123456789'%./:<>?[".charAt(e[m]));w+=b[m]*Math.pow(g,t++)}k=w;d.push(k)}else h+=k}return(c||l).decode(d)};a.prototype.decompress=function(a,c){for(var b=[],d=0;d<a.length;d++)b.push(a.charCodeAt(d));return(c||l).decode(b)}})();(function(){function a(a){for(var b=[],d=0;d<a.length;d++){var e=c(a[d][0]);b.push([new RegExp(e,"g"),"*"+a[d][1]])}return b}function b(a,c){for(var d=0;d<c.length;d++)if(c[d][1]===a)return c[d][0];return null}function d(c){this._regexDefs=
m;this._defs=k;c&&c.definitions&&(this._regexDefs=a(c.definitions),this._defs=c.definitions)}function e(a,c){for(var b=[],d=0;d<a.length;d++){var h=!0;c&&(h=a.charCodeAt(d)<=c);var f=l.cookieAlphabetMap.hasOwnProperty(a.charAt(d));h&&!f?b.push("*"+a.charCodeAt(d)+"."):b.push(a.charAt(d))}return b.join("")}function c(a){return a.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function h(a){for(var c={},b="",d=0;d<a.length;d++){var e=a.charAt(d);p[e]?b+=e:(isNaN(c[b])&&(c[b]=a.split(b).length-1),b="")}a=
[];for(var h in c)c.hasOwnProperty(h)&&(b=c[h],b>=s&&h.length>=r&&a.push([h,b]));return a=a.sort(function(a,c){return a[0].length===c[0].length?0:c[0].length>a[0].length?1:-1})}var g=f.Define,l=f.Cookie,k=[['","referrer":[{"url":"http://',"1-"],['","referrer":[{"url":"https://',"2-"],[',"referrer":[{"url":"http://',"3-"],[',"referrer":[{"url":"https://',"4-"],[',"sessionStartTime":',"5-"],["www.google.co.uk","6-"],["www.google.","7-"],['"sessionStartTime":',"8-"],['"landing":"',"9-"],["http%3A%2F%2Fwww",
"10-"],['"landing":',"L"],['"time":',"A"],['"pageViews":',"P"],['"sessionCount":',"B"],['"referrer":',"R"],['"url":"http://www.',"J"],['"url":"https://www.',"M"],['"url":"',"I"],['"url":',"U"],["http://www.","W"],["https://www.","V"],["%2Fen%2Ftsuk%2F","K"],['"sessionLandingPage":',"F"],["http%3A%2F%2F","D"],["http://","H"],["https://","X"],['""',"O"],['",',"Y"],['":{}}',"z"],["<","S"],[">","G"],["[","Z"],["]","E"],["{","a"],["}","b"],["(","c"],[")","d"],["!","e"],["#","f"],["$","g"],["!","q"],["'",
"i"],[":","j"],["?","k"],["^","x"],["`","m"],["|","n"],["~","o"],["%","v"],[",","C"]],m=a(k);g.clazz("qubit.opentag.compression.Encoder",d);d.prototype.encode=function(a,b){for(var d=a.replace(/\*/g,"**"),f=h(d),g=0;g<this._regexDefs.length;g++)var l=this._regexDefs[g],d=d.replace(l[0],l[1]);d=d.replace(/;/g,"*-");d=d.replace(/&/g,"*.");d=d.replace(/\\/g,"*/");d=d.replace(/=/g,"*+");d=d.replace(/\n/g,"*N");d=d.replace(/ /g,"*_");d=d.replace(/\t/g,"*T");d=d.replace(/"/g,"*Q");g=h(d);g.concat(f);for(var f=
d.replace(/@/g,"@@"),l=[],k=0,q=0;k<g.length;k++){var v=new RegExp(c(g[k][0]),"g"),v=f.replace(v,"@"+q+"-");v!==f&&(l.push(g[k][0]),q++,f=v)}g=[f,l];f=g[1];(l=0<f.length)&&(d=g[0]);d=b?e(d,b):e(d);return l?"Y"+f.join("*")+"@"+d:"N"+d};for(var p={},g=0;65>g;g++)p["abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ+_.".charAt(g)]=!0;var r=4,s=2;d.prototype.decode=function(a){var c=null;if("N"===a.charAt(0))a=a.substring(1);else if("Y"===a.charAt(0)){var d=a.indexOf("@");if(0<=d&&(c=a.substring(1,
d),c=c.split("*"),a=a.substring(d+1),c&&0!==c.length&&a)){for(var d="",e=!1,h=!1,f="",g=0;g<a.length;g++){var l=a.charAt(g);"@"===l||e||h?e||h?(e=!1,"@"===l?d+="@":isNaN(+("-"+l))?h?(d=c&&"-"===l&&c[+f]?d+c[+f]:d+("@"+f+l),f="",h=!1):d+="@"+l:(h=!0,f+=l)):e=!0:d+=l}f&&(d+="@"+f);e&&(d+="@");a=d}}c="";e=d=!1;h="";for(f=0;f<a.length;f++)g=a.charAt(f),"*"===g||d||e?d||e?(d=!1,isNaN(+("-"+g))?e?(c="."===g?c+String.fromCharCode(+h):"-"===g&&b(h+"-",this._defs)?c+b(h+"-",this._defs):c+("*"+h+g),h="",e=
!1):"*"===g?c+="*":"-"===g?c+=";":"/"===g?c+="\\":"."===g?c+="&":"+"===g?c+="=":"N"===g?c+="\n":"_"===g?c+=" ":"T"===g?c+="\t":"Q"===g?c+='"':null!==b(g,this._defs)?(g=b(g,this._defs),c+=g):c+="*"+g:(h+=g,e=!0)):d=!0:c+=g;h&&(c+="*"+h);d&&(c+="*");return c}})();(function(){function a(a){this.testBinary=!1;this.binSupported=d;a&&(this.compressor=new f.compression.Compressor,this.encoder=new f.opentag.compression.Encoder({}))}var b=f.Cookie,d=!1;f.Define.clazz("qubit.opentag.compression.CookieCompressor",
a);a.prototype.compress=function(a,c){if("string"!==typeof a||""===a)return a;var d=this.encoder.encode(a),e;if(this.binSupported||this.testBinary){e=this.compressor.compress(d);e='"B'+this.encoder.encode(e,128)+'"';b.set("__qtag_test_bin__",e,void 0,void 0,!0);var f=b.get("__qtag_test_bin__",!0);b.rm("__qtag_test_bin__");f&&f!==e&&(e=null)}f=this.encoder.encode(this.compressor.compressAnsi(d));d=!c&&d.length<=f.length?"E"+d:"C"+f;return e&&e.length<d.length?e:d};a.prototype.decompress=function(a){if("string"!==
typeof a||""===a)return a;'"'===a.charAt(0)&&(a=a.substring(1,a.length-1));var c=a.charAt(0);a=a.substring(1);switch(c){case "E":return this.encoder.decode(a);case "C":return a=this.compressor.decompressAnsi(this.encoder.decode(a)),this.encoder.decode(a);case "B":return a=this.compressor.decompress(this.encoder.decode(a)),this.encoder.decode(a);default:throw"This code is not supported! Code: "+c;}}})();(function(){var a=f.Cookie,b=f.opentag.Utils,d=function(){};f.Define.clazz("qubit.opentag.Session",
d);var e=new f.opentag.compression.CookieCompressor({});d.readCompressedCookie=function(c){c=a.get(c,!0);return e.decompress(c)};d.setupSession=function(c){var h=c.config,f,l,k,m,p;f={};f.sessionCount=g.update(h.cookieDomain);p="qtag_"+c.getContainerId();var r="x_qtag_"+c.getContainerId();k=a.get(p);c=!!k;null===k&&(k=a.get(r,!0),k=e.decompress(k));if(k)try{k=x.parse(k)}catch(s){k={sc:0,sessionCount:0,pageViews:0,sessionStartTime:0,referrer:[],sessionLandingPage:"",__v:{}}}else k={sc:0,sessionCount:0,
pageViews:0,sessionStartTime:0,referrer:[],sessionLandingPage:"",__v:{}};l=(new Date).getTime();f.sessionCount!==parseInt(k.sc,10)?(k.sessionStartTime=l,k.sc=f.sessionCount,k.sessionCount+=1,k.referrer.push({url:d.getReferrer(),landing:b.getUrl().substring(0,300),time:l}),k.sessionLandingPage=b.getUrl().substring(0,300)):d.isReferrerDifferent()&&!d.referrerIsSameAsPrevious(k.referrer,l,18E5)&&(k.referrer.push({url:d.getReferrer(),landing:b.getUrl().substring(0,300),time:l}),k.sessionLandingPage=b.getUrl().substring(0,
300),k.sessionStartTime=l,k.sessionCount+=1);f.sessionCount=k.sessionCount;f.sessionStartTime=k.sessionStartTime;f.pageStartTime=l;k.pageViews+=1;f.pageViews=k.pageViews;f.sessionLandingPage=k.sessionLandingPage;f.referrer=k.referrer;5<f.referrer.length&&f.referrer.splice(2,f.referrer.length-5);m=x.stringify(k);for(l=0;e.compress(m).length>h.maxCookieLength&&5>l;)3<=k.referrer.length?k.referrer.splice(2,1):2===k.referrer.length?k.referrer=[k.referrer[0]]:1===k.referrer.length&&(k.referrer=[]),m=x.stringify(k),
l+=1;f.referrer=k.referrer;c&&a.rm(p);p=e.compress(m);a.rm(r);0<h.maxCookieLength&&a.set(r,p,365,h.cookieDomain,!0);f.setVariable=function(c,b,d){k.__v[c]=[b,d?d:0];c=e.compress(x.stringify(k));0<h.maxCookieLength?a.set(r,c,365,h.cookieDomain,!0):a.rm(r)};f.getCookie=function(c,b){var d=a.get(c,!0);if(d&&(b||0===c.indexOf("x_")))try{d=e.decompress(d)}catch(f){}else null!==d&&(d=a.decode(d));return d};f.getVariable=function(a){var c;if(a=k.__v[a])if(c=a[1],0===c||c>(new Date).getTime())return a[0];
return null};f.on=function(a,c,b){c.attachEvent?c.attachEvent("on"+a,b):c.addEventListener&&c.addEventListener(a,b,!1)};f.getTagCookie=function(){return d.readCompressedCookie(r)};return d.lastSession=f};d.referrerIsSameAsPrevious=function(a,e,f){var g,l;return 0<a.length?(g=d.getReferrer(),l=b.getUrl().substring(0,300),a=a[a.length-1],a.url===g&&a.landing===l&&a.time+f>e):!1};d.isReferrerDifferent=function(){var a,b;b=d.getReferrer();a=b.indexOf("://");if(-1===a)return!0;try{return 0!==b.substring(a+
3).indexOf(d.getDomain())?!0:!1}catch(e){return!0}};d.getReferrer=function(){return document.referrer?document.referrer.substring(0,300):"direct"};d.getDomain=function(){return document.location.host}})();(function(){function a(c){d.setIfUnset(c,a.defaultConfig);if(this.singleton){var b=f.opentag.Utils.getObjectUsingPath(this.PACKAGE_NAME+"."+this.CLASS_NAME,e);if(b.__instance)return b.__instance;b.__instance=this}a.SUPER.call(this,c)}function b(a,e){var f=a.toString(),f=f.replace(/\s*function\s*\([\w\s,_\d\$]*\)\s*\{/,
""),f=f.substring(0,f.lastIndexOf("}")),f=f.replace(/(["']\s*\+\s*)\s*_*\w+\s*\.\s*valueForToken\s*\(\s*'([^']*)'\s*\)/g,'$1"${$2}"'),f=f.replace(/\s*_*\w+\s*\.\s*valueForToken\s*\(\s*'([^']*)'\s*\)(\s*\+\s*["'])/g,'"${$1}"$2'),f=f.replace(/(["']\s*\+\s*)\s*_*\w+\s*\.\s*valueForToken\s*\(\s*"([^"]*)"\s*\)/g,'$1"${$2}"'),f=f.replace(/\s*_*\w+\s*\.\s*valueForToken\s*\(\s*"([^"]*)"\s*\)(\s*\+\s*["'])/g,'"${$1}"$2'),f=f.replace(/\s*_*\w+\s*\.\s*valueForToken\s*\(\s*'([^']*)'\s*\)/g,"${$1}"),f=f.replace(/\s*_*\w+\s*\.\s*valueForToken\s*\(\s*"([^"]*)"\s*\)/g,
"${$1}"),f=e.replaceTokensWithValues(f);d.geval(f)}var d=f.opentag.Utils,g=f.Define;f.Define.clazz("qubit.opentag.LibraryTag",a,f.opentag.BaseTag);a.defaultConfig={vendor:null,imageUrl:null,description:"",async:!1,isPrivate:!1,upgradeable:!0,html:"",parameters:[],prePostWindowScope:!1};a.prototype.pre=function(){};a.prototype.post=function(){};a.prototype.before=function(){a.SUPER.prototype.before.call(this);try{var c=this.config;if(c&&c.pre)if("function"===typeof c.pre)this.pre=c.pre;else{var e=
this.replaceTokensWithValues(String(c.pre));this.pre=d.expressionToFunction(e).bind(this)}this.config.prePostWindowScope&&this.pre!==a.prototype.pre&&this.pre.toString?b(this.pre,this):this.pre()}catch(f){return!0}return!1};a.prototype.after=function(c){a.SUPER.prototype.after.call(this,c);try{var e=this.config;if(e&&e.post)if("function"===typeof e.post)this.post=e.post;else{var f=this.replaceTokensWithValues(String(e.post));this.post=d.expressionToFunction(f).bind(this)}this.config.prePostWindowScope&&
this.post!==a.prototype.post&&this.post.toString?b(this.post,this):this.post(c)}catch(g){}};a.define=function(c,b){c=c.replace(/^[\.]+/g,"").replace(/[\.]+$/g,"").replace(/\.+/g,".");c=f.Define.vendorsSpaceClasspath(c);var e={};b.getDefaultConfig&&(e=b.getDefaultConfig());var k=b.CONSTRUCTOR,m={},v;for(v in b)"config"!==v&&(m[v]=b[v]);m=f.opentag.Utils.defineWrappedClass(c,a,m,l,function(a){a=a||{};a=d.overrideFromBtoA(e,a);var c=f.opentag.LibraryTag.call(this,a);k&&k.call(this,a);if(c)return c});
v=g.STANDARD_VS_NS+".";0!==c.indexOf(v)&&d.namespace(v+c,m);return m};a.getLibraryByClasspath=function(a){return d.getObjectUsingPath(a,f.Define.getVendorSpace())}})();(function(){function a(){}var b=f.opentag.LibraryTag,d=f.Define;a.library=function(){return b.define.apply(b,arguments)};a.libraryRef=function(){return b.getLibraryByClasspath.apply(b.getLibraryByClasspath,arguments)};d.namespace("qubit.Quick",a)})();(function(){function a(c){this.runQueue=[];this.tags={};this.config={cookieDomain:"",
maxCookieLength:1E3,gzip:!0,delayDocWrite:!1,clientId:"",name:"",tellLoadTimesProbability:null,pingServerUrl:null,trackSession:null,disabled:!1,containerId:"",scanTags:!1,noPings:!1};this.ignoreTagsState=!1;if(c){this.setConfig(c);c.name||(this.config.name="Cont-"+p++);a.register(this);a.NO_PINGS&&(this.config.noPings=!0);this.ping=new f.opentag.Ping(this.config);var b=this.sendPings.bind(this);this._pingAsyncCallback=function(){g.setTimeout(b,5)};if(c.init)try{c.init.call(this,c)}catch(d){}}return this}
function b(a,c,d){a[d]&&(A[d]=A[d]||1,d+="("+A[d]+")",A[d]++);a[d]=c}var d=f.opentag.Utils,e=f.opentag.filter.BaseFilter,c=f.opentag.filter.Filter,h=f.opentag.BaseTag,g=f.opentag.Timed,l=f.opentag.Tags,k=f.opentag.Session,m=f.Cookie,p=1;try{window.opentag_consentGiven=function(){a.consentIsGiven=!0;for(var c=a.getContainers(),b=0;b<c.length;b++)try{c[b].run()}catch(d){}}.bind(this)}catch(s){}f.Define.clazz("qubit.opentag.Container",a);var x=[];a.register=function(a){d.addToArrayIfNotExist(x,a)};a.prototype.isTellingLoadTimes=
function(){var a=this.config.tellLoadTimesProbability;null===a&&(a=0);return a>Math.random()};a.prototype.destroy=function(a){this.destroyed=!0;this.unregister();if(a)for(var c in this.tags)a=this.tags[c],a instanceof h&&(a.destroy(),this.tags[c]=null,delete this.tags[c]);c=this.PACKAGE_NAME.split(".");c=c[c.length-1];a=d.getParentObject(this.PACKAGE_NAME);a[c]=null;delete a[c]};a.findContainersByName=function(a){for(var c=this.getContainers(),b=[],d=0;d<c.length;d++)c[d].config.name===a&&b.push(c[d]);
return b};a.getById=function(a){for(var c=this.getContainers(),b=0;b<c.length;b++)if(c[b].getContainerId()===a)return c[b];return null};a.prototype.unregister=function(c){a.unregister(this,c)};a.unregister=function(a,c){d.addToArrayIfNotExist(x,a);d.removeFromArray(x,a);if(c)for(var b in this.tags){var e=this.tags[b];e instanceof h&&(e.unregister(),this.tags[b]=null,delete this.tags[b])}};a.prototype.hasConsent=function(){return"Accepted"===m.get("qubitconsent")};a.prototype.register=function(c){a.register(c||
this)};a.getContainers=function(){return x};a.prototype.getContainers=function(){return a.getContainers()};a.prototype.onTagRegistered=function(a){};a.prototype.registerTag=function(a){var c=a.config.name;if(!this.tags[c]){this.tags[c]=a;try{this.onTagRegistered(a)}catch(b){}}};a.prototype.registerTags=function(a){for(var c=0;c<a.length;c++)this.registerTag(a[c])};a.prototype.setConfig=function(a){for(var c in a)this.config[c]=a[c]};a.prototype.run=function(){this.runTags({command:"runOnceIfFiltersPass"})};
a.prototype.runWithoutFilters=function(){this.runTags({command:"run"})};a.prototype.getTagByname=function(a){return this.tags[a]};a.prototype.containerScriptLoadedSynchronously=function(){var a,c,b,d,e;d=document.getElementsByTagName("script");a=0;for(c=d.length;a<c;a+=1)if(b=d[a],(e=b.getAttribute("src"))&&0<e.indexOf(""+this.config.clientId+"-"+this.getContainerId()+".js"))return null===b.getAttribute("async")&&(!1===b.getAttribute("defer")||""===b.getAttribute("defer")||null===b.getAttribute("defer"));
return!0};a.prototype.prepareSessionIfNeeded=function(){var b=this.config.trackSession;if(!0!==b&&!1!==b){var b=this.tags,d;for(d in b)if(b.hasOwnProperty(d)){for(var e=b[d].getFilters(),f=0;f<e.length;f++){var h=e[f];if(h instanceof c&&h.isSession()){this.trackSession=!0;break}}if(this.trackSession)break}}else this.trackSession=b;a.TRACK_SESSION&&(this.trackSession=!0);this.trackSession&&(this.session=k.setupSession(this))};a.prototype.runTags=function(c,b){if(this.destroyed)throw"Container has been destroyed.";
if(b||!a.LOCKED&&!d.global().QUBIT_CONTAINERS_LOCKED){if(this.onBeforeRun)try{this.onBeforeRun()}catch(e){}var f=!this.containerScriptLoadedSynchronously(),h="runIfFiltersPass";c&&c.command&&(h=c.command);this.runningStarted=(new Date).valueOf();var l={};this.config.scanTags&&!this._scanned&&(this.scanForTags(),this._scanned=(new Date).valueOf());this.prepareSessionIfNeeded();for(var k=this.getTagsInOrder(),n=0;n<k.length;n++)try{var m=k[n],q=m.config.name;if(this.includedToRun(m)){var v=m.resolveDependencies();
if(0<v.length)for(var p=0;p<v.length;p++){var r=v[p],s=r.config.name;!l[s]&&this.tags[s]&&(l[s]=r,this._tagRunner(r,h,f))}l[q]||(l[q]=m,this._tagRunner(m,h,f))}}catch(u){}g.setTimeout(function(){this.sendPingsNotTooOften()}.bind(this),1100);this.waitForAllTagsToFinish()}};a.prototype.getTagsInOrder=function(){var a=[],c;for(c in this.tags){var b=this.tags[c],d=b.config.priority;if(0<+d){for(var e=0,f=0;f<a.length;f++){var h=a[f];if(h)if(h=+h.config.priority,0<h&&h>d)e++;else break}a.splice(e,0,b)}else a.push(b)}return a};
a.prototype._tagRunner=function(a,c,b){try{this.includedToRun(a)&&(b&&(a.forceAsynchronous=!0),this.config.delayDocWrite&&(a.delayDocWrite=!0),a.session=a.session||this.session,a[c]())}catch(d){}};a.prototype.getContainerId=function(){if(this.config.containerId)return this.config.containerId;if(this._pkgName)return this._pkgName;var a=this.PACKAGE_NAME.split(".");return this._pkgName=a=a[a.length-1]};a.prototype.includedToRun=function(c){if(!c)return!1;var b=c.config;if(b.inactive||b.disabled&&!c.cookieSaysToRunEvenIfDisabled()||
c.disabledByCookie())return!1;b=a.consentIsGiven||!b.needsConsent||this.hasConsent();c=c.state===h.prototype.STATE.INITIAL;return this.ignoreTagsState||b&&c};a.prototype.scanForTags=function(a,c){a&&(this.tags={});var b;b=c&&"object"===typeof c?this.findAllTags(c):this.findAllTagsByClassPath();this.registerTags(b);return b};a.prototype.findAllTags=function(a,c){a=a||this.tagsPackageName||this.PACKAGE_NAME;return l.findAllTags(a,c)};a.prototype.findAllTagsByClassPath=function(a){a=a||this.PACKAGE_NAME;
return l.findAllTagsByClassPath(a)};a.prototype.findAllFilters=function(a,c){a=a||this.tagsPackageName||this.PACKAGE_NAME;return l.findAllFilters(a,c)};a.prototype.waitForAllTagsToFinish=function(){if(!this._waitForAllTagsToFinishWaiting){this._lastWaited||(this._lastWaited=(new Date).valueOf());var a=15E3<(new Date).valueOf()-this._lastWaited,a=this.allTagsFinished()||a;if(!this._showFinishedOnce&&a){if(this._lastWaited=null,this._showFinishedOnce=!0,this.runningFinished=(new Date).valueOf(),this.sendPingsNotTooOften(),
this.onTagsInitiallyRun)this.onTagsInitiallyRun()}else a||(this._waitForAllTagsToFinishWaiting=!0,this._showFinishedOnce=!1,g.setTimeout(function(){this._waitForAllTagsToFinishWaiting=!1;this.waitForAllTagsToFinish()}.bind(this),100))}};a.prototype.onTagsInitiallyRun=r;a.prototype.resetAllTags=function(){for(var a in this.tags)this.tags.hasOwnProperty(a)&&this.tags[a].reset()};a.prototype.reset=function(){this._showFinishedOnce=this.runningStarted=this._waitForAllTagsToFinishWaiting=this.runningFinished=
void 0;this.resetAllTags()};a.prototype.sendPingsNotTooOften=function(){this._sndLck=this._sndLck||{};g.runIfNotScheduled(this._pingAsyncCallback,2E3,this._sndLck)};a.prototype.sendPings=function(){if(!this.config.noPings){var a;if(this.isTellingLoadTimes()){var c=this.getAllTagsByState(),b=this,d;c.run&&(d=l.getLoadTimes(c.run),this.lastPingsSentTime=(new Date).valueOf(),this.ping.send(this,d));d=l.getLoadTimes();var e=[];for(a=0;a<d.length;a++)(function(a){a=d[a].tag;a.config.dedupe&&a.sendDedupePing&&
e.push(a)})(a);0<e.length&&(this.lastDedupePingsSentTime=(new Date).valueOf(),this.ping.sendDedupe(this,e));if(c.other){d=l.getLoadTimes(c.other);var f=[];for(a=0;a<d.length;a++)(function(a){var c=d[a].tag;f.push(d[a]);var e=c.onAfter;c.onAfter=function(a){e.call(c,a);b.sendPingsNotTooOften()}})(a);0<f.length&&this.ping.send(this,f)}if(c.awaiting){d=l.getLoadTimes(c.awaiting);var h=[];for(a=0;a<d.length;a++)(function(a){var c=d[a].tag;h.push(d[a]);var e=c.onAfter;c.onAfter=function(a){e.call(c,a);
b.sendPingsNotTooOften()}})(a);0<h.length&&this.ping.send(this,h)}}}};a.prototype.getAllTagsByState=function(){return a.getAllTagsByState(this.tags)};a.getAllTagsByState=function(a){var c=null,d=null,f=null,g=null,l=null,k=null,m=h.prototype.STATE.EXECUTED_WITH_ERRORS,q;for(q in a){var p=a[q];if(p instanceof h){var r=p.config.name;0<p.scriptExecuted?(c=c||{},b(c,p,r)):p.locked?(k=k||{},b(k,p,r)):0>p.scriptExecuted||p.state>=m?(g=g||{},b(g,p,r)):p.filtersState()===e.state.SESSION||0<p.filtersState()?
(f=f||{},b(f,p,r)):p.config.needsConsent?(l=l||{},b(l,p,r)):(d=d||{},b(d,p,r))}}return{run:c,failed:g,awaiting:f,consent:l,locked:k,other:d}};var A={};a.prototype.allTagsFinished=function(){for(var a in this.tags)if(this.tags.hasOwnProperty(a)){var c=this.tags[a];if(c instanceof f.opentag.BaseTag){var b=c.filtersState();if(!c.config.disabled){var d=0>c.filtersState()&&!c.locked,h=!(c.finished()||c.config.runner&&!c.isRunning);if(d&&h&&(c=0<+c.awaitingDependencies,b!==e.state.SESSION&&!c))return!1}}}return!0};
a.prototype.getPageVariables=function(){var a=[],c;for(c in this.tags)if(this.tags.hasOwnProperty(c))for(var b=this.tags[c].getPageVariables(),e=0;e<b.length;e++)d.addToArrayIfNotExist(a,b[e]);return a};a.getPageVariableByName=function(a){for(var c=this.getAllPageVariables(),b=[],d=0;d<c.length;d++)c[d].config.name===a&&b.push(c[d]);return b};a.prototype._getCookieNameForDisabling=function(){return"qubit.opentag.disableContainerRunning_"+this.getContainerId()+this.config.name};a.prototype.disabledByCookie=
function(){return!!m.get(this._getCookieNameForDisabling())};a.prototype.setCookieToDisable=function(){m.set(this._getCookieNameForDisabling(),"true")};a.prototype.rmCookieToDisable=function(){m.rm(this._getCookieNameForDisabling())};a.rmAllDisablingCookies=function(){d.rmCookiesMatching("qubit.opentag.disableContainerRunning_")};a.setCookieForDisabledContainersToRun=function(){m.set("qubit.opentag.forceContainerRunning","true")};a.rmCookieForDisabledContainersToRun=function(){m.rm("qubit.opentag.forceContainerRunning")}})();
(function(){function a(d){b.setIfUnset(d,{url:null,html:"",locationPlaceHolder:"NOT_END",locationObject:"BODY",async:!0});a.SUPER.call(this,d)}var b=f.opentag.Utils;f.Define.clazz("qubit.opentag.CustomTag",a,f.opentag.LibraryTag)})();(function(){var a={callbacks:{},unfired_events:[],early_callbacks:null,currentUV:null},b,d="universal_variable";a._isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)};a._targetChanged=function(b,c,d){if(null===d)return"null"===c?!1:!0;if(void 0===
d)return c===d?!1:!0;c=x.parse(c);c=a._getNested(c,b);b=a._getNested(d,b);return!a._jsonIsEqual(c,b)};a._processCallbacks=function(){var b;if(a.early_callbacks&&0<a.early_callbacks.length){for(b=0;b<a.early_callbacks.length;b+=1)a.push(a.early_callbacks[b]);a.early_callbacks=null}};a._keyStringToArr=function(a){a=a.replace(/^\s+/,"").replace(/\s+$/,"");if(""===a)return[];a=a.replace(/\[(\w+)\]/g,".$1");a=a.replace(/^\./,"");return a.split(".")};a._getNested=function(b,c){for(var d=a._keyStringToArr(c),
e;0<d.length;)if(e=d.shift(),b.hasOwnProperty(e))b=b[e];else return;return b};a._jsonIsEqual=function(b,c){"string"!==typeof b&&(b=x.stringify(b,a._stripEvents));"string"!==typeof c&&(c=x.stringify(c,a._stripEvents));return b===c};a._stripEvents=function(a,c){if("events"!==a)return c};a._on=function(b,c){var d;d=b.split(":");b=d[0];d=d[1];a.callbacks[b]=a.callbacks[b]||[];d?a.callbacks[b].push({keyString:d,func:c}):a.callbacks[b].push({func:c})};a._trigger=function(d,c){var e,f;if(a.callbacks[d])for(e=
0;e<a.callbacks[d].length;e+=1)"function"===typeof a.callbacks[d][e].func&&((f=a.callbacks[d][e].keyString)?"change"===d&&a._targetChanged(f,a.currentUV,b)&&a.callbacks[d][e].func(c):a.callbacks[d][e].func(c))};a._eventsPush=function(d){var c,e;b.events[b.events.length]=d;d.time=d.time||(new Date).getTime();if(a.callbacks.event)for(c=0,e=a.callbacks.event.length,c;c<e;c+=1)a.callbacks.event[c].func(d);d.has_fired=!0};a._getUnfiredEvents=function(){for(var d=0,d=0;d<b.events.length;d+=1)b.events[d].has_fired||
(a.unfired_events.push(b.events.splice(d,1)[0]),d-=1)};a._fireEvents=function(){for(;0<a.unfired_events.length;)b.events.push(a.unfired_events.shift())};a._resetEventsPush=function(){b.events=b.events||[];-1!==b.events.push.toString().indexOf("[native code]")&&(b.events.push=a._eventsPush,a._getUnfiredEvents(),a._fireEvents())};a._checkForChanges=function(){a.callbacks.change&&0<a.callbacks.change.length&&!a._jsonIsEqual(a.currentUV,b)&&(a._trigger("change",b),a.currentUV=x.stringify(b,a._stripEvents))};
a._setUVLocation=function(b){d=b;a._initUV()};a._initUV=function(){window[d]=window[d]||{events:[]};b=window[d];b.events||(b.events=[])};a.push=function(b){a._isArray(b)&&("on"===b[0]?a._on(b[1],b[2]):"trigger"===b[0]&&b[1]&&a._trigger(b[1]))};a.init=function(b,c){c&&(d=c);a._initUV();!window.uv_listener||a._isArray(window.uv_listener)?(a.early_callbacks=window.uv_listener||null,window.uv_listener=a,b||a.start()):c&&window.uv_listener._setUVLocation(d)};a.start=function(){a.currentUV=x.stringify(b,
a._stripEvents);setInterval(function(){a._initUV();a._resetEventsPush();a._checkForChanges()},500);a._processCallbacks()};s.UVListener=a})();(function(){function a(){}function b(a,d,e){!e||void 0!==a[d]&&""!==a[d]&&null!==a[d]||(a[d]=e)}var d=f.Cookie,e=f.opentag.Utils;a.run=function(){var c=!1,b;b=0<=document.location.href.indexOf("opentag_disabled=true")?!0:!1;if(!b){b=!1;if(d.get("opentag_debug_tool")||0<=document.location.href.indexOf("opentag_debug_tool"))b=!0;!b&&(b=!1,d.get("opentag_debug")||
0<=document.location.href.indexOf("opentag_debug"))&&(b=!0);b&&(l.TAGSDK_NS_OVERRIDE=f.DEBUG_MODE?!1:!0,c=!0);f.DEBUG_MODE&&(l.TAGSDK_NS_OVERRIDE=!1);try{s.UVListener.init()}catch(e){}a.runAllContainers(c)}};a.runAllContainers=function(c){try{for(var d=f.opentag.Container.getContainers(),g=0;g<d.length;g++){var k=d[g],m=k.config;if(!k.runningStarted&&!k.configuredInMain){m.scanTags=!0;var p=e.getParentObject(k.PACKAGE_NAME).ClientConfig;p&&b(k.config,"clientId",p.id);var r=e.getParentObject(k.PACKAGE_NAME).SystemDefaults;
r&&(b(m,"pingServerUrl",r.pingServerUrl),b(m,"tellLoadTimesProbability",r.tellLoadTimesProbability));k.configuredInMain=!0;c?(k.destroy(!0),a.loadDebugVersion(k)):l.QUBIT_OPENTAG_STOP_MAIN_EXECUTION?function(){var a=f.opentag.RUN_STOPPED_EXECUTON;f.opentag.RUN_STOPPED_EXECUTON=function(){try{a&&a()}finally{k.run()}}}(k):k.run()}}}catch(s){}};a.loadDebugVersion=function(a){var b=document.createElement("script"),d,e=a.config.scriptURL,g;(g=f.opentag.Utils.getParentObject(a.PACKAGE_NAME).ClientConfig)&&
g.clientId?g=g.clientId:(g=a.PACKAGE_NAME.split("."),g=g[g.length-2].substring(1));a=a.getContainerId();e&&(d=e,d.lastIndexOf("-debug.js")!==d.length-9&&(d=d.substring(0,d.length-3),d+="-debug.js"));b.src=d&&"//d3c3cq33003psk.cloudfront.net/opentag-"+g+"-"+a+"-debug.js"!==d?d:"//s3-eu-west-1.amazonaws.com/opentag/opentag-"+g+"-"+a+"-debug.js";document.getElementsByTagName("head")[0].appendChild(b)};f.Define.namespace("qubit.opentag.Main",a)})();(function(){function a(b){a.SUPER.apply(this,arguments)}
f.Define.clazz("qubit.opentag.pagevariable.UniversalVariable",a,f.opentag.pagevariable.Expression)})()})();function fitTextarea(b){"textarea"===b.tagName.toLowerCase()&&(b.style.overflow="hidden",b.style.height="0px",b.scrollHeight,b.style.height=25+b.scrollHeight+"px",b.style.overflow="")}function nextNode(b){for(;!b.tagName;)b=b.nextSibling;return b}
function toggleShowSibling(b,g){for(var e=g||b.nextSibling;e&&!e.style;)e=e.nextSibling;if(e){var l=!1;e.cmNode&&"none"===e.cmNode.style.display?(e.cmNode.style.display="",l=!0):e.cmNode||"none"!==e.style.display?(e.style.display="none",e.cmNode&&(e.cmNode.style.display="none")):(e.style.display="",l=!0,"TEXTAREA"===e.tagName&&attachEditor(e),fitTextarea(e));(e=b.children[0])&&"true"===e.getAttribute("plus")&&(e.innerHTML=l?"-":"+")}}
function attachEditor(b){b.cm=CodeMirror.fromTextArea(b,{lineNumbers:!0,mode:"javascript",theme:"ambiance",tabMode:"indent",matchBrackets:!0,extraKeys:{"Ctrl-Q":function(b){b.foldCode(b.getCursor())}},foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"]});b.cm.on("change",function(){b.value=b.cm.getValue()});b.cmNode=b.nextSibling}
function getParametersAndConfigForTagNode(b,g,e){var l=b.getElementsByTagName("input");b=b.reference.config;for(var k=0;k<l.length;k++){if(!g&&-1!==l[k].className.indexOf("red"))return"red";if(void 0!==l[k].pindex){var f=l[k].pindex;b.parameters[f].inputVariable=l[k].value;b.parameters[f].variable=void 0;if(l[k].value)try{var m=qubit.opentag.Utils.gevalAndReturn(l[k].value),m=m?m.result:m;b.parameters[f].variable={value:m}}catch(p){logError("Error reading configuration"+p)}}else if(!e&&void 0!==l[k].cname)switch(f=
l[k].cname,f){case "url":case "html":case "urlLocation":case "vendor":case "imageUrl":case "url":b[f]=l[k].value;break;default:try{b[f]=qubit.opentag.Utils.gevalAndReturn(l[k].value).result}catch(r){}}}return e?{parameters:b.parameters}:b}function applyParametersAndConfigToTag(b,g){b.parameters=g.parameters;for(var e in g)b[e]=g[e]}
function classPath(b){if(b){b=b.split(".");for(var g=0;g<b.length;g++){var e=b[g],e=e.replace(/\s+/g,"_"),e=e.replace(/[\W+]/g,"");e.match(/^\d+/)&&(e="_"+e);b[g]=e}return b.join(".").replace(/^[\.]+/g,"").replace(/[\.]+$/g,"").replace(/\.+/g,".")}return b}function getLibraryReferenceNode(b){for(;null!==b&&!b.reference;)b=b.parentNode;return b}window.__tmp__qubit__test_page_8_=null;
function extractFunctionOrString(b){var g=qubit.opentag.Utils.trim(b);return 0===g.indexOf("function")?(qubit.opentag.Utils.geval("window.__tmp__qubit__test_page_8_="+g),window.__tmp__qubit__test_page_8_):b}var IS_IE=!1;-1!==navigator.appName.indexOf("Internet Explorer")&&(IS_IE=!0);
function getXMLHttpRequest(){var b;try{b=new ActiveXObject("Microsoft.XMLHTTP")}catch(g){try{b=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{b=new XMLHttpRequest}catch(l){throw"Your browser does not support AJAX!";}}}IS_IE?window.onerror=function(){}:b.onerror=function(){};return b}
function GET(b,g,e){var l=getXMLHttpRequest();l.onreadystatechange=function(){4===l.readyState&&g(l.responseText,l)};e=void 0===e?!0:e;try{l.onerror=function(b){logError("Error while sending GET:"+b)}}catch(k){}b=fakeParam(b);l.open("GET",b,e);l.send()}
function POST(b,g,e,l){var k=getXMLHttpRequest();k.onreadystatechange=function(){4===k.readyState&&e(k.responseText,k)};l=void 0===l?!0:l;try{k.onerror=function(b){logError("Error while sending POST:"+b)}}catch(f){}b=fakeParam(b);k.open("POST",b,l);k.setRequestHeader("Content-type","application/x-www-form-urlencoded");k.send(g)}function fakeParam(b){return b&&-1!==b.lastIndexOf("?")?b+"&fparam="+(new Date).getTime()*Math.random():b+"?fparam="+(new Date).getTime()*Math.random()}
function theProgressBar(b,g){var e=!1,l=document.getElementById("progress-bar-template").innerHTML;if(e)return!1;theProgressBar.title=b;var e=!0,k=document.createElement("div");k.className="progress-bar";k.innerHTML=l;document.body.appendChild(k);k.bar=k.children[0].children[0];k.titleNode=k.bar.children[0];k.titleNode.innerHTML=theProgressBar.title;k.progress=k.bar.children[1];var f=function(){var b=g();100<=b?(k.titleNode.innerHTML=theProgressBar.title+" 100% Done.",k.progress.style.width="100%",
setTimeout(function(){e=!1;document.body.removeChild(k)},200)):(k.titleNode.innerHTML=theProgressBar.title+" "+Math.floor(b)+"%",k.progress.style.width=Math.floor(b)+"%",setTimeout(f,20))};f();return!0}
function qconsole(){this.init=function(){if(!this.initialized){this.initialized=!0;var b=document.getElementById("console-template").innerHTML;this.container=document.createElement("div");this.container.className="qconsole";this.container.innerHTML=b;this.msgContainer=this.container.children[1];document.body.appendChild(this.container);this.msgContainer.scrollTop=this.msgContainer.scrollHeight;var g=this;this.container.ondblclick=function(){info("[double click] Clearing & hiding console...");g.clear();
g.hide()}}};this.log=function(b){var g=document.getElementById("console-msg-template").innerHTML,e=document.createElement("div");e.className="msg";e.innerHTML=g;e.msg=e.children[1];e.header=e.children[0];e.msg.innerHTML=" >>> "+b;this.msgContainer.appendChild(e);this.msgContainer.scrollTop=this.msgContainer.scrollHeight};this.clear=function(){this.msgContainer.innerHTML=""};this.show=function(){qubit.opentag.Utils.addClass(this.container,"shown");qubit.opentag.Utils.removeClass(this.container,"hidden");
this.hidden=!1};this.hide=function(){qubit.opentag.Utils.removeClass(this.container,"shown");qubit.opentag.Utils.addClass(this.container,"hidden");this.hidden=!0};this.init()}var Utils=qubit.opentag.Utils;
function runTagHandler(b){var g=getParametersAndConfigForTagNode(b);if("red"===g)logError("Please fill all highlighed parameter values.\n They are required for tag to run.",2E3);else{var e=APP_PATH+"getClassPath?classPath=libraries."+b.reference.PACKAGE_NAME+".local&file=UVConf.js";GET(e,function(l,k){var f=!0;200!==k.status&&(f=!1,log("UVConfig not found. Proceeding normally."));try{f&&(log("Evaluating UVConf.js from "+e),qubit.opentag.Utils.geval(l))}catch(m){error("Exception while running UVConf.js: "+
m)}finally{runTag(b,g)}})}}
function runTag(b,g){try{var e={},l=b.classReference,k=b.reference;applyParametersAndConfigToTag(e,g);try{for(var f=e.parameters,m=0;m<f.length;m++)for(var p=f[m],r=0;r<k.config.parameters.length;r++){var s=k.config.parameters[r];if(s.token===p.token){p.uv=s.uv;break}}}catch(x){}var a=k.preNode.value;String(a)!==k.config.pre&&String(a)!==String(k.pre)&&(e.pre=extractFunctionOrString(a));var v=k.postNode.value;String(v)!==k.config.post&&String(v)!==String(k.post)&&(e.post=extractFunctionOrString(v));
var d=k.scriptNode.value;String(d)!==k.config.script&&String(d)!==String(k.script)&&(e.script=extractFunctionOrString(d));var n=new l(e);info("triggering run() for "+n.config.name+" ...");n.run();info("Currently executed tag instance is exposed as <pre>window.instance<pre>Please open web console to see more logs.<br/>To view library the logs run:<pre>instance.log.rePrint(5);</pre>in web console.",5E3);window.instance=n}catch(c){logError("Error while executing configuration:"+c)}}
function saveConfig(b){b=getLibraryReferenceNode(b);var g=b.reference;b=getParametersAndConfigForTagNode(b,!0,!0);for(var e=0;e<b.parameters.length;e++)b.parameters[e].variable=void 0,delete b.parameters[e].variable;b=json.serialize({parameters:b.parameters},{prettyPrint:!0});e=g.PACKAGE_NAME+".local";b=encodeURIComponent("//:include tagsdk-current.js\n"+("qubit.opentag.Utils.namespace('"+e+"');\n")+e+".Config = "+b+";");POST(APP_PATH+"saveConfig","classPath=libraries."+g.PACKAGE_NAME+".local&config="+
b,function(b,e){var f=qubit.opentag.Utils.gevalAndReturn(b);f&&f.result.ok?info("Saved"):logError(b)})}
function saveNewVersion(b,g){(g||window.event).ignoreEvent=!0;b=getLibraryReferenceNode(b);var e=b.reference,l=prompt("Please enter the name of the new version, eg 'v1'.\n\n");if(l){var l=classPath(l),e=e.PACKAGE_NAME,k=e.split(".");POST(APP_PATH+"saveNewVersion","location=libraries&classPath="+e+"&version="+(k[0]+"."+k[1])+"."+l,function(b,e){var g=qubit.opentag.Utils.gevalAndReturn(b);g&&g.result.ok?(info("Created new version."),info("Rebuilding system...",1E4),rebuildAndReload()):logError("Error while creating new version: "+
b)})}}function rebuildAndReload(){if(window.buildLocationString){var b="path="+encodeURIComponent(window.buildLocationString);GET(APP_PATH+"rebuild?"+b,function(b,e){var l=qubit.opentag.Utils.gevalAndReturn(b);l&&l.result.ok?(info("System has been rebuilt for "+window.buildLocationString,1E4),info("Reloading page."),location.reload()):logError("Rebuild failed! "+b)})}}var editUVURL=LIBRARIES_REPO_LOC+"shared/templates/UVConf.js";
function editUVURLHandler(b){GET(editUVURL,function(g,e){200!==e.status?logError(g):editUV(b,g)})}function editUV(b,g){openInEditorAndCreate("libraries."+b.reference.PACKAGE_NAME+".local","UVConf.js",!0,g)}function openInEditorHandler(b){openInEditorAndCreate("libraries."+b.reference.PACKAGE_NAME,"Tag.js",!1)}
function openInEditorAndCreate(b,g,e,l){l="classPath="+b+"&file="+g+"&create="+!!e+"&data="+encodeURIComponent(l);POST(APP_PATH+"openInEditor",l,function(b,e){var g=qubit.opentag.Utils.gevalAndReturn(b);g&&g.result.ok||(logError(b),logError("Make sure that CLASSPATH of your library matches its location!"))})}
function reloadTagHandler(b){var g=qubit.opentag.Utils,e=b.reference,l=b.libraryWidget,k=b.classReference.versionClassPath,f="classPath=libraries."+e.PACKAGE_NAME+"&file=Tag.js";reloadTests(b);POST(APP_PATH+"getClassPath",f,function(f,p){200!==p.status&&logError("Error loading tag: "+f);try{var r=getParametersAndConfigForTagNode(b,!0,!0);try{g.getObjectUsingPath(e.PACKAGE_NAME).Tag=void 0}catch(s){}qubit.opentag.Utils.geval(f);var x=g.getObjectUsingPath(e.PACKAGE_NAME+".Tag");x.versionClassPath=k;
l.renderLibraryToNode(x,null,null,r)}catch(a){logError("Error loading tag: "+a)}})}function cancelEvent(b){b.stopPropagation?b.stopPropagation():b.cancelBubble=!0}var Utils=qubit.opentag.Utils,testSuiteCodeTemplateURL=LIBRARIES_REPO_LOC+"shared/templates/TestsSuite.js";function addEditTests(b){GET(testSuiteCodeTemplateURL,function(g,e){200!==e.status?logError(g):addEditStandardTests(b,g)})}
function addEditStandardTests(b,g){if(b=getLibraryReferenceNode(b)){var e=b.reference,l=g.replace("_PACKAGE_",e.PACKAGE_NAME),l=l.replace("_TAG_",e.PACKAGE_NAME+".Tag"),k=e.PACKAGE_NAME.split(".").join("/"),l=l.replace("_TAGPATH_",k+"/Tag.js");openInEditorAndCreate("libraries."+e.PACKAGE_NAME+".local","TestsSuite.js",!0,l)}}var bddSuiteCodeTemplateURL=LIBRARIES_REPO_LOC+"shared/templates/BDDSuite.js";
function addEditDescribeTests(b){GET(bddSuiteCodeTemplateURL,function(g,e){200!=e.status?logError(g):addEditBDDTests(b,g)})}function addEditBDDTests(b,g){if(b=getLibraryReferenceNode(b)){var e=b.reference,l=g.replace("_PACKAGE_",e.PACKAGE_NAME),l=l.replace("_TAG_",e.PACKAGE_NAME+".Tag"),k=e.PACKAGE_NAME.split(".").join("/"),l=l.replace("_TAGPATH_",k+"/Tag.js");openInEditorAndCreate("libraries."+e.PACKAGE_NAME+".local","BDDSuite.js",!0,l)}}function reloadTests(b){_reloadTest(b,"BDDSuite.js")}
function _reloadTest(b,g){var e=qubit.opentag.Utils,l=b.reference,k=b.libraryWidget;POST(APP_PATH+"getClassPath","classPath=libraries."+l.PACKAGE_NAME+".local&file="+g,function(f,g){200!==g.status&&log("Error loading test (probably no tests). "+f);try{var p=getParametersAndConfigForTagNode(b,!0,!0);try{e.getObjectUsingPath(l.PACKAGE_NAME).local.TestsSuite=void 0}catch(r){}qubit.opentag.Utils.geval(f);var s=e.getObjectUsingPath(l.PACKAGE_NAME+".Tag");k.renderLibraryToNode(s,null,null,p)}catch(x){log("Error loading test: "+
x)}finally{reloadBDDTests(b)}})}
function reloadBDDTests(b){var g=qubit.opentag.Utils,e=b.reference,l=b.libraryWidget;POST(APP_PATH+"getClassPath","classPath=libraries."+e.PACKAGE_NAME+".local&file=BDDSuite.js",function(k,f){200!==f.status&&log("Error loading test (probably no tests). "+k);try{var m=getParametersAndConfigForTagNode(b,!0,!0);try{g.getObjectUsingPath(e.PACKAGE_NAME).local.BDDSuite=void 0}catch(p){}qubit.opentag.Utils.geval(k);var r=g.getObjectUsingPath(e.PACKAGE_NAME+".Tag");l.renderLibraryToNode(r,null,null,m)}catch(s){log("Error loading test: "+
s)}})}var testsRunning=!1;
function runAllTests(b){if(testsRunning)info("Wait for currently running tests to finish.");else{testsRunning=!0;for(var g=document.getElementsByTagName("div"),e=0,l=0,k=[],f=0;f<g.length;f++){var m=g[f];"true"===m.getAttribute("library-node")&&(++e,k.push(m))}var p=function(f){try{var g=k[f];g&&runTestsHandler(g,function(){++l;l<e&&setTimeout(function(){p(l)},5);l===e&&(testsRunning=!1,b&&b())})}catch(m){}};p(0);theProgressBar("Running test suites...",function(){return 0===l?0:l/e*100})}}
function runTestsHandler(b,g){try{var e=b.reference,l=qubit.opentag.Utils,k=l.getObjectUsingPath(e.PACKAGE_NAME+".local.TestsSuite"),f=l.getObjectUsingPath(e.PACKAGE_NAME+".local.BDDSuite"),m=function(){var e=!1;k&&!k.isFinished()?e=!0:f&&!f.isFinished&&(e=!0);if(!e){e=!1;if(f)for(var m=f.children,p=0;p<m.length;p++)if("failed"===m[p].result.status){e=!0;break}m=!1;k&&k.failedTests&&0<k.failedTests.length&&(m=!0);if(f||k)m||e?l.addClass(b,"tests-failed"):l.addClass(b,"tests-passed");g&&g()}};k||f?
(k&&runSuite(k,m),f&&runBDDSuite(f,m)):(g&&g(),l.addClass(b,"tests-notests"),log("No tests detected for "+e.config.name))}catch(p){logError("Error while executing tests suite:"+p)}}function runSuite(b,g){b?(b.onFinished=function(){g&&g()},b.run()):g&&g()}function runBDDSuite(b,g){if(b){var e=b.resultCallback;b.resultCallback=function(){e.apply(b,arguments);b.isFinished=!0;if(g)try{g()}catch(l){window.log("Error while running test:"+l)}};b.execute()}else g&&(b.isFinished=!0,g())}Utils=qubit.opentag.Utils;
function toggleUVSelector(b){"Close UV Browser"===b.innerHTML?(document.getElementById("uv-selector-holder").innerHTML="",b.innerHTML="Browse UV"):(openUVVariableSelector(),b.innerHTML="Close UV Browser")}function openUVVariableSelector(){var b=document.getElementById("uv-selector-holder");b.innerHTML="";renderUVSelector(b)}var uvPopupTemplate=document.getElementById("uv-popup-template").innerHTML;
function renderUVSelector(b,g){b.innerHTML="";var e=document.createElement("div");e.innerHTML=uvPopupTemplate;b.appendChild(e);var l=e.children[0].children[1].children[0].children[0],k=e.children[0].children[2];loadUVVariables(function(){for(var b=window.UVS,e=0;e<b.length;e++)(function(b){b.onclick=function(){k.value=b.expr;k.className="result";g&&g(b.expr)}})(renderUVSelectorItemYoNode(l,b[e]))})}var uvPopupItemTemplate=document.getElementById("uv-popup-item-template").innerHTML;
function renderUVSelectorItemYoNode(b,g){var e=document.createElement("div");e.innerHTML=uvPopupItemTemplate;var l=e.children[0].children[1];e.children[0].children[0].innerHTML=g.name;l.innerHTML=g.description;e.expr=g.expression;b.appendChild(e);return e}
function loadUVVariables(b){window.UVS?b&&b(UVS):GET(LIBRARIES_REPO_LOC+"shared/bin/html/data/uv.data",function(g,e){200!==e.status&&log("Error loading UV data: "+g);try{for(var l=g.split("\n"),k=[],f={},m=0;m<l.length;m++){var p=l[m].split("\t"),r={name:p[1],expression:p[2],description:p[3]};f[r.expression]=r;k.push(r)}window.UVS=k;window.EUVS=f;b(k)}catch(s){logError("Error loading UVs: "+s)}})}
(function(){function b(a,b){for(var d=0;d<b.length;d++)if("function"===typeof b[d]&&a instanceof b[d])return!0;return!1}function g(a,b){for(var d=0;d<b.length;d++)if(typeof a===b[d])return!0;return!1}function e(a,b){for(var d=0;d<b.length;d++)b[d]===a&&b.splice(d,1);return b}function l(a){return'"'+a.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"'}function k(a,b){return a?" "+b:b}function f(a,b,d,e,c){var f=" ";""===d&&(f="");return(d||e?0===c.length?[f,a,c.join(","),b]:[f,a,"\n",d,p,c.join(",\n"+
d+p),"\n",d,b]:[a,c.join(","),b]).join("")}var m={};m.checkIfInstanceOf=b;var p="  ",r=function(a,m,d,n,c){if(isNaN(c)||!(n>=c)){var h,s,q,z,u=!1,x,B=!0,G=!1,A=!1,w=!1,t=!1;m&&(m.prettyPrint&&(t=!0),m.raw&&(G=m.raw),m.excludedInstances&&(h=m.excludedInstances),m.excludedTypes&&(s=m.excludedTypes),m.excludedNames&&(q=m.excludedNames),m.own&&(z=m.hasOwn),m.fakeFunctions&&(A=m.fakeFunctions),m.realFunctions&&(w=m.realFunctions),m.includeFunctions&&(u=m.includeFunctions),m.excludeOnTrue&&(x=m.excludeOnTrue),
m.dateAsString&&(B=m.dateAsString));var C="",y="";if(t){for(t=0;t<n;t++)C+=p;y="\n"}if(a instanceof Date)return!G||B?l(a.toISOString()):a.valueOf();if(u||"function"!==typeof a){if("number"===typeof a)return k(C,String(a));if("string"===typeof a)return k(C,l(a));if(null===a)return k(C,"null");if(void 0===a)return G?k(C,"undefined"):void 0;if("boolean"===typeof D)return k(C,String(a));if(u&&"function"===typeof a&&A)return"(function(){})";if(u&&"function"===typeof a&&w)return k(C,a.toString());a:{if(a instanceof
Object)for(D=0;D<d.length;D++)if(d[D]===a){D=!0;break a}D=!1}if(!D){d.push(a);++n;if(a instanceof Array){q=[];for(t=0;t<a.length;t++){if(x)try{if(x(a))continue}catch(N){}if(!h||!b(a,h))if(!s||!g(a,s)){try{var E=r(a[t],m,d,n,c)}catch(J){return e(a,d),l(String(J))}void 0!==E&&q.push(E)}}e(a,d);return f("[","]",C,y,q)}var E=[],F;for(F in a){var D=a[F];if(!z||a.hasOwnProperty(F)){if(x)try{if(x(a))continue}catch(O){}if(!h||!b(D,h))if(!s||!g(D,s)){if(u=q)a:{for(u=0;u<q.length;u++)if(F===q[u]){u=!0;break a}u=
!1}if(!u)try{var I=r(D,m,d,n,c);if(void 0!==I){var K='"'+F.replace(/\"/g,'\\"')+'":'+I;E.push(K)}}catch(L){return e(a,d),l(String(L))}}}}e(a,d);return f("{","}",C,y,E)}}}};m.serialize=function(a,b){var d;b&&(d=b.level);return r(a,b,[],0,d)};var s=(0,eval("this"))||function(){return this}()||this.window;m.parse=function(a){if(/[^,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]/.test(a.replace(/"(\\.|[^"\\])*"/g,"")))throw"insecure json!";a="json.___tmp = ("+a+")";s.execScript?s.execScript(a):s.eval.call(s,a);return m.___tmp};
s.json=m;try{module.exports=m}catch(x){}})();
(function(){function b(b){b&&(this.parentContainer=b.parentContainer,this.container=b.container,this.className=b.className,this.maxTime=b.maxTime,this.closeable=b.closeable,this.init())}b.prototype.init=function(){this.container=this.container||document.createElement("div");this.container.className+=" qubit-notification "+(this.className?this.className:"")};b.prototype.drawCloseButton=function(){var b=this;this.closeable&&(this.closeButton=document.createElement("div"),0===this.container.childNodes.length?
this.container.appendChild(this.closeButton):this.container.insertBefore(this.closeButton,this.container.childNodes[0]),this.closeButton.className="notification-close-button",this.closeButton.onclick=function(){b.destroy()})};b.prototype.show=function(){this.container.style.display=""};b.prototype.hide=function(){this.container.style.display="none"};b.prototype.setContent=function(b){this.content!==b&&(this.content=b,this.container.innerHTML="","object"===typeof b?this.container.appendChild(b):this.container.innerHTML=
b,this.drawCloseButton());return b};b.prototype.paint=function(){this.painted||(this.parentContainer.appendChild(this.container),this.painted=!0)};b.prototype.destroy=function(){try{if(this.onDestroy)this.onDestroy()}finally{this.container.parentNode&&this.container.parentNode.removeChild(this.container)}};window.Notification=b})();
(function(){function b(b){b&&(this.maxTime=+b.maxTime||6E4,this.notifiers={},this.className=b.className,this.parentContainer=b.parentContainer||document.body,this.container=b.container||document.createElement("div"),this.init())}var g=window.Notification;b.prototype.notify=function(b,l,k,f,m){if(!this.notifiers[b]){k=new g({parentContainer:this.container,maxTime:k,className:f,closeable:m});var p=this;k.onDestroy=function(){delete p.notifiers[b]};this.notifiers[b]=k;k.paint()}this.notifiers[b].show();
this.notifiers[b].setContent(l);this.notifiers[b].timestamp=(new Date).valueOf()};b.prototype.done=function(b,g,k){this.notify(b,g);var f=this;setTimeout(function(){f.notifiers[b]&&(f.notifiers[b].destroy(),delete f.notifiers[b])},k)};b.prototype.init=function(){this.setParentContainer(this.parentContainer);var b=this,g;g=function(){b.container&&b.container.parentNode&&(b.oldNotifiersCheck(),setTimeout(g,500))};g()};b.prototype.setParentContainer=function(b){this.parentContainer=b;this.parentContainer.appendChild(this.container);
this.container.className.lastIndexOf(" qubit-notificationmanager"===-1)&&(this.container.className+=" qubit-notificationmanager "+this.className)};b.prototype.oldNotifiersCheck=function(){var b,g;for(b in this.notifiers)this.notifiers.hasOwnProperty(b)&&(g=this.notifiers[b].maxTime||this.maxTime,(new Date).valueOf()-this.notifiers[b].timestamp>g&&this.notifiers[b].destroy())};b.prototype.clear=function(){for(var b in this.notifiers)this.notifiers.hasOwnProperty(b)&&this.notifiers[b].destroy()};window.NotificationManager=
b})();var Utils=qubit.opentag.Utils,parameterTemplate=document.getElementById("parameter-template").innerHTML,parametersTemplate=document.getElementById("parameters-template").innerHTML;function Parameters(b){b&&(this.config=b,this.init())}Utils.clazz("ui.Parameters",Parameters);Parameters.prototype.paint=function(){this.painted=!0;this.config.parentContainer.appendChild(this.container)};
Parameters.prototype.init=function(){var b=document.createElement("div");b.innerHTML=parametersTemplate;b.className="parameters-container";this.container=b;for(var g=b.children[1].children[0],e=b.children[1].children[1],l=this.config.params,k=0;k<l.length;k++){var b=document.createElement("div"),f=l[k];b.innerHTML=parameterTemplate;var m=b.getElementsByTagName("input")[0];m.pindex=k;b.paramNode=m;b.uvNode=b.getElementsByTagName("input")[1];b.getElementsByTagName("label")[0].innerHTML=f.name+" (token: <pre style='display:inline'>"+
f.token+"</pre>)";var p=!1;f.uv?(p=!0,b.uvNode.value=f.uv):(Utils.addClass(b.uvNode,"no-uv"),b.uvNode.value="edit script to set universal variable");f=void 0!==f.inputVariable?f.inputVariable:"";m.value=f;m.className=f||p?"":"red";p&&(m.setAttribute("onfocus",null),m.setAttribute("onblur",null));g.appendChild(b)}0===l.length?(e.style.display="none",g.innerHTML="<div class='no-params'>No parameters defined.</div>"):e.style.display=""};var excluded="parameters PACKAGE dependencies CONSTRUCTOR dedupe priv name description inactive vendor loadDependenciesOnLoad variables".split(" ");
function propertyExcludedFromConfig(b){for(var g=0;g<excluded.length;g++)if(b===excluded[g])return!0;return!1}var hidden=["filterTimeout","isPrivate",,"usesDocumentWrite","timeout","singleton","locationPlaceHolder","locationDetail","locationObject","noMultipleLoad","__proto__"];function propertyHiddenFromConfig(b){for(var g=0;g<hidden.length;g++)if(b===hidden[g])return!0;return!1}
function prepareConfigElement(b,g,e){var l=document.createElement("div");l.innerHTML=e;l.children[0].className="config";l.getElementsByTagName("input")[0].cname=b;l.getElementsByTagName("label")[0].innerHTML=b;void 0!==g&&(l.getElementsByTagName("input")[0].value=g);l.getElementsByTagName("input")[0].entered=!0;return l}var configTemplate=document.getElementById("config-template").innerHTML,hiddenConfigTemplate=document.getElementById("toggled-config-template").innerHTML;
function addConfig(b,g){var e=document.createElement("div");e.innerHTML=hiddenConfigTemplate;e.className="config-header";var l=e.children[0].children[0];l.innerHTML="<span plus='true'>+</span> Configuration";toggleShowSibling(l);var k=e.children[0].children[1];b.appendChild(e);for(var f in g)propertyExcludedFromConfig(f)||propertyHiddenFromConfig(f)||(l=prepareConfigElement(f,g[f],configTemplate),k.appendChild(l));e=document.createElement("div");e.innerHTML=hiddenConfigTemplate;e.className="config-header";
k.appendChild(e);l=e.children[0].children[0];k=e.children[0].children[1];toggleShowSibling(l);l.innerHTML="<span plus='true'>+</span> Advanced";for(f in g)!propertyExcludedFromConfig(f)&&propertyHiddenFromConfig(f)&&(l=prepareConfigElement(f,g[f],configTemplate),k.appendChild(l))}var prePostTemplate=document.getElementById("pre-post-script-template").innerHTML;
function addPrePostTemplate(b,g){var e=document.createElement("div");e.innerHTML=prePostTemplate;var l=e.getElementsByTagName("textarea"),k=l[0],f=l[1],l=l[2],m=g.config.post?g.config.post:String(g.post),p=g.config.script?g.config.script:String(g.script);k.value=String(g.config.pre?g.config.pre:String(g.pre));f.value=String(m);l.value=String(p);k.style.display="none";f.style.display="none";l.style.display="none";g.preNode=k;g.postNode=f;g.scriptNode=l;b.appendChild(e)}var testTemplate=document.getElementById("unit-test-template").innerHTML;
function addTest(b,g){var e=document.createElement("div");e.innerHTML=testTemplate;e.className="unit-test";g.testNode=e;g.statusNode=e.children[0];g.nameNode=e.children[1];g.nameNode.innerHTML=g.name;g.onFinished=function(){this.failed?Utils.addClass(this.statusNode,"failed"):this.passed&&Utils.addClass(this.statusNode,"passed")};b.appendChild(e)}
function addBDDTest(b,g){var e=document.createElement("div");e.innerHTML=testTemplate;e.className="unit-test";g.testNode=e;g.statusNode=e.children[0];g.nameNode=e.children[1];g.nameNode.innerHTML=g.description;var l=g.resultCallback;g.resultCallback=function(b){l.apply(g,arguments);"failed"===g.result.status?Utils.addClass(g.statusNode,"failed"):"passed"===g.result.status&&Utils.addClass(g.statusNode,"passed")};b.appendChild(e)}var testsSuiteTemplate=document.getElementById("unit-tests-suite-template").innerHTML;
function addTestsSuite(b,g){var e=document.createElement("div");e.className="unit-tests-suite";e.innerHTML=testsSuiteTemplate;var l=Utils.getObjectUsingPath(g.PACKAGE_NAME+".local.TestsSuite"),k=Utils.getObjectUsingPath(g.PACKAGE_NAME+".local.BDDSuite");b.appendChild(e);renderTestsToNode(e.children[1],l,k)}
function renderTestsToNode(b,g,e){b.innerHTML="";if(e){e.unitTestsNode=b;e=e.children;for(var l=0;l<e.length;l++)addBDDTest(b,e[l])}if(g)for(g.unitTestsNode=b,e=g.tests,l=0;l<e.length;l++)addTest(b,e[l])}function prepareVendorNode(b){var g=document.createElement("div");g.innerHTML="<a class='plain' href='#-2'>"+b+"</a>";g.className="vendor";g.children[0].onclick=function(){var b=this.ishidden?"show":"hide";this.ishidden=!this.ishidden;this.parentNode.className="vendor "+b};return g}
function findTags(b,g){g=g||[];Utils.traverse(b,function(e,l,k,f){e&&e.prototype&&"superclass"!==k&&e.prototype instanceof qubit.opentag.BaseTag&&e!==qubit.opentag.BaseTag&&e!==qubit.opentag.LibraryTag&&e!==qubit.opentag.CustomTag&&b.Tag!==e&&g.push(e)},{objectsOnly:!0,track:!0});return g}
(function(){function b(b){this.config=b||{};b&&(this.libraryNode=document.createElement("div"),this.config.parentContainer.appendChild(this.libraryNode),this.init(this.paint.bind(this)))}var g=document.getElementById("library-template").innerHTML,e=qubit.opentag.Utils;e.clazz("ui.Library",b);b.prototype.paint=function(b){this.painted=!0;this.renderLibraryToNode(this.config.libraryClass,this.libraryNode,b||"hide")};b.prototype.init=function(b){var g=APP_PATH+"getClassPath?classPath=libraries."+this.config.libraryClass.prototype.PACKAGE_NAME+
".local&file=Config.js";try{GET(g,function(f){try{e.geval(f)}catch(g){}b&&b()})}catch(f){(b,f)&&b()}};b.prototype.renderLibraryToNode=function(b,k,f,m){m=m||{};var p=new b;p.unregister();if(m.parameters&&p.config.parameters)for(var r=0;r<m.parameters.length;r++)for(var s=m.parameters[r].token,x=0;x<p.config.parameters.length;x++)p.config.parameters[x].token===s&&(p.config.parameters[x].inputVariable=m.parameters[r].inputVariable);m=p.PACKAGE_NAME+"."+p.CLASS_NAME;k||(k=document.getElementById(m),
e.removeClass(k,"tests-failed"),e.removeClass(k,"tests-passed"),e.removeClass(k,"tests-notests"));k.setAttribute("library-node","true");k.innerHTML=g;r="";b.versionClassPath&&(r=b.prototype.PACKAGE_NAME.replace(b.versionClassPath+".",""),r=r.replace(/\._(\d)/g,".$1"),r="<span class='version-title'> ("+r+") </span>");k.children[0].children[1].innerHTML=p.config.name+r+"<a href='#-3' onclick='saveNewVersion(this, arguments[0]);'> clone </a>";e.addClass(k,"library");f&&e.addClass(k,f);k.reference=p;
k.libraryWidget=this;k.classReference=b;k.id=m;b=p.config.parameters;f=k.children[7].children[0];k=k.children[7].children[1];try{var a=e.getObjectUsingPath(p.PACKAGE_NAME+".local.Config");if(a&&a.parameters)for(var v=a.parameters,a=0;a<b.length;a++){var d=b[a];for(m=0;m<v.length;m++)if(d.token&&d.token===v[m].token){var n=b[a].inputVariable,c=b[a].uv;b[a]=v[m];n&&(b[a].inputVariable=n);c&&(b[a].uv=c);break}}}catch(h){}f.children[0].innerHTML=(p.config.imageUrl?"<img class='logo' src='"+p.config.imageUrl+
"' align='right' />":"")+p.config.description;(new ui.Parameters({parentContainer:k,params:b})).paint();addConfig(k,p.config);addPrePostTemplate(k,p);addTestsSuite(k,p)}})();qubit.VENDOR_SPACE_CP="";Utils=qubit.opentag.Utils;window.LIBRARIES={};
function renderAllLibrariesToPage(){var b=document.getElementById("libraries");b.innerHTML="";var g=[],e=qubit.vs;if(!e)try{e=qubit.vs}catch(l){}for(var k in e)if("PACKAGE_NAME"!==k&&"CLASSPATH"!==k){var f=e[k],m=prepareVendorNode(k),p;for(p in f)try{var r=f[p].Tag,s=[k,p].join(".");if(r){var x=new r({}),s=r.prototype.PACKAGE_NAME;x.unregister();x instanceof qubit.opentag.LibraryTag&&g.push([m,r,x])}for(var a=findTags(f[p]),v=0;v<a.length;v++){var d=new a[v]({});d.unregister();a[v].versionClassPath=
s;g.push([m,a[v],d])}}catch(n){window.console&&console.log?(console.log("Failed to load tag configuration, possible syntax error:"+n),info("Failed to load tag configuration, possible syntax error:"+n)):logError("Failed to load tag configuration, possible syntax error:"+n)}g.sort(function(a,b){var c=a[1],d=b[1],e=a[2].config,f=b[2].config;return e.name===f.name?(f=e="",c.versionClassPath&&(e=c.prototype.PACKAGE_NAME.replace(c.versionClassPath+".","")),d.versionClassPath&&(f=d.prototype.PACKAGE_NAME.replace(d.versionClassPath+
".","")),compareVersions(e,f)):e.name>f.name?1:e.name===f.name?0:-1});c+=g.length;b.appendChild(m)}var c=g.length,h=0;theProgressBar("Rendering...",function(){return h/c*100});var H=!1;(function(a){var b=0,c=function(){for(var d=0;8>d;d++){h++;if(b===a.length){H||setTimeout(bodyLoaded,200);H=!0;return}var e=a[b][1],f=new ui.Library({parentContainer:a[b][0],libraryClass:e});LIBRARIES[e.PACKAGE_NAME+"."+e.CLASS_NAME]=f;b++}setTimeout(c,4)};c()})(g)}var total=1,counted=0;
function loadAllLibs(b){GET(LIBRARIES_REPO_LOC+"shared/bin/html/scripts.txt",function(g){var e=[];g=g.split(",");g.push("shared/bin/html/js/build-location.js");total=1;counted=0;if(!b){b=[];for(var l=0;l<g.length;l++)g[l]&&-1==g[l].indexOf("shared/js/tagsdk-current.js")&&b.push(g[l])}theProgressBar("Loading scipts",function(){return 0===counted?0:counted/(b.length+total)*100});var k=0,f=function(){if(k!==b.length){var g=k;k++;var l=LIBRARIES_REPO_LOC+b[g];setTimeout(function(){_loadSingle(l,g,f,b,
e)},0)}};f()})}
function compareVersions(b,g){var e=b.replace(/\./g,".").split("."),l=g.replace(/\./g,".").split("."),k=null;if(e.length&&l.length){var f=e[0].replace(/[^\d+]/g,".").split("."),f=f[f.length-1],m=l[0].replace(/[^\d+]/g,".").split("."),m=m[m.length-1],p=e[0].substring(0,e[0].lastIndexOf(f)),r=l[0].substring(0,l[0].lastIndexOf(m));p!==r||isNaN(+f)||isNaN(+m)?e[0]>l[0]?k=!0:e[0]<l[0]&&(k=!1):+f<+m?k=!0:+f>+m&&(k=!1)}if(null===k)for(f=1;f<e.length&&f<l.length;f++)if(m=l[f],p=e[f],"0"!==p.charAt(0)&&"0"!==
m.charAt(0)||0===f||(p="0."+p,m="0."+m),!isNaN(+p)&&!isNaN(+m))if(+p<+m){k=!0;break}else{if(+p>+m){k=!1;break}}else if(p<m){k=!0;break}else if(p>m){k=!1;break}e.length!==l.length&&null===k&&(k=e.length<l.length);return!0===k?1:null===k?0:-1}function _loadSingle(b,g,e,l,k){GET(b,function(f,m){try{k[g]={expr:f,url:b},log(b),counted++,l.length===counted&&_allScriptsFetched(k)}finally{e&&e()}})}
function _allScriptsFetched(b){for(var g=0;g<b.length;g++)try{eval(b[g].expr)}catch(e){logError("Failed to load: "+b[g].url+"\nException: "+e)}theProgressBar.title+=", rendering... ";listScripts(b);setTimeout(function(){counted++;renderAllLibrariesToPage();window.toggleConsole();qubit.opentag.Log.LEVEL=3;qubit.opentag.Log.COLLECT_LEVEL=5},50)}
function keepRunningTests(){-1!==location.href.indexOf("runTests=true")&&(info("Running tests..."),runAllTests(function(){countdown("Automatically running tests... ",10);setTimeout(keepRunningTests,1E4)}))}function countdown(b,g,e){if(!(0>=g)){info(b+g+(e||""),1E3,"countdown");var l=g-1;setTimeout(function(){countdown(b,l)},1E3)}}function listScripts(b){}function bodyLoaded(){setTimeout(keepRunningTests,1E3)}
window.Main=function(){window.qlog=new qconsole;window.toggleConsole=function(){qlog.hidden?qlog.show():qlog.hide()};window.logError=function(b,g){log("<span style='color: red'>"+b+"</span>");info("<span style='color: #FF766F'>"+b+"</span>",g||5E3)};window.info=function(b,g,e){DefaultNotificationsMgr.notify(e||(new Date).valueOf(),b,g||2800,"",!0);log(b)};window.log=function(b){qlog.log(b)};Suite.log=Test.log=function(b){log(b)};loadAllLibs();window.DefaultNotificationsMgr=new NotificationManager({maxTime:4E3})};
