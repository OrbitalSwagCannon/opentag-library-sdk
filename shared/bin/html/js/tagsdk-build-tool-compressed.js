(function(){Function.prototype.bind=Function.prototype.bind||function(b){var k=this;return function(){return k.apply(b,arguments)}}})();var global=this;try{global=(0,eval)("this")||function(){return this}()||window}catch(e$$12){}global.VERSION="1.0.2-b1";var EMPTY_FUN=function(){},UNDEF=void 0;global.APP_PATH=global.APP_PATH||"/";global.LIBRARIES_REPO_LOC=global.LIBRARIES_REPO_LOC||"/";
(function(){var b,k;(function(){Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),e=this,h=function(){},c=function(){return e.apply(this instanceof h?this:a,b.concat(Array.prototype.slice.call(arguments)))};h.prototype=this.prototype;c.prototype=new h;return c})})();var f={__anonymous__:!0},m=null;try{m=(0,eval)("this")||
function(){return this}()}catch(l){}var f=m,g=f.qubit||{};f.qubit||(f.qubit=g);if(g.VERSION&&"3.0.2-r9"!==g.VERSION)try{console.warn("There is already 'qubit.VERSION' set to: "+g.VERSION)}catch(n){}g.VERSION="3.0.2-r9";try{module.exports=f}catch(q){}var r=function(){};(function(){function a(){}function b(c,d,h,e,g){c=c.split(".");var y=a.NAMESPACE_BASE||f,k=null,l=null;g&&(y=m);g=y;y=h||y;for(h=0;h<c.length-1;h+=1)l=c[h],y[l]=y[l]||{},y=y[l];k=y;l=c[c.length-1];m.TAGSDK_NS_OVERRIDE&&(e=!1);void 0!==
d?void 0!==k[l]&&e||(k[l]=d):k[l]=k[l]||{};d&&(d.CLASSPATH=c.join("."),c.splice(c.length-1,1),d.PACKAGE_NAME=c.join("."));return{root:g,object:k,instance:k[l]}}a.global=function(){return m};a.STANDARD_CS_NS="qubit.cs";a.clientSpaceClasspath=function(){return window.qubit.CLIENT_CONFIG?"qubit.cs.d"+window.qubit.CLIENT_CONFIG.id:a.STANDARD_CS_NS};a.globalNamespace=function(a,d,h,e){return b(a,d,h,e,!0)};a.namespace=function(a,d,h,e){return b(a,d,h,e,!1)};a.clientNamespace=function(c,d,h,e){return a.namespace(a.clientSpaceClasspath()+
"."+c,d,h,e)};a.clazz=function(c,d,h,e,b){a.namespace(c,d,e,!0);"function"===typeof h&&(d.SUPER=h,d.superclass=h,d.prototype=new h(b),d.prototype.SUPER=h,d.prototype.CLASS=d);c=c.split(".");d.prototype?(d.prototype.CLASSPATH=c.join("."),d.prototype.CLASS_NAME=c[c.length-1],c.splice(c.length-1,1),d.prototype.PACKAGE_NAME=c.join(".")):(d.CLASSPATH=c.join("."),d.STATIC_NAME=c[c.length-1],c.splice(c.length-1,1),d.PACKAGE_NAME=c.join("."));return d};a.clazz("qubit.Define",a);a.clientClazz=function(c,d,
h,e,b){return a.clazz(a.clientSpaceClasspath()+"."+c,d,h,e,b)};a.STANDARD_VS_NS="qubit.vs";a.vendorsSpaceClasspath=function(c){var d=g.VENDOR_SPACE_CP,d=void 0===d||null===d?a.STANDARD_VS_NS:d;return c?d?d+"."+c:c:d};var e=a.vendorsSpaceClasspath(),h;h=e?a.namespace(e,{},null,!0).instance:a.global();a.getVendorSpace=function(){return h};a.vendorNamespace=function(c,d,h,e){c=a.vendorsSpaceClasspath(c);return a.namespace(c,d,h,e)};a.vendorClazz=function(c,d,h,e,b){c=a.vendorsSpaceClasspath(c);return a.clazz(c,
d,h,e,b)}})();(function(){function a(a){}for(var b={},e=0;93>e;e++)b["abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ*!-#$&+()@'%./:<>?[\"]^_`{|}~\\;=".charAt(e)]=e;g.Define.clazz("qubit.Cookie",a);a.cookieAlphabet="abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ*!-#$&+()@'%./:<>?[\"]^_`{|}~\\;=";a.cookieAlphabetMap=b;a.decode=function(a){return unescape(a)};a.encode=function(a){return escape(a)};a.set=function(h,c,d,e,b){if(d){var f=new Date;f.setTime(f.getTime()+864E5*
d);d="; expires="+f.toGMTString()}else d="";b||(h=a.encode(h),c=a.encode(c));h=h+"="+c+d+"; path=/;";e&&(h+=" domain="+e);document.cookie=h};a.get=function(h,c){for(var d=h+"=",e=document.cookie.split(";"),b=0;b<e.length;b++){for(var f=e[b];" "===f.charAt(0);)f=f.substring(1,f.length);if(0===f.indexOf(d))return d=f.substring(d.length,f.length),c||(d=a.decode(d)),d}return null};a.getAllForName=function(e,c){if(!e)return[];for(var d=e+"=",b=document.cookie.split(";"),p=[],f=0;f<b.length;f++){for(var g=
b[f];" "===g.charAt(0);)g=g.substring(1,g.length);0===g.indexOf(d)&&(g=g.substring(d.length,g.length),c&&(g=a.decode(g)),p.push(g))}return p};a.getAll=function(e){for(var c=document.cookie.split(";"),d=[],b=0;b<c.length;b++){for(var p=c[b];" "===p.charAt(0);)p=p.substring(1,p.length);var f=p.substring(0,p.indexOf("=")),p=p.substring(f.length+1,p.length);e&&(p=a.decode(p));d.push([f,p])}return d};a.rm=function(e,c){a.set(e,"",-1,c)}})();(function(){function a(a,c){for(var d=p.length,e=0;e<d;e++)if(a===
p[e][0])return p[e][1];p[p.length]=[a,c];return!1}function b(s,c,d,e,h){var v=!1,g=!1,k=!1,E=!1,u=!1,m=u=!1;c&&(v=(u=!!c.all)||c.nodes,E=u||c.win,g=u,m=!!c.emptyForMaxDeep,k=c.noFunctions&&!u,void 0!==c.noOwn&&(g=!!c.noOwn),void 0!==c.noFunctions&&(k=!!c.noFunctions),void 0!==c.win&&(E=!!c.win),void 0!==c.nodes&&(v=!!c.nodes),u=!!c.copyReference);if(void 0===d||d)void 0!==d&&d--;else return m?void 0:s;if(!(s&&s instanceof Object))return s;if(!v){try{if(s instanceof Node)return s}catch(l){if(s instanceof
ActiveXObject&&void 0!==s.nodeType)return s}if(s===document)return s}if(!E&&s===f)return s;v=s instanceof Array?[]:{};s instanceof Date&&(v=new Date(s));!k&&s instanceof Function&&(k=String(s).replace(/\s+/g,""),v=k.indexOf("{[nativecode]}")+14===k.length?function(){return s.apply(h||this,arguments)}:function(){return s.apply(this,arguments)});void 0===e&&(p=[],e=0);if(k=a(s,v))return k;if(v instanceof Array)for(k=0;k<s.length;k++)v[v.length]=s[k]===s[k]?b(s[k],c,d,e+1,s):s[k];else{var k=0,B;for(B in s){if(g||
s.hasOwnProperty(B))v[B]=s[B]===s[B]?b(s[B],c,d,e+1,s):s[B];k++}}c.proto&&(v.prototype=b(s.prototype,c,d,e+1,s));u&&(v.___copy_ref=s);return v}function e(a,c,d,h,b,v,p,g){d=d||{};void 0===d.hasOwn&&(d.hasOwn=!0);if(!d.objectsOnly||a instanceof Object)if(void 0===g||g){void 0!==g&&g--;if(!d||!d.nodes)try{if(a instanceof Node)return}catch(y){if(a instanceof ActiveXObject&&void 0!==a.nodeType)return}if(a!==f){void 0===h&&(k=[],h=0);var u;a:{for(u=0;u<h&&u<k.length;u++)if(a===k[u]){u=!0;break a}u=!1}if(!(u||
(k[h]=a,b=b||a,b&&v&&b[v]!==b[v]||c(a,b,v,p)))){v=0;u="";for(var m in a){if(!d.hasOwn||a.hasOwnProperty(m))try{var l=a[m];d.track&&(u=p?p+"."+m:m);e(l,c,d,h+1,b,m,u,g)}catch(B){}v++}}}}}var h=g.Define,c=g.Cookie,d=function(){},f=h.global();h.clazz("qubit.opentag.Utils",d);d.global=h.global;d.namespace=h.namespace;d.clazz=h.clazz;d.getObjectUsingPath=function(a,c){c=c||f;for(var d=a.split("."),e=0;e<d.length;e++)c&&d[e]&&(c=c[d[e]]);return c};d.getParentObject=function(a){var c=a.lastIndexOf(".");
a=a.substring(0,c);return d.getObjectUsingPath(a)};d.variableExists=function(a){return void 0!==a&&null!==a};d.ANON_VARS=[];d.getAnonymousAcessor=function(a){var c=d.indexInArray(a,d.ANON_VARS);-1===c&&(c=d.addToArrayIfNotExist(d.ANON_VARS,a));return"qubit.opentag.Utils.ANON_VARS["+c+"]"};d.replaceAll=function(a,c,d){return a.replace(new RegExp(c.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1"),"g"),d)};d.secureText=function(a){"string"!==typeof a&&(a+="");a=a.replace(/</g,"&lt;");return a=a.replace(/>/g,
"&gt;")};d.getUrl=function(){return document.location.href};d.getQueryParam=function(a){var c,e,h,b;c=d.getUrl();if(0<c.indexOf("?"))for(b=c.substring(c.indexOf("?")+1).split("&"),c=0,e=b.length;c<e;c+=1)if(h=b[c],0<h.indexOf("=")&&(h=h.split("="),2===h.length&&h[0]===a))return h[1];return null};d.getElementValue=function(a){return(a=document.getElementById(a))?a.textContent||a.innerText:null};var p=[];d.objectCopy=function(a,c){c=c||{};var d=b(a,c,c.maxDeep);p=[];return d};var k=[];d.traverse=function(a,
c,d){e(a,c,d,void 0,void 0,void 0,void 0,d.maxDeep)};d.prepareQuotedString=function(a){return"string"===typeof a?'"'+a.replace(/\"/g,'\\"')+'"':a};d.expressionToFunction=function(a,c){return d.gevalAndReturn("function ("+(c||"")+") {"+a+"}").result};d.defineWrappedClass=function(a,c,d,e,b){var v=function(){return b?b.apply(this,arguments):c.apply(this,arguments)};h.clazz(a,v,c,e);for(var p in d)d.hasOwnProperty(p)&&"CONSTRUCTOR"!==p&&(v.prototype[p]=d[p]);return v};d.copyAandAddFromB=function(a,c,
d){a=this.objectCopy(a,{maxDeep:d||8});for(var e in c)c.hasOwnProperty(e)&&(a[e]=c[e]);return a};d.keys=function(a){if(a instanceof Object){if(Object.keys)return Object.keys(a);var c=[],d;for(d in a)a.hasOwnProperty(d)&&(c[c.length]=d);return c}throw"keys() called on non-object!";};d.getSrcElement=function(a){var c;a=a||window.event;a.srcElement?c=a.srcElement:a.target&&(c=a.target);return c};d.addToArrayIfNotExist=function(a,c,d){for(var e=0,h=!1;e<a.length;e+=1)if(d&&d(a[e],c)||a[e]===c){h=!0;break}h||
(a[a.length]=c,e=-1);return e};d.indexInArray=function(a,c){for(var d=0,e=!1;d<a.length;d++)if(a[d]===c){e=!0;break}return e?d:-1};d.removeFromArray=function(a,c){for(var d=0,e=0;d<a.length;d+=1)a[d]===c&&(a.splice(d,1),e++);return e};d.addClass=function(a,c){var e;try{a.classList.add(c)}catch(h){null===a.className?a.className=c:(e=a.className.split(" "),d.addToArrayIfNotExist(e,c),a.className=e.join(" "))}};d.removeClass=function(a,c){var e;try{a.classList.remove(c)}catch(h){null===a.className?a.className=
"":(e=a.className.split(" "),d.removeFromArray(e,c),a.className=e.join(" "))}};d.gevalAndReturn=function(a){var c=m;c.qubitopentagutilsgevalandreturn__var_test__=void 0;c.qubitopentagutilsgevalandreturn__var_test__error=void 0;d.geval("try{this.qubitopentagutilsgevalandreturn__var_test__=("+a+");}catch(ex){this.qubitopentagutilsgevalandreturn__var_test__error = ex;}");a=c.qubitopentagutilsgevalandreturn__var_test__;var e=c.qubitopentagutilsgevalandreturn__var_test__error;try{c.qubitopentagutilsgevalandreturn__var_test__=
void 0,c.qubitopentagutilsgevalandreturn__var_test__error=void 0,delete c.qubitopentagutilsgevalandreturn__var_test__,delete c.qubitopentagutilsgevalandreturn__var_test__error}catch(h){}return{result:a,error:e}};d.trim=function(a){try{return String(a).trim()}catch(c){return String(a).replace(/^\s+|\s+$/g,"")}};d.setIfUnset=function(a,c){if(a&&c)for(var d in c)c.hasOwnProperty(d)&&!a.hasOwnProperty(d)&&(a[d]=c[d])};d.overrideFromBtoA=function(a,c){if(a&&c)for(var d in c)c.hasOwnProperty(d)&&(a[d]=
c[d]);return a};d.geval=function(a){return window&&window.execScript?window.execScript(""===a?" ":a):f.eval.call(f,a)};var u=[];d.bodyAvailable=function(a){if(document.body){if(u){for(var c=0;c<u.length;c++)try{u[c]()}catch(d){}u=!1}a()}else u.push(a)};d.rmCookiesMatching=function(a){for(var d=c.getAll(),e=0;e<d.length;e++){var h=d[e][0];0===h.match(a)&&c.rm(h)}};var l=[],C=!1,n=!1;d.bodyReady=function(a){if(n)return a&&a(),!0;if(C=C||!(!document.body||"complete"!==document.readyState)){n=!0;for(var c=
0;c<l.length;c++)try{l[c]()}catch(d){}a&&a()}else a&&l.push(a);return C};var v=f.onload;f.onload=function(a){try{d.bodyReady()}catch(c){try{window.qubit.opentag.Utils.bodyReady()}catch(e){}}var h=!1;try{h=v}catch(b){}h&&h(a)};(function(){var a,c=!1,e=1,h,b,v,p;b=function(a){!0===a&&(e-=1);if(!e||!0!==a&&!c){if(!document.body)return setTimeout(b,1);c=!0;if(!0!==a&&(e-=1,0<e))return;for(;0<h.length;)a=h.shift(),a()}};p=function(){if(!c){try{document.documentElement.doScroll("left")}catch(a){setTimeout(p,
1);return}b()}};v=function(){if(!h){h=[];if("complete"===document.readyState)return setTimeout(b,1);if(document.addEventListener)document.addEventListener("DOMContentLoaded",a,!1),window.addEventListener("load",b,!1);else if(document.attachEvent){document.attachEvent("onreadystatechange",a);window.attachEvent("onload",b);var c=!1;try{c=null===window.frameElement||void 0===window.frameElement}catch(d){}document.documentElement.doScroll&&c&&p()}}};document.addEventListener?a=function(){document.removeEventListener("DOMContentLoaded",
a,!1);b()}:document.attachEvent&&(a=function(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",a),b())});(function(a){v();c?setTimeout(a,1):h.push(a)})(function(){C=!0;d.bodyReady()})})()})();(function(){function a(a){a&&(this._rate=a.rate||10,this._smallestRate=-1,a.start&&this.startPooling(),this.config=a);this.inervals=[];this._lck_obj={};this._binded_pool=this._pool.bind(this)}g.Define.clazz("qubit.opentag.Timer",a);a.prototype.timers=[];a.prototype.startPooling=function(a){a&&
this.config.dynamic&&(0>this._smallestRate||this._smallestRate>a)&&(this._smallestRate=Math.min(Math.floor(a/2),1500));this.started||(this.started=!0,setTimeout(this._binded_pool,0))};a.prototype._pool=function(){this.maxFrequent(function(){},5E3,this._lck_obj);this.callTimers();0!==this.timers.length?setTimeout(this._binded_pool,this._smallestRate>this._rate?this._smallestRate:this._rate):(this.started=!1,this._smallestRate=-1)};a.prototype.callTimers=function(){this.lastCalled=(new Date).valueOf();
for(var a=0;a<this.timers.length;a++){var h=this.timers[a];if((new Date).valueOf()>=h.time){try{h.execute()}catch(c){}this.timers.splice(a,1);--a}}};a.prototype.cancellAll=function(){this.timers=[]};a.prototype.setRate=function(a){this._rate=a};a.prototype.maxFrequent=function(a,h,c){c||(a.__maxFrequent__timer_opentag_qubit_=a.__maxFrequent__timer_opentag_qubit_||{},c=a.__maxFrequent__timer_opentag_qubit_);var d=c.____last__timed__max__frequent____;if(!d||(new Date).valueOf()-d>h)d=(new Date).valueOf(),
c.____last__timed__max__frequent____=d,a()};a.prototype.runIfNotScheduled=function(a,h,c){c=c||a;if(c.__lastRun__&&(new Date).valueOf()<h+c.__lastRun__)return this.schedule(a,h,c);c.__lastRun__=(new Date).valueOf();a();return!0};a.prototype.schedule=function(a,h,c){if(c.___scheduled___)return!1;c.___scheduled___=(new Date).valueOf();this.setTimeout(function(){c.___scheduled___=!1;c.__lastRun__=(new Date).valueOf();a()},h);return!0};var b=1;a.prototype.setTimeout=function(a,h){var c={id:b++,time:(new Date).valueOf()+
+h,execute:a};this.timers.push(c);this.startPooling(h);return c};a.prototype.setInterval=function(a,h){var c=setInterval(a,h);this.inervals.push(c);return c}})();(function(){g.Define.namespace("qubit.opentag.Timed",new g.opentag.Timer({rate:37,dynamic:!0}));var a=g.opentag.Timed;a.tillTrue=function(b,e,h){var c=function(){b()?e():a.setTimeout(c,h||33)};c()}})();var t;t=t||{};t.fileLoader={};t.fileLoader.load=function(a,b,e,h,c,d){var f,p,g,k;k=!1;g=function(c){return function(){k||(k=!0,c&&!p&&(p=
{url:document.location.href}),e(a,p,c))}};try{b&&(f=b(a))}catch(m){f=!1,e(a,"Exception loading pre",!0)}finally{!1!==f&&(b=t.fileLoader.createScriptEl(a,c,!1,d),e&&(b.onload=g(!1),b.onerror=g(!0),b.onreadystatechange=function(){"complete"!==this.readyState&&"loaded"!==this.readyState||setTimeout(function(){g(!1)()},1)}),h||(h=window.document.getElementsByTagName("head")[0]),h.appendChild(b))}};t.fileLoader.createScriptEl=function(a,b,e,h){var c,d=document.createElement("script");d.type="text/javascript";
d.src=t.fileLoader.tidyUrl(a)+(e?"?"+(new Date).getTime():"");!1!==b?(d.async="true",d.defer="true"):(d.async="false",!1!==d.async&&(d.async=!1),d.defer="false",!1!==d.defer&&(d.defer=!1));for(c in h)h.hasOwnProperty(c)&&d.setAttribute(c,h[c]);return d};t.fileLoader.tidyUrl=function(a){return"http:"===a.substring(0,5)||"https:"===a.substring(0,6)?a:"//"+a};(function(){function a(a){this.config={order:0,include:!0,name:"Filter-"+e++,script:void 0,session:void 0};this.session=null;if(a){for(var d in a)a.hasOwnProperty(d)&&
(this.config[d]=a[d]);a.session&&this.setSession(a.session);this.register(this)}}var b=g.opentag.Utils,e=0,h=[];g.Define.clazz("qubit.opentag.filter.BaseFilter",a);a.state={DISABLED:-3,SESSION:-2,PASS:-1,FAIL:0};a.prototype.reset=function(){this.enable()};a.prototype.disable=function(){this.config.disabled=!0};a.prototype.enable=function(){this.config.disabled=!1};a.prototype.match=function(){return!0};a.prototype.setSession=function(a){this.session=a};a.prototype.getSession=function(){return this.session};
a.prototype.getState=function(){var c=a.state.PASS;if(this.config.disabled)return a.state.DISABLED;this.config.script&&(c=this.config.script.call(this,c));isNaN(+c)&&(c=a.state.FAIL);this.lastState=+c;return c};a.getFilters=function(){return h};a.prototype.register=function(){a.register(this)};a.register=function(a){b.addToArrayIfNotExist(h,a)}})();g.Define.namespace("qubit.opentag.filter.pattern.PatternType",{CONTAINS:"CONTAINS",MATCHES_EXACTLY:"MATCHES_EXACTLY",STARTS_WITH:"STARTS_WITH",ENDS_WITH:"ENDS_WITH",
REGULAR_EXPRESSION:"REGULAR_EXPRESSION",ALL_URLS:"ALL_URLS"});(function(){function a(h){this._lockObject={};var c={patternType:e.CONTAINS,pattern:""};if(h)for(var d in h)h.hasOwnProperty(d)&&(c[d]=h[d]);a.SUPER.call(this,c)}var b=g.opentag.Utils,e=g.opentag.filter.pattern.PatternType;g.Define.clazz("qubit.opentag.filter.URLFilter",a,g.opentag.filter.BaseFilter);a.prototype.PATTERNS=e;a.prototype.getURL=function(a){return a||b.getUrl()};a.prototype.match=function(a){a=this.getURL(a);var c=!0,d=this.config.pattern;
switch(this.config.patternType){case e.CONTAINS:c=0<=a.toLowerCase().indexOf(d.toLowerCase());break;case e.MATCHES_EXACTLY:c=a.toLowerCase()===this.config.pattern.toLowerCase();break;case e.STARTS_WITH:c=0===a.toLowerCase().indexOf(d.toLowerCase());break;case e.ENDS_WITH:c=a.lastIndexOf(d.toLowerCase())+d.length===a.length;break;case e.REGULAR_EXPRESSION:c=(new RegExp(d)).test(a);break;case e.ALL_URLS:c=!0}return c}})();(function(){function a(c){var d={};if(c){for(var e in c)c.hasOwnProperty(e)&&
("customStarter"===e&&c[e]?this.customStarter=c[e]:"customScript"===e&&c[e]&&(this.customScript=c[e]),d[e]=c[e]);this.uid="f"+h++}this.tagsToRun=[];a.SUPER.call(this,d)}var b=g.opentag.filter.BaseFilter,e=g.opentag.Utils,h=0;g.Define.clazz("qubit.opentag.filter.Filter",a,g.opentag.filter.URLFilter);a.prototype.customStarter=function(a,d,e){d(!1)};a.prototype.isSession=function(){return this.config.sessionDisabled||null===this.customStarter&&null===this.customScript?!1:!0};a.prototype.customScript=
function(a){return!0};a.prototype.match=function(c){var d=!0;try{this.customScript&&(void 0===this._matchState&&(this._matchState=!!this.customScript(this.getSession())),d=this._matchState)}catch(e){d=!1}return d&&a.SUPER.prototype.match.call(this,c)};a.prototype.runTag=function(c){e.addToArrayIfNotExist(this.tagsToRun,c);if(this.starterExecuted)!0===this.reRun?c.run():c.runOnce();else if(!this._starterWasRun){this._starterWasRun=!0;var d=function(a){this.reRun=a;this.starterExecuted=(new Date).valueOf();
this._processQueuedTagsToRun()}.bind(this);this.customStarter?this.customStarter(this.getSession(),d,c):a.prototype.customStarter(this.getSession(),d,c)}};a.prototype._processQueuedTagsToRun=function(){for(var a=0;a<this.tagsToRun.length;a++){var d=this.tagsToRun[a];!0===this.reRun?d.run():d.runOnce()}};a.prototype.getState=function(c){c&&this.setSession(c);c=a.SUPER.prototype.getState.call(this);if(c===b.state.DISABLED)return b.state.DISABLED;c===b.state.PASS&&this.isSession()&&(c=b.state.SESSION);
this.config.script&&(c=this.config.script.call(this,c,this.getSession()));return this.lastState=c};a.prototype.reset=function(){this._matchState=void 0;a.SUPER.prototype.reset.call(this);this.starterExecuted=this._starterWasRun=void 0;this.tagsToRun=[];this.reRun=void 0}})();t.GlobalEval={};t.GlobalEval.globalEval=function(a){window.execScript?window.execScript(""===a?" ":a):window.eval.call(window,a)};t.HtmlInjector={};t.HtmlInjector.inject=function(a,b,e,h,c){var d,f,p,g;if(0<=e.toLowerCase().indexOf("<script")){c=
document.createElement("div");c.innerHTML="a"+e;f=c.getElementsByTagName("script");p=[];e=0;for(d=f.length;e<d;e+=1)p.push(f[e]);g=[];e=0;for(d=p.length;e<d;e+=1){f=p[e];var k={attributes:t.HtmlInjector.getAttributes(f)};f.src?k.src=f.src:k.script=f.innerHTML;g.push(k);f.parentNode.removeChild(f)}c.innerHTML&&0<c.innerHTML.length&&(c.innerHTML=c.innerHTML.substring(1));t.HtmlInjector.doInject(a,b,c);t.HtmlInjector.loadScripts(g,0,h,a)}else c=document.createElement("div"),c.innerHTML=e,t.HtmlInjector.doInject(a,
b,c),h&&h()};t.HtmlInjector.doInject=function(a,b,e){if(0<e.childNodes.length){for(var h=document.createDocumentFragment();0<e.childNodes.length;)h.appendChild(e.removeChild(e.childNodes[0]));b?t.HtmlInjector.injectAtStart(a,h):t.HtmlInjector.injectAtEnd(a,h)}};t.HtmlInjector.injectAtStart=function(a,b){0===a.childNodes.length?a.appendChild(b):a.insertBefore(b,a.childNodes[0])};t.HtmlInjector.injectAtEnd=function(a,b,e){e||(e=1);a===document.body&&"complete"!==document.readyState&&50>e?setTimeout(function(){t.HtmlInjector.injectAtEnd(a,
b,e+1)},100):a.appendChild(b)};t.HtmlInjector.loadScripts=function(a,b,e,h){var c,d,f=!1;for(c=a.length;b<c;b+=1)if(d=a[b],d.src){f=!0;break}else t.GlobalEval.globalEval(d.script);f&&t.fileLoader.load(d.src,null,function(){t.HtmlInjector.loadScripts(a,b+1,e,h)},h,!1,d.attributes);e&&b===c&&e()};t.HtmlInjector.getAttributes=function(a){var b,e,h,c,d={};if(a){e=a.attributes;b=e.length;for(a=0;a<b;a++)h=e[a].value,c=e[a].name.toLowerCase(),""===h||"id"!==c&&"class"!==c&&"charset"!==c&&"data-"!==c.substr(0,
5)||(d[c]=h);return d}};(function(){function a(){l=l||{write:document.write,writeln:document.writeln}}function b(){document.write=l.write;document.writeln=l.writeln;l=null}var e=g.opentag.filter.BaseFilter,h=g.opentag.Utils,c=t.HtmlInjector,d=t.fileLoader,f=g.opentag.filter.Filter,p=function(){};g.Define.clazz("qubit.opentag.TagsUtils",p);var k=!1;p.bodyLoaded=function(){return k?!0:k=!(!document.body||"loading"===document.readyState)};p.bodyAvailable=function(a){return!!document.body};var u={};p.loadScript=
function(a){var c=a.url,e=function(d,e,b){u[c].error=e;b?(u[c].state="failure",a.onerror()):(u[c].state="success",a.onsuccess())};if(u[c]){if(a.noMultipleLoad)return e(c,u[c].error,"failure"===u[c].state);u[c].count+=1}else u[c]={count:1,state:null};var b=!a.async,h=p.bodyLoaded();b&&!h?p.writeScriptURL(c,function(a,d){e(c,d,!a)}):d.load(c,!1,e,a.node,a.async)};var l=null;p.redirectDocumentWritesToArray=function(c,d){a();document.write=function(a){c.push(a)};document.writeln=function(a){c.push(a)}};
p.flushDocWritesArray=function(a,c,d,e,b){if(c&&a){a=a.splice(0,a.length);try{return p.injectHTML(c,d,a.join("\n"),b||r),!0}catch(h){}}else return!1;b&&b();return!0};p.unlockDocumentWrites=function(){l&&b()};var C=p.prototype.PACKAGE_NAME+".TagsUtils._writeScriptURL_callbacks",n={};g.Define.namespace(C,n,m,!0);var v=0,s=(new Date).valueOf();p.writeScriptURL=function(c,e){var f="_"+s+"_"+v++,z=C+"."+f,g=!1;n[f]=function(a){g||(g=!0,a?e(!1,"error while loading script "+c):e(!0),n[f]=void 0,delete p.writeScriptURL.callbacks[f])};
var k='if(this.readyState === "loaded" || this.readyState === "complete"){ try {'+z+"(true)} catch (ex) {}}",u="try{"+z+"(false)}catch(ex){}",z="try{"+z+"(true)}catch(ex){}";c=d.tidyUrl(c);k="<script onload='"+u+"'  onerror='"+z+"' onreadystatechange='"+k+"' type='text/javascript'  src='"+c+"'>\x3c/script>";l?(b(),document.write(k),a()):document.write(k);h.bodyReady(function(){g||(g=!0,e(!0))})};p.writeScriptURL.callbacks={};var z=e.state.SESSION,A=e.state.PASS,w=e.state.FAIL;p.filtersState=function(a,
c,d,b){a=a.sort(function(a,c){try{var d=c.config.order,b=a.config.order;isNaN(-b)&&(b=0);isNaN(-d)&&(d=0);return d-b}catch(e){return 0}});var h=A;if(!a||0===a.length)return h;for(var h=null,s=!1,v=!1,p=0,g,k,u=[],m,E,l=0;l<a.length;l++)if(m=a[l],m.setSession(c),m.match())if(g=m.getState(),0<g){if(0===p||p>g)p=g}else g===e.state.DISABLED?s=!0:g===z?(v=!0,k=h=m,u.push(m)):h=m;else E=m;a=!1;null===h?(a=!0,h=s?A:w):h=h.config.include?g:g===A?w:A;0<p&&(h===A||a)&&(h=p);if(h===z||h===A&&v){if(!k.config.include)return w;
h=z;if(k instanceof f&&k.isSession()&&b)for(b=0;b<u.length;b++)try{u[b].runTag(d)}catch(y){}}d.config.dedupe&&h===A&&E&&E instanceof f&&E.isSession()&&(d.sendDedupePing=!0,h=w);return h};p.injectHTML=function(a,d,b,e){return c.inject(a,d?0:1,b,e||r)};p.getHTMLLocationForTag=function(a){a=a.prepareLocationObject(a.config.locationObject);switch(a){case "HEAD":a=document.getElementsByTagName("head")[0];break;case "BODY":a=document.body;break;default:a=a?document.getElementById(a):document.body}return a}})();
(function(){function a(b){this.config={};this.parameters=null;if(b){this.uniqueId="BV"+e++;a.ALL_VARIABLES[this.uniqueId]=this;for(var c in b)this.config[c]=b[c];void 0!==b.value&&(this.value=b.value);void 0!==b.defaultValue&&(this.defaultValue=b.defaultValue);return a.register(this)}}var b=g.opentag.Utils,e=0;g.Define.clazz("qubit.opentag.pagevariable.BaseVariable",a);a.ALL_VARIABLES={};a.pageVariables=[];a.register=function(b){if(b instanceof a){for(var c=0;c<a.pageVariables.length;c++){var d=a.pageVariables[c];
if(b===d)return d}a.pageVariables.push(b);return b}return null};a.prototype.getValue=function(){return this.value};a.prototype.setValue=function(a){this.value=a};a.prototype.getDefaultValue=function(){return this.defaultValue};a.prototype.setDefaultValue=function(a){this.defaultValue=a};a.prototype.exists=function(a){var c=b.variableExists(this.getValue());a&&(c=c||b.variableExists(this.getDefaultValue()));return c};a.prototype.getRelativeValue=function(a,c){var d=this.getValue();b.variableExists(d)||
(d=c);var e;a&&!b.variableExists(d)&&(e=this.getDefaultValue(),b.variableExists(e)&&(d=e));return d};a.prototype.replaceToken=function(a,c,d,e){var f=this.exists();d=f?this.getValue():d;a="\\$\\{"+a+"\\}";return e||d instanceof Array?(e=f?this.getValueAccessorString():b.getAnonymousAcessor(d),c.replace(new RegExp(a,"g"),e)):c.replace(new RegExp(a,"g"),d)};a.prototype.getAccessorString=function(){return"qubit.opentag.pagevariable.BaseVariable.ALL_VARIABLES."+this.uniqueId};a.prototype.getValueAccessorString=
function(){return this.getAccessorString()+".getValue()"}})();(function(){function a(b){this._lockExprObject={};a.SUPER.apply(this,arguments)}var b=g.opentag.Utils;g.Define.clazz("qubit.opentag.pagevariable.Expression",a,g.opentag.pagevariable.BaseVariable);a.prototype.getValue=function(){var e,h;try{if(-1===this.value.indexOf("[#]")){var c=b.gevalAndReturn(this.value);e=c.result;this.failMessage=null;h=c.error}else e=a.parseUVArray(this.value)}catch(d){h=d}h&&(e="could not read value of expression: \n"+
this.value+"\nexact cause: "+h,this.failMessage!==e&&(this.failMessage=e),e=null);return e};a.parseUVArray=function(a){var h=a.split("[#]");a=b.gevalAndReturn(h[0]).result;var c=[],h=h[1];0===h.indexOf(".")&&(h=h.replace(".",""));for(var d=0;d<a.length;d++){var f=b.getObjectUsingPath(h,a[d]);c.push(f)}return c};a.prototype.replaceToken=function(b,h,c,d){this.getValue()instanceof Array&&(d=!0);return a.SUPER.prototype.replaceToken.call(this,b,h,c,d)}})();(function(){function a(b){a.SUPER.apply(this,
arguments)}var b=g.opentag.Utils;g.Define.clazz("qubit.opentag.pagevariable.DOMText",a,g.opentag.pagevariable.BaseVariable);a.prototype.getValue=function(){return b.getElementValue(this.value)}})();(function(){function a(b){a.SUPER.apply(this,arguments);this._lockObject={}}var b=g.opentag.Timed;g.Define.clazz("qubit.opentag.pagevariable.Cookie",a,g.opentag.pagevariable.BaseVariable);a.prototype.getValue=function(){var a=g.Cookie.get(this.value);b.maxFrequent(function(){}.bind(this),2E3,this._lockObject);
return a}})();(function(){function a(b){a.SUPER.apply(this,arguments)}var b=g.opentag.Utils;g.Define.clazz("qubit.opentag.pagevariable.URLQuery",a,g.opentag.pagevariable.BaseVariable);a.prototype.getValue=function(){return b.getQueryParam(this.value)}})();(function(){function a(){}function b(a,c){var d=[];try{var e=a.parameters;if(e)for(var h=0;h<e.length;h++)a.getVariableForParameter(e[h])===c&&d.push(e[h])}catch(s){}return d}var e=g.opentag.Utils,h=g.opentag.TagsUtils,c=g.opentag.pagevariable.BaseVariable,
d=g.opentag.pagevariable.Expression,f=g.opentag.pagevariable.DOMText,p=g.opentag.pagevariable.Cookie,k=g.opentag.pagevariable.URLQuery;g.Define.clazz("qubit.opentag.TagHelper",a);a.injectHTMLForLoader=function(a,c,d,b){if(b=void 0!==b?b:a.getHtml()){var e="END"===a.config.locationPlaceHolder,s=h.getHTMLLocationForTag(a);a.injectHTMLNotFinished=!0;try{s?h.injectHTML(s,e,b,function(){a.injectHTMLNotFinished=!1;if(c)try{c()}catch(d){}}.bind(a)):d&&"loading"===document.readyState?(document.write(b),a.injectHTMLNotFinished=
!1):a.injectHTMLFailed=(new Date).valueOf()}catch(f){a.injectHTMLNotFinished=!1,a.injectHTMLFailed=(new Date).valueOf()}}};a.getAllVariablesWithParameters=function(a){for(var c=a.getPageVariables(),d=[],e=0;e<c.length;e++)for(var h=c[e],s=b(a,h),f=0;f<s.length;f++)d.push({parameter:s[f],variable:h});return d};a.allParameterVariablesReadyForTag=function(a,c){for(var d=!0,e=a.getPageVariables(),h=0;h<e.length;h++){var s=e[h];try{var f=b(a,s),p=s.exists();!p&&c&&(0<f.length&&(p=!!f[0].defaultValue),
p=p||s.exists(!0));if(!p){d=!1;break}}catch(g){d=!1;break}}return d};a.validateAndGetVariableForParameter=function(c){c.hasOwnProperty("variable")&&c.variable&&(c.variable=a.initPageVariable(c.variable));return c.variable};a.initPageVariable=function(a){if(!a||a instanceof c)return a;if("string"===typeof a){var b=e.getObjectUsingPath(a);if(b&&b instanceof c)return b}switch(a.type){case "2":return new d(a);case "3":return new k(a);case "4":return new p(a);case "5":return new f(a);case "EPRESSION":return new d(a);
case "URL_PARAMETER":return new k(a);case "COOKIE_VALUE":return new p(a);case "DOM_VALUE":return new f(a);default:return new c(a)}}})();(function(){function a(a){this.calls={}}var b=g.Define,e=g.opentag.Utils;a.prototype.on=function(a,c){this.calls[a]=this.calls[a]||[];return e.addToArrayIfNotExist(this.calls[a],c)};a.prototype.call=function(a){if(a=this.calls[a])for(var c=0;c<a.length;c++)try{a[c]()}catch(d){}};a.prototype.remove=function(a,c){return e.removeFromArray(this.calls[a],c)};a.prototype.removeAll=
function(a){var c=0,d;for(d in this.calls)this.calls.hasOwnProperty(d)&&(c+=e.removeFromArray(this.calls[d],a));return c};b.clazz("qubit.Events",a)})();(function(){function a(a){this.urlsFailed=this.urlsLoaded=0;this.events=new g.Events({});this._depLoadedHandler=function(){this.dependenciesLoaded()&&this.awaitingDependencies&&this._triggerLoadingAndExecution()}.bind(this);this.config={name:"Tag-"+f++,async:!0,usesDocumentWrite:!1,timeout:this.LOADING_TIMEOUT,dependencies:[],url:null,urlLocation:null,
locationPlaceHolder:"END",locationObject:null,dontWaitForInjectionLocation:!1,noMultipleLoad:!1,loadDependenciesOnLoad:!1};this.delayDocWrite=!1;this.dependencies=[];this._lockObject={count:0};this._lockObjectDepsLoaded={};this.genericDependencies=this.genericDependencies||[];if(a){if(!a.name){var c="Tag-"+f++;this.config.name=c}this.addState("INITIAL");for(var d in a)this.config[d]=a[d];a.genericDependencies&&(this.genericDependencies=this.genericDependencies.concat(a.genericDependencies));a.dependencies&&
(this.dependencies=a.dependencies.concat(this.dependencies));a.PACKAGE&&(this._package=a.PACKAGE);this.onInit()}}function b(){if(this.cancelled)this._handleCancel();else{this.waitForDependenciesFinished=(new Date).valueOf();var a=this._fullBodyNeededAndUnLoaded(),c=this._bodyNeededButNotAvailable();a||c?this.waitForDependenciesFinished=!1:(this.timeoutCountdownStart||(this.timeoutCountdownStart=(new Date).valueOf()),this.allDependenciesLoaded()?this._markLoadedSuccesfuly():this._loadingOutOfTimeFrames()?
(this.loadingTimedOut=(new Date).valueOf(),this.allDependenciesLoaded(!0)?this._markLoadedSuccesfuly():(this.addState("TIMED_OUT"),this.loadingDependenciesFailed=(new Date).valueOf(),this._triggerOnLoadTimeout())):this.waitForDependenciesFinished=!1);this.waitForDependenciesFinished?this.addState("LOADED_DEPENDENCIES"):this._setTimeout(b.bind(this),65)}}var e=g.opentag.Utils,h=g.opentag.TagsUtils,c=g.opentag.Timed,d=g.opentag.TagHelper,f=0;g.Define.clazz("qubit.opentag.GenericLoader",a);a.prototype.onInit=
r;a.prototype.LOADING_TIMEOUT=5E3;a.prototype.getHtml=function(){return this.config.html?this.config.html:this.htmlContent?e.trim(this.htmlContent):null};a.prototype._executeScript=function(){var a=!1;try{this.script(),a=!0}catch(c){this.addState("EXECUTED_WITH_ERRORS"),this.executedWithErrors=(new Date).valueOf(),this._onError(c)}finally{this._onExecute(a)}};a.prototype.getTimeout=function(){return this._getTimeout()};a.prototype._getTimeout=function(a){var c=+this.config.timeout,d=this.dependencies;
if(-1!==c&&0<d.length){var b=0;a=a||[];if(-1===e.indexInArray(a,this)){a[a.length]=this;for(var h=0;h<d.length;h++){var f=d[h]._getTimeout(a);f>b&&(b=f)}0<b&&(c+=b)}else return 0}return c};a.prototype._onExecute=function(a){this.onExecute(a)};a.prototype.onExecute=r;a.prototype._flushDocWrites=function(a){var c=!0;this._docWriteNotFlushed=!1;try{var d=h.getHTMLLocationForTag(this);d&&this._securedWrites&&0<this._securedWrites.length&&((c=h.flushDocWritesArray(this._securedWrites,d,"END"===this.config.locationPlaceHolder,
this.log,a))?this._docWriteFlushed=(new Date).valueOf():this._docWriteNotFlushed=(new Date).valueOf())}catch(b){this._onError(b)}a&&a();this._securedWrites&&0<this._securedWrites.length&&(c=!1,this._docWriteNotFlushed=(new Date).valueOf());return c};a.prototype.log=r;a.prototype.finished=function(){return!!this.runIsFinished};a.prototype.script=function(){};a.prototype.before=function(){this.beforeRun=(new Date).valueOf();try{this.onBefore()}catch(a){this._onError(a)}};a.prototype.onBefore=r;a.prototype.after=
function(a){this.afterRun=(new Date).valueOf();try{this.onAfter(a)}catch(c){this._onError(c)}};a.prototype.onAfter=function(a){};a.prototype.runOnce=function(){this._runOnceTriggered||this.scriptExecuted||(this._runOnceTriggered=(new Date).valueOf(),this.run())};a.CANCEL_ALL=!1;a.prototype.runCounter=0;a.prototype.run=function(){if(this.cancelled||a.CANCEL_ALL)return this._handleCancel(),!1;if(this.isRunning)return!1;this.lastRun&&this.reset();this.lastRun=this.isRunning=(new Date).valueOf();this.runCounter++;
this._ignoreDeps=!!this.ignoreDependencies;return this._ignoreDeps||this.dependenciesLoaded()?this._triggerLoadingAndExecution():(this._attachDepsEventsToContinue(),!1)};a.prototype._triggerLoadingAndExecution=function(){this.awaitingDependencies=-(new Date).valueOf();this.load();this._ignoreDeps?this.execute():this.waitForDependenciesAndExecute();return!0};a.prototype._attachDepsEventsToContinue=function(){this.awaitingDependencies=(new Date).valueOf();for(var a=this.dependencies,c=0;c<a.length;c++)try{a[c].events.on("success",
this._depLoadedHandler)}catch(d){}};a.prototype.dependenciesLoaded=function(){for(var a=this.dependencies,c=0;c<a.length;c++)if(a[c]!==this&&!(0<+a[c].scriptExecuted))return!1;return!0};a.prototype._setTimeout=function(a,d){this._wasTimed=(new Date).valueOf();return c.setTimeout(a,d)};a.prototype._handleCancel=function(){this.addState("CANCELLED");try{this.onCancel()}catch(a){this._onError(a)}};a.prototype.waitForDependenciesAndExecute=function(){this.cancelled?this._handleCancel():this.loadedDependencies?
this.execute():this.loadingDependenciesFailed?(this._markFailure(),this._markFinished()):this._setTimeout(this.waitForDependenciesAndExecute.bind(this),30)};a.prototype.execute=function(){this._triggerExecution()};a.prototype._triggerExecution=function(){if(this.cancelled)this._handleCancel();else if(!this.scriptExecuted){var a=!0;if(this.shouldWaitForDocWriteProtection())a=!1;else{if(!this._beforeEntered){this._beforeEntered=(new Date).valueOf();a=!1;try{a=this.before()}catch(c){this._onError(c)}if(a){this._markFailure();
this._markFinished();return}}a=this.loadExecutionURLsAndHTML(this._triggerExecution.bind(this))}if(!this.scriptExecuted)if(this.unexpectedFail&&(a=!0),a){this._flushDocWrites();this.scriptLoadingFailed||this.injectHTMLFailed||this.unexpectedFail?this._markFailure():(this.scriptExecuted=(new Date).valueOf(),this.addState("EXECUTED"),this._executeScript());if(this.cancelled)return this._handleCancel(),!1;a=0<this.scriptExecuted;try{this.afterRun||(this.afterRun=(new Date).valueOf(),this.after(a))}catch(d){this.executedWithErrors=
(new Date).valueOf()}this.executedWithErrors||a&&this.events.call("success");this._flushDocWrites();this._markFinished()}else this._setTimeout(this._triggerExecution.bind(this),30)}};a.prototype._markFailure=function(){this.scriptExecuted=-(new Date).valueOf();this.addState("FAILED_TO_EXECUTE")};a.prototype._markFinished=function(){this.runIsFinished=(new Date).valueOf();this.isRunning=!1;a.LOCK_DOC_WRITE===this&&(this._flushDocWrites(),h.unlockDocumentWrites(),a.LOCK_DOC_WRITE=!1);this.onFinished(!0)};
a.prototype.onFinished=r;a.prototype.onCancel=r;a.prototype.onFinished=r;a.prototype.shouldWaitForDocWriteProtection=function(){if(this.willSecureDocumentWrite())if(!a.LOCK_DOC_WRITE)a.LOCK_DOC_WRITE=this,this._secureWriteAndCollectForExecution();else if(a.LOCK_DOC_WRITE!==this)return this._lockedDocWriteInformed||(this._lockedDocWriteInformed=(new Date).valueOf()),!0;return!1};a.prototype.runWithoutDependencies=function(){this.ignoreDependencies=!0;this.run()};a.prototype.loadExecutionURLsAndHTML=
function(a){if(this.cancelled)return this._handleCancel(),!0;this._loadExecutionURLsAndHTMLInformed||(this._loadExecutionURLsAndHTMLInformed=!0);this._triggerURLsLoading(a);return this.loadURLsNotFinished||(this._flushDocWrites(),this._triggerHTMLInjection(),this._flushDocWrites(),this.injectHTMLNotFinished||(this._flushDocWrites(),this._docWriteNotFlushed))?!1:!0};a.prototype._triggerURLsLoading=function(a){!this._urlLoadTriggered&&this.config.url&&(this._urlLoadTriggered=!0,this.loadURLs(!1,a))};
a.prototype._triggerHTMLInjection=function(){!this._injectHTMLTriggered&&this.getHtml()&&(this._injectHTMLTriggered=!0,this.injectHTML())};a.prototype.STATE={INITIAL:0,STARTED:1,LOADING_DEPENDENCIES:2,LOADED_DEPENDENCIES:4,LOADING_URL:8,LOADED_URL:16,EXECUTED:32,EXECUTED_WITH_ERRORS:64,FAILED_TO_LOAD_DEPENDENCIES:128,FAILED_TO_LOAD_URL:256,FAILED_TO_EXECUTE:512,TIMED_OUT:1024,UNEXPECTED_FAIL:2048,CANCELLED:4096};a.prototype.addState=function(a){if(this.STATE.hasOwnProperty(a)){this.state|=this.STATE[a];
try{this.onStateChange(a)}catch(c){this._onError(c)}}};a.prototype.onStateChange=r;a.prototype.cancel=function(){this.cancelled=(new Date).valueOf()};a.prototype.state=a.prototype.STATE.INITIAL;a.prototype._markLoadedSuccesfuly=function(){this.loadedDependencies=(new Date).valueOf();this.onAllDependenciesLoaded()};a.prototype._secureWriteAndCollectForExecution=function(){this._securedWrites||(this._securedWrites=[],h.redirectDocumentWritesToArray(this._securedWrites,this.log))};a.prototype.allDependenciesLoaded=
function(a,c){return 0===this.getDependenciesToBeLoaded(a,c).length};a.prototype.getDependenciesToBeLoaded=function(a,c){var d=c||[];this.injectionLocationReady()||d.push("injection location");var b,e=this.dependencies;for(b=0;b<e.length;b++)e[b]!==this&&(0<+e[b].scriptExecuted||d.push("dependant Tag with name -> "+(e[b].config?e[b].config.name:"anonymous")));for(b=0;b<this.genericDependencies.length;b++)this.genericDependencies[b](this)||d.push("this.genericDependencies["+b+"] (index: "+b+")");return d};
a.prototype.docWriteAsksToWaitForBody=function(){return!(!this.delayDocWrite||!this.config.usesDocumentWrite)};a.prototype._bodyNeededButNotAvailable=function(){return this._dontWaitForInjections()?!1:this._isBodyLocationNeeded()&&!h.bodyAvailable()};a.prototype._isBodyLocationNeeded=function(){return this.isLoadingAsynchronously()?this._isBodyLocationSet()?!0:"HEAD"===this.config.locationObject&&"END"===this.config.locationPlaceHolder:!1};a.prototype._isBodyLocationSet=function(){var a=this.config.locationObject;
return!a||"BODY"===a};a.prototype._fullBodyNeededAndUnLoaded=function(){if(this._dontWaitForInjections())return!1;var a=!1;this._isBodyLocationNeeded()&&(a="END"===this.config.locationPlaceHolder);return(a=a||this.fullbodyNeeded||this.docWriteAsksToWaitForBody())&&!e.bodyReady()};a.prototype._dontWaitForInjections=function(){return this.config.dontWaitForInjectionLocation||this.dontWaitForInjectionLocation||a.dontWaitForInjectionLocation};a.prototype.injectionLocationReady=function(){return this._dontWaitForInjections()?
!0:this._fullBodyNeededAndUnLoaded()?!1:this.isLoadingAsynchronously()?!!h.getHTMLLocationForTag(this):!0};a.prototype._loadingOutOfTimeFrames=function(){return 0>this.getTimeout()?!1:(new Date).valueOf()-this.timeoutCountdownStart>this.getTimeout()};a.prototype.loadDependencies=function(){this._loadDependencies()};a.prototype.addClientDependenciesList=function(a,c){return this.addDependenciesList(a,g.Define.clientSpaceClasspath())};a.prototype.addDependenciesList=function(c,d){if(c&&0!==c.length){this.failedDependenciesToParse||
(this.failedDependenciesToParse=[]);for(var b=this.dependencies,h=0;h<c.length;h++){var f=c[h],g=!1;if(f instanceof a)b.push(f);else if("string"===typeof f){var v=f;d&&(f=d+"."+f);var s=e.getObjectUsingPath(f);s?s instanceof a?b.push(s):g=!0:this.failedDependenciesToParse.push(v)}else g=!0;g&&(this.badDepsObjects=this.badDepsObjects||[],e.addToArrayIfNotExist(this.badDepsObjects,f))}}};a.prototype._loadDependencies=function(a){a=a||[];var c=this.dependencies;if(-1===e.indexInArray(a,this)){a[a.length]=
this;for(var d=0;d<c.length;d++)c[d].load(a)}};a.prototype.onError=r;a.prototype._onError=function(a){try{this.onError(a)}catch(c){}};a.prototype._triggerOnLoadTimeout=function(){this.onLoadTimeout()};a.prototype.onLoadTimeout=r;a.prototype.onScriptsLoadSuccess=r;a.prototype.onScriptLoadError=r;a.prototype.onAllDependenciesLoaded=r;a.prototype.onBeforeLoad=r;a.prototype.load=function(){if(!this.loadStarted){this.loadStarted=(new Date).valueOf();try{this.onBeforeLoad()}catch(a){this._onError(a)}this.addState("LOADING_DEPENDENCIES");
try{!this._ignoreDeps&&this.config.loadDependenciesOnLoad&&this.loadDependencies()}catch(c){throw c;}b.call(this)}};a.prototype._singleUrlLoadHandler=function(a,c,d){++this.urlsLoaded;a||++this.urlsFailed;if(this.urlsLoaded===c.length)if(this.loadURLsNotFinished=!1,a&&0===this.urlsFailed){this.addState("LOADED_URL");this.urlsLoaded=(new Date).valueOf();try{d&&d(!0)}catch(b){this._onError(b)}finally{this.onScriptsLoadSuccess()}}else{a="error loading urls. Failed "+this.urlsFailed;this._onError(a);
this.addState("FAILED_TO_LOAD_URL");this.urlsLoaded=-(new Date).valueOf();try{this.scriptLoadingFailed=!0,d&&d(!1)}catch(e){this._onError(e)}finally{this.onScriptLoadError(a)}}};a.prototype.loadURLs=function(a,c){var d=a||this.config.url;this.addState("LOADING_URL");try{!d||d instanceof Array||(d=[d]);for(var b=0;b<d.length;b++){this.loadURLsNotFinished=!0;var e=d[b],e=this.prepareURL(e);this.loadURL(e,function(a){this._singleUrlLoadHandler(a,d,c)}.bind(this))}}catch(h){this.loadURLsNotFinished=!1,
this.addState("UNEXPECTED_FAIL"),this.unexpectedFail=(new Date).valueOf(),this._onError(h)}};a.prototype.prepareLocationObject=function(a){return a};a.prototype.prepareURL=function(a){return a};a.prototype.prepareHTML=function(a){return a};a.prototype.loadURL=function(a,c,d){this.addState("LOADING_URL");h.loadScript({onsuccess:function(){try{c&&c(!0)}catch(a){}}.bind(this),onerror:function(){try{c&&c(!1)}catch(a){}}.bind(this),url:a,node:d||this.config.urlLocation,async:this.isLoadingAsynchronously(),
noMultipleLoad:this.config.noMultipleLoad})};a.prototype.reset=function(){this._securedWrites=this.delayDocWrite=this.scriptLoadingFailed=this.scriptExecuted=this.runIsFinished=this.loadingTimedOut=this.loadingDependenciesFailed=this.loadedDependencies=this.loadURLsNotFinished=this.loadStarted=this.injectHTMLFailed=this.filtersRunTriggered=this.beforeRun=this.afterRun=this._urlLoadTriggered=this._runOnceTriggered=this._lockedDocWriteInformed=this._loadExecutionURLsAndHTMLInformed=this._injectHTMLTriggered=
void 0;this.state=0;this.unexpectedFail=void 0;this.urlsLoaded=this.urlsFailed=0;this.timeoutCountdownStart=this.awaitingDependencies=this._beforeEntered=this.cancelled=this._lastRun=this.isRunning=this.waitForDependenciesFinished=void 0;this.addState("INITIAL")};a.prototype.isLoadingAsynchronously=function(){return this._wasTimed?!0:!(!this.config.async&&!this.forceAsynchronous)};a.prototype.willSecureDocumentWrite=function(){return this.config.usesDocumentWrite&&this.isLoadingAsynchronously()};
a.prototype.injectHTML=function(a){var c=!this.docWriteAsksToWaitForBody(),b=this.prepareHTML(this.getHtml());b&&d.injectHTMLForLoader(this,a,c,b)};a.prototype.clone=function(){return new a(this.config)}})();(function(){function a(c){e.setIfUnset(c,{filterTimeout:c&&c.filterTimeout||this.FILTER_WAIT_TIMEOUT,PACKAGE:c&&c.PACKAGE,dedupe:!1,needsConsent:!1,inactive:!1,variables:null,runner:null,disabled:!1,locked:!1});a.SUPER.apply(this,arguments);this.namedVariables={};this.parameters=[];this.filters=
[];this.session=null;if(c){this.addState("INITIAL");try{a.register(this)}catch(d){}this.setupConfig(c);this.uniqueRefString=null;if(c.init)try{c.init.call(this,c)}catch(b){}this.onTagInit()}}function b(a,c){var e=a.namedVariables,h=d.initPageVariable(e[c]);return e[c]=h}var e=g.opentag.Utils,h=g.opentag.TagsUtils,c=g.opentag.filter.BaseFilter,d=g.opentag.TagHelper,f=g.opentag.pagevariable.BaseVariable,k=g.Cookie,m=g.Define;m.clazz("qubit.opentag.BaseTag",a,g.opentag.GenericLoader);a.prototype.setupConfig=
function(a){if(a){a.filters&&this.addFilters(a.filters);a.parameters&&this.addParameters(a.parameters);if(a.variables)for(var c in a.variables)if(a.variables.hasOwnProperty(c)){var d=this.getParameterByTokenName(c);if(d){var b=a.variables[c];d.variable=b;void 0!==b.defaultValue&&(d.defaultValue=b.defaultValue);void 0!==b.uv&&(d.uv=b.uv)}}a.locked&&this.lock()}};a.prototype.valueForToken=function(a,c){var d=this.getParameterByTokenName(a);if(d)return void 0===c&&this.loadingTimedOut&&(c=!0),this.getParameterValue(d,
c);if((d=this.namedVariables)&&d[a]&&(d=b(this,a)))return d.getRelativeValue(c)};a.prototype.addParameters=function(a){this.parameters=this.parameters.concat(a)};a.prototype.LOADING_TIMEOUT=5E3;a.prototype.FILTER_WAIT_TIMEOUT=-1;a.prototype.run=function(){if(this.destroyed)throw"Tag is destroyed.";this.resolveAllDynamicData();if(this.config.runner){var a=!1;try{this.addState("AWAITING_CALLBACK"),a=this._runner=(new Date).valueOf(),this.config.runner.call(this)}catch(c){}return a}this._runner=!1;return this.start()};
a.prototype.lock=function(){this.locked=!0;this._unlock=null};a.prototype.unlock=function(){this.locked=!1;this._unlock&&(this._unlock(),this._unlock=!1)};a.prototype.start=function(){return this.locked?(this._unlock=function(){return a.SUPER.prototype.run.call(this)}.bind(this),!1):a.SUPER.prototype.run.call(this)};a.prototype.startOnce=function(){return this.locked?(this._unlock=function(){return a.SUPER.prototype.runOnce.call(this)}.bind(this),!1):a.SUPER.prototype.runOnce.call(this)};a.prototype.getFilters=
function(){return this.filters};a.prototype.runOnceIfFiltersPass=function(){this._runOnceIfFiltersPassTriggered||this.scriptExecuted||(this._runOnceIfFiltersPassTriggered=(new Date).valueOf(),this.runIfFiltersPass())};a.prototype.runIfFiltersPass=function(){if(this.destroyed)throw"Tag is destroyed.";this.resolveAllDynamicData();var a=this.filtersState(!0);this.addState("FILTER_ACTIVE");this.filtersRunTriggered||(this.filtersRunTriggered=(new Date).valueOf());if(a===c.state.SESSION)this.addState("AWAITING_CALLBACK"),
this.awaitingCallback=(new Date).valueOf();else if(a===c.state.PASS){this.filtersPassed=(new Date).valueOf();try{this.onFiltersPassed()}catch(d){}this.run()}else if(a===c.state.FAIL)this._markFiltersFailed(),this._markFinished();else if(0<a){var b=this.config.filterTimeout;if(0>b||(new Date).valueOf()-this.filtersRunTriggered>b){if(!this._awaitingForFilterInformed){this._awaitingForFilterInformed=(new Date).valueOf();try{this.onFiltersDelayed()}catch(e){}}this._setTimeout(this.runIfFiltersPass.bind(this),
a)}else this._markFiltersFailed(),this._markFinished(),this.filtersRunTimedOut=(new Date).valueOf()}try{this.onFiltersCheck(a)}catch(h){}return a};a.prototype._markFiltersFailed=function(){this.addState("FILTERS_FAILED");this.filtersPassed=-(new Date).valueOf()};a.prototype.STATE={INITIAL:0,FILTER_ACTIVE:1,AWAITING_CALLBACK:2,FILTERS_FAILED:4,STARTED:8,LOADING_DEPENDENCIES:16,LOADED_DEPENDENCIES:32,LOADING_URL:64,LOADED_URL:128,EXECUTED:256,EXECUTED_WITH_ERRORS:512,FAILED_TO_LOAD_DEPENDENCIES:1024,
FAILED_TO_LOAD_URL:2048,FAILED_TO_EXECUTE:4096,TIMED_OUT:8192,UNEXPECTED_FAIL:16384,CANCELLED:32768};a.prototype.addState=function(c){a.SUPER.prototype.addState.call(this,c);try{a.onStateChange(this)}catch(d){}this.stateStack=[];c=this.STATE;var b=this.state,e=this.stateStack;b&c.INITIAL&&e.push("Initial state.");b&c.FILTER_ACTIVE&&e.push("Tag running with filters pass triggered.");b&c.FILTERS_FAILED&&e.push("Filters failed to pass.");b&c.AWAITING_CALLBACK&&e.push("Awaiting callback to run this tag. Not pooling.");
b&c.STARTED&&e.push("Tag is initialized and loading has been started.");b&c.LOADING_DEPENDENCIES&&e.push("Dependencies are being loaded.");b&c.LOADED_DEPENDENCIES&&e.push("Dependencies loading process has been finished.");b&c.LOADING_URL&&e.push("External URL is being loaded.");b&c.LOADED_URL&&e.push("External URL has been loaded.");b&c.EXECUTED&&e.push("Main script has been executed.");b&c.EXECUTED_WITH_ERRORS&&e.push("Main script has been executed but errors occured.");b&c.FAILED_TO_LOAD_DEPENDENCIES&&
e.push("Dependencies has failed to load.");b&c.FAILED_TO_LOAD_URL&&e.push("URL location failed to load.");b&c.FAILED_TO_EXECUTE&&e.push("Script failed to execute.");b&c.TIMED_OUT&&e.push("Script timed out awaiting for dependencies.");b&c.UNEXPECTED_FAIL&&e.push("Script occured UNEXPECTED exception and is failed.");b&c.CANCELLED&&e.push("Tag has been cancelled.")};a.prototype.onTagInit=r;a.onStateChange=r;a.prototype.onFiltersDelayed=r;a.prototype.onFiltersPassed=r;a.prototype.onFiltersCheck=r;a.prototype.state=
a.prototype.STATE.INITIAL;a.prototype.arePageVariablesLoaded=function(a){return d.allParameterVariablesReadyForTag(this,a)};a.prototype.getDependenciesToBeLoaded=function(c,d){var b=d||[];this.arePageVariablesLoaded(c)||b.push("page variables");return a.SUPER.prototype.getDependenciesToBeLoaded.call(this,c,b)};a.prototype.resolveAllDynamicData=function(){this.resolvePageVariables();this.resolveDependencies();this.resolveFilters()};a.prototype.resolveDependencies=function(){var a=this.failedDependenciesToParse;
a&&(this.failedDependenciesToParse=null,this.addDependenciesList(a,m.clientSpaceClasspath()));return this.dependencies};a.prototype.addClientVariablesMap=function(a){return this.unresolvedClientVariablesMap=this.addVariablesMap(a,m.clientSpaceClasspath())};a.prototype.resolvePageVariables=function(){var a=this.unresolvedClientVariablesMap;a&&(this.unresolvedClientVariablesMap=null,this.addClientVariablesMap(a));return this.getPageVariables()};a.prototype.addVariablesMap=function(a,c){if(a){var d=
{},b=this.namedVariables,h;for(h in a)if(a.hasOwnProperty(h)){var g=a[h];if(g instanceof f)b[h]=g;else if("string"===typeof g){var k=g;c&&(g=c+"."+g);e.getObjectUsingPath(g)?b[h]=g:d[h]=k}}return d}};a.prototype.prepareURL=function(a){return this.replaceTokensWithValues(a)};a.prototype.prepareLocationObject=function(a){return this.replaceTokensWithValues(a)};a.prototype.prepareHTML=function(a){a&&(a=this.replaceTokensWithValues(a));return a};a.prototype._executeScript=function(){if(this.config&&this.config.script)if("function"===
typeof this.config.script)this.script=this.config.script;else{var c=this.replaceTokensWithValues(String(this.config.script));this.script=e.expressionToFunction(c).bind(this)}a.SUPER.prototype._executeScript.call(this)};a.prototype.replaceTokensWithValues=function(a){if(!a||-1===a.indexOf("${"))return a;var c=this.parameters;if(c)for(var d=0;d<c.length;d++){var b=this.getVariableForParameter(c[d]);if(b){var e=c[d].token,h=this.valueForToken(e);a=b.replaceToken(e,a,h)}}return a};a.prototype.getParameter=
function(a){var c=this.parameters,d=null;if(c)for(var b=0;b<c.length;b++)c[b].name===a&&(d=c[b]);return d};a.prototype.setParameterValueByTokenName=function(a,c){var d=this.getParameterByTokenName(a);return null!==d?(d.variable={value:c},!0):!1};a.prototype.getParameterValue=function(a,c){var d="string"===typeof a?this.getParameter(a):a;if(d){var b=this.getVariableForParameter(d);if(b)try{var h;c&&""!==d.defaultValue&&(h=e.gevalAndReturn(d.defaultValue).result);return h=b.getRelativeValue(c,h)}catch(f){}}};
a.prototype.filtersState=function(a){return h.filtersState(this.filters,this.session,this,a)};a.prototype.addFilter=function(a){e.addToArrayIfNotExist(this.filters,a)};a.prototype.addFilters=function(a){for(var c=0;c<a.length;c++)this.addFilter(a[c])};a.prototype.addClientFiltersList=function(a){return this.unresolvedClientFilterClasspaths=this.addFiltersList(a,m.clientSpaceClasspath())};a.prototype.resolveFilters=function(){var a=this.unresolvedClientFilterClasspaths;a&&(this.unresolvedClientFilterClasspaths=
null,this.addClientFiltersList(a));return this.filters};a.prototype.addFiltersList=function(a,d){for(var b=[],h=0;h<a.length;h++)try{var f=a[h],g=null;"string"===typeof f&&(g=f,d&&(f=d+"."+f),f=e.getObjectUsingPath(f));"function"===typeof f&&(f=new f);!f instanceof c&&(f=null);f?this.addFilter(f):g&&e.addToArrayIfNotExist(b,g)}catch(k){this.failedFilters=this.failedFilters||[],this.failedFilters.push(a[h])}return b};a.prototype.reset=function(){a.SUPER.prototype.reset.call(this);this._runner=this.filtersRunTriggered=
this._runOnceIfFiltersPassTriggered=this.pingSent=this.dedupePingSent=this.filtersPassed=void 0};a.prototype.resetFilters=function(){for(var a=0;a<this.filters.length;a++)this.filters[a].reset()};a.prototype.getParameterByTokenName=function(a){var c=null;if(this.parameters)for(var d=this.parameters,b=0;b<d.length;b++)d[b].token===a&&(c=d[b]);return c};a.prototype.removeFilter=function(a){e.removeFromArray(this.filters,a)};var l=0,n=[],C={},q={};a.register=function(a){var c=e.addToArrayIfNotExist(n,
a);a._tagIndex=-1===c?n.length-1:c;a.config.id?(c="Q"+a.config.id,q[c]=a,a.uniqueId=c):q[a.CLASSPATH]=a};a.getById=function(a){return q[String(a)]};a.prototype.getById=a.getById;a.prototype.unregister=function(c){a.unregister(c||this)};a.prototype.destroy=function(){this.destroyed=!0;this.cancel();a.unregister(this)};a.unregister=function(a){e.removeFromArray(n,a);a._tagIndex=-1};a.getTags=function(){return n};a.getAccessorsMap=function(){return C};a.prototype.getTags=function(){return n};a.prototype.getPageVariables=
function(){var a=this.parameters,c=[];if(a)for(var d=0;d<a.length;d++){var h=this.getVariableForParameter(a[d]);null!==h&&e.addToArrayIfNotExist(c,h)}if(this.namedVariables)for(var f in this.namedVariables)e.addToArrayIfNotExist(c,b(this,f));return c};a.prototype.getAccessorString=function(){this._accessorsMapKey||(this._accessorsMapKey="_"+l++,C[this._accessorsMapKey]=this);return"qubit.opentag.BaseTag.getAccessorsMap()."+this._accessorsMapKey};a.prototype.getVariableForParameter=function(a){var c,
e=this.namedVariables;e&&e[a.token]&&(c=b(this,a.token));c||(c=d.validateAndGetVariableForParameter(a));return c};a.prototype.printVariablesState=function(){for(var a=[],c=d.getAllVariablesWithParameters(this),b=0;b<c.length;b++){var e=c[b].parameter,h=c[b].variable,f;f=e&&e.token?this.valueForToken(e.token):h.getRelativeValue(!0);e={name:h.config.name,exists:h.exists(),token:e?e.token:null,value:f,variable:h};a.push(e)}return a};a.prototype._triggerOnLoadTimeout=function(){this.onLoadTimeout()};
a.prototype.getId=function(){return this._getUniqueId()};a.prototype._getUniqueId=function(){return this.config.id?this.config.id:0===String(this.CLASSPATH).indexOf(m.STANDARD_CS_NS)?this.CLASSPATH.substring(m.STANDARD_CS_NS.length+1):this.CLASSPATH+"#"+this.config.name};a.prototype.cookieSaysToRunEvenIfDisabled=function(){var a=this._getUniqueId(),c=!!k.get("qubit.tag.forceAllToRun");c||(c=!!k.get("qubit.tag.forceRunning_"+a));return c};a.prototype.setCookieForcingTagToRun=function(){var a=this._getUniqueId();
k.set("qubit.tag.forceRunning_"+a,"true")};a.setCookieForcingTagsToRun=function(){k.set("qubit.tag.forceAllToRun","true")};a.prototype.setCookieToDisable=function(){var a=this._getUniqueId();k.set("qubit.tag.disableRunning_"+a,"true")};a.prototype.rmCookieToDisable=function(){var a=this._getUniqueId();k.rm("qubit.tag.disableRunning_"+a)};a.prototype.disabledByCookie=function(){var a=this._getUniqueId();return!!k.get("qubit.tag.disableRunning_"+a)};a.rmCookieForcingTagsToRun=function(){k.rm("qubit.tag.forceAllToRun")};
a.prototype.rmCookieForcingTagToRun=function(){var a=this._getUniqueId();k.rm("qubit.tag.forceRunning_"+a)};a.rmAllDisablingCookies=function(){e.rmCookiesMatching("qubit.tag.disableRunning_")};a.rmAllCookiesForcingTagToRun=function(){e.rmCookiesMatching("qubit.tag.forceRunning_");a.rmCookieForcingTagsToRun()}})();(function(){var a=g.opentag.Utils,b=g.opentag.filter.BaseFilter,e=function(){};g.Define.clazz("qubit.opentag.Tags",e);e.getById=function(a){return g.opentag.BaseTag.getById(String(a))};e.getAllTagsByState=
function(){return g.opentag.Container.getAllTagsByState(e.getTags())};e.findTagByName=function(a){for(var d=this.getTags(),b=[],e=0;e<d.length;e++)d[e].config.name===a&&b.push(d[e]);return b};e.findTagByMatch=function(a){for(var d=this.getTags(),b=[],e=0;e<d.length;e++)d[e].config.name.match(a)&&b.push(d[e]);return b};e.findTagContainers=function(a){for(var d=e.getContainers(),b=[],h=0;h<d.length;h++){var f=d[h].tags,g;for(g in f)if(f[g]===a){b.push(d[h]);break}}return b};e.getTags=function(){return g.opentag.BaseTag.getTags()};
e.resetAllTags=function(){for(var a=e.getTags(),d=0;d<a.length;d++)a[d].reset()};e.getContainersPageVariables=function(){for(var a=e.getContainers(),d=[],b=0;b<a.length;b++)d=d.concat(a.getPageVariables());return d};e.getAllPageVariables=function(){for(var a=e.getTags(),d=[],b=0;b<a.length;b++)d=d.concat(a[b].getPageVariables());return d};e.cancelAll=function(){for(var a=e.getTags(),d=0;d<a.length;d++)a[d].cancel()};e.resetAll=function(){for(var a=e.getTags(),d=0;d<a.length;d++)a[d].reset()};e.getPageVariableByName=
function(a){for(var d=e.getAllPageVariables(),b=[],h=0;h<d.length;h++)d[h].config.name===a&&b.push(d[h]);return b};e.getLoadTime=function(a){var d=a.beforeRun,b=a.runIsFinished;return isNaN(b)?{tag:a,loadTime:null}:{tag:a,loadTime:b-d}};e.getLoadTimes=function(a){var d=[];if(a instanceof g.opentag.BaseTag)return d.push([e.getLoadTime(a[b])]),d;a=a||e.getTags();if(a instanceof Array)for(b=0;b<a.length;b++)a[b]instanceof g.opentag.BaseTag&&d.push(e.getLoadTime(a[b]));else for(var b in a)a[b]instanceof
g.opentag.BaseTag&&d.push(e.getLoadTime(a[b]));return d};e.forceAllContainersAndTagsToRunIfDisabled=function(){g.opentag.Container.setCookieForDisabledContainersToRun();g.opentag.BaseTag.setCookieForcingTagsToRun()};e.rmAllContainersAndTagsForcingFlags=function(){g.opentag.Container.rmCookieForDisabledContainersToRun();g.opentag.BaseTag.rmAllCookiesForcingTagToRun()};e.getContainers=function(){return g.opentag.Container.getContainers()};e.findAllTagsByClassPath=function(c){var b=[],h=[];try{h.push(g.opentag.CustomTag),
h.push(g.opentag.LibraryTag)}catch(f){}for(var k=e.getTags(),m=0;m<k.length;m++){var l=k[m];0>a.indexInArray(h,l)&&0===l.PACKAGE_NAME.indexOf(c)&&b.push(l)}return b};e.findAllTags=function(a,b){var h=g.opentag.BaseTag,f=[];try{f.push(g.opentag.CustomTag),f.push(g.opentag.LibraryTag)}catch(k){}return e.findAllInstances(a,h,f,b)};var h=function(c,b,e,h){var f=[];"string"===typeof c&&(c=a.getObjectUsingPath(c));if(c){var g={objectsOnly:!0};h&&(g.maxDeep=!0);h=function(c,h,g,k){if(b(c)){for(h=0;h<e.length;h++)if(e[h]===
c)return!0;a.addToArrayIfNotExist(f,c);return!0}return!1}.bind(this);a.traverse(c,h,g)}return f};e.findAllInstances=function(a,b,e,f){return h(a,function(a){return a instanceof b},e,f)};e.findAllInheriting=function(a,b,e,f){return h(a,function(a){return a.prototype instanceof b},e,f)};e.findAllFilters=function(a,d){var h=[];try{h.push(g.opentag.filter.Filter),h.push(g.opentag.filter.URLFilter)}catch(f){}return e.findAllInheriting(a,b,h,d)}})();b={};k=void 0;b.update=function(){var a,b;b=function(){return Math.floor(1+
65536*Math.random()).toString(36).substring(1)};window.__pageViewId__||(a=(new Date).getTime().toString(36),window.__pageViewId__=a+b()+b()+b());return window.__pageViewId__};t.PostData=function(a,b,e){var h,c,d,f,g,k,m;m=2;g=!1;k=function(){0<m&&setTimeout(function(){g||(m-=1,h())},5E3)};c=navigator.userAgent.toLowerCase();d=-1!==c.indexOf("msie");c.indexOf("msie 9");c=-1!==c.indexOf("msie 7")||-1!==c.indexOf("msie 6");f=("https:"===document.location.protocol?"https:":"http:")+a;e=e||"POST";h=function(){var a;
try{a=null;try{a=new XMLHttpRequest}catch(c){}a&&!d?a.open(e,f,!0):"undefined"!==typeof XDomainRequest?(a=new XDomainRequest,a.open(e,f)):a=null;try{a.withCredentials=!1}catch(h){}a.setRequestHeader&&a.setRequestHeader("Content-Type","text/plain;charset=UTF-8");a.onload=function(){g=!0};a.onreadystatechange=function(){};a.ontimeout=function(){};a.onerror=function(){};a.onprogress=function(){};a.send(b)}catch(m){try{try{t.fileLoader.load(f)}catch(s){window.console&&window.console.log&&window.console.log(m)}}catch(z){}}k()};
c?t.fileLoader.load(f):h()};(function(){function a(){}g.Define.clazz("qubit.opentag.Ping",a);a.prototype.send=function(f,e){for(var h=f.config,c="c="+h.clientId+"&p="+f.getContainerId()+"&l="+h.tellLoadTimesProbability+"&pv="+b.update()+"&d=",d=[],g=0;g<e.length;g++){var k=e[g].tag,m=e[g].loadTime;if(null!==m&&!isNaN(m)){var l=a.getPingID(k);!k.pingSent&&l&&null!==m&&void 0!==l&&(d.push('"'+l+'":'+m),k.pingSent=!0)}}h.pingServerUrl&&0<d.length&&(c+=encodeURIComponent("{"+d.join(",")+"}"),t.PostData("//"+
h.pingServerUrl+"/tag2?"+c,null,"GET"))};a.prototype.sendErrors=function(a,b){};a.prototype.sendDedupe=function(f,e){for(var h=f.config,c="c="+h.clientId+"&p="+f.getContainerId()+"&l="+h.tellLoadTimesProbability+"&pv="+b.update()+"&dd=",d=[],g=0;g<e.length;g++){var k=e[g],m=a.getPingID(k);void 0===m||k.dedupePingSent||(d.push(m),k.dedupePingSent=!0)}0<d.length&&h.pingServerUrl&&(c+=encodeURIComponent("["+d.join(",")+"]"),t.PostData("//"+h.pingServerUrl+"/tag2?"+c,null,"GET"))};a.getPingID=function(a){if(a.config.id)return a.config.id;
var b=a.PACKAGE_NAME.lastIndexOf(".");return-1!==b?a.PACKAGE_NAME.substring(b+1):a.PACKAGE_NAME}})();k={_cookieName:"_qst_s",_sessionCookie:"_qsst_s",update:function(a){var b,e;b=g.Cookie.get(k._cookieName);e=g.Cookie.get(k._sessionCookie);if(b){if(b=parseInt(b,10),!e||parseInt(e,10)<(new Date).getTime()-18E5)b+=1}else b=1;g.Cookie.set(k._cookieName,b,365,a);g.Cookie.set(k._sessionCookie,(new Date).getTime().toString(),null,a);return b}};var x={};(function(){function a(a){return 10>a?"0"+a:a}function b(a){c.lastIndex=
0;return c.test(a)?'"'+a.replace(c,function(a){var c=g[a];return"string"===typeof c?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function e(c,h){var g,m,l,s,z=d,p,w=h[c];if(w instanceof Date)g=w,w=isFinite(g.valueOf())?g.getUTCFullYear()+"-"+a(g.getUTCMonth()+1)+"-"+a(g.getUTCDate())+"T"+a(g.getUTCHours())+":"+a(g.getUTCMinutes())+":"+a(g.getUTCSeconds())+"Z":null;else if(w instanceof String||w instanceof Number||w instanceof Boolean)w=w.valueOf();"function"===typeof k&&
(w=k.call(h,c,w));switch(typeof w){case "string":return b(w);case "number":return isFinite(w)?String(w):"null";case "boolean":case "null":return String(w);case "object":if(!w)return"null";d+=f;p=[];if("[object Array]"===Object.prototype.toString.apply(w)){s=w.length;for(g=0;g<s;g+=1)try{p[g]=e(g,w)||"null"}catch(n){p[g]='{"stack_exceeded": null}'}l=0===p.length?"[]":d?"[\n"+d+p.join(",\n"+d)+"\n"+z+"]":"["+p.join(",")+"]";d=z;return l}if(k&&"object"===typeof k)for(s=k.length,g=0;g<s;g+=1){if("string"===
typeof k[g]){m=k[g];try{l=e(m,w)}catch(q){l='{"stack_exceeded": null}'}l&&p.push(b(m)+(d?": ":":")+l)}}else for(m in w)if(Object.prototype.hasOwnProperty.call(w,m)){try{l=e(m,w)}catch(r){l='{"stack_exceeded": null}'}l&&p.push(b(m)+(d?": ":":")+l)}l=0===p.length?"{}":d?"{\n"+d+p.join(",\n"+d)+"\n"+z+"}":"{"+p.join(",")+"}";d=z;return l}}var h=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
d,f,g={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},k;"function"!==typeof x.stringify&&(x.stringify=function(a,c,b){var h;f=d="";if("number"===typeof b)for(h=0;h<b;h+=1)f+=" ";else"string"===typeof b&&(f=b);if((k=c)&&"function"!==typeof c&&("object"!==typeof c||"number"!==typeof c.length))throw Error("JSON.stringify");return e("",{"":a})});"function"!==typeof x.parse&&(x.parse=function(a,c){function b(a,d){var e,h,f=a[d];if(f&&"object"===typeof f)for(e in f)Object.prototype.hasOwnProperty.call(f,
e)&&(h=b(f,e),void 0!==h?f[e]=h:delete f[e]);return c.call(a,d,f)}var d;a=String(a);h.lastIndex=0;h.test(a)&&(a=a.replace(h,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return d=eval("("+a+")"),"function"===typeof c?b({"":d},""):d;throw new SyntaxError("JSON.parse");})})();(function(){function a(a){if(a)if(a.alphabet)for(this.alphabet=
a.alphabet,this.dict={},a=0;a<this.alphabet.length;a++)this.dict[this.alphabet[a]]=a;else this.alphabet=e,this.dict=d}function b(a,c){for(var d in c)if(a===c[d])return d;return null}for(var e=[],h=Math.pow(2,8),c=0;c<h;c++)e.push(String.fromCharCode(c));for(var d={},h=0;h<e.length;h++)d[e[h]]=h;g.Define.clazz("qubit.compression.LZW",a);a.prototype.encode=function(a){for(var c=this.alphabet.length,b={},d=[],e=0,h=a.charAt(e++),f,g=this.dict;f=a.charAt(e++);){var k=h+f;if(g.hasOwnProperty(k)||b.hasOwnProperty(k))h=
k;else{var m=g.hasOwnProperty(h)?g[h]:b[h];if(void 0===m)throw"Dictionary base is to small for those contents: "+h;d.push(m);b[k]=c++;h=f}}""!==h&&d.push(b.hasOwnProperty(h)?b[h]:g[h]);return d};a.prototype.decode=function(a){for(var c=this.dict,d=this.alphabet.length,e,h={},f=b(a[0],c),g=f,k=[f],s=1;s<a.length;s++){var m=a[s];e=b(m,c);null===e&&(h.hasOwnProperty(m)&&(e=h[m]),null===e&&(e=g+f));k.push(e);f=e.charAt(0);h[d++]=g+f;g=e}return k.join("")}})();(function(){function a(a){}for(var b={},e=
0;45>e;e++)b["abcdefghijklmnopqrstuvwxyz0123456789'%./:<>?[".charAt(e)]=e;for(var h={},e=0;45>e;e++)h['ABCDEFGHIJKLMNOPQRSTUVWXYZ*!-+()@{|}"]^_`~$&#'.charAt(e)]=e;for(var c={},e=0;45>e;e++)c["abcdefghijklmnopqrstuvwxyz0123456789'%./:<>?[".charAt(e)]='ABCDEFGHIJKLMNOPQRSTUVWXYZ*!-+()@{|}"]^_`~$&#'.charAt(e);var d="abcdefghijklmnopqrstuvwxyz0123456789'%./:<>?[".split(""),f=d.length,k=new g.compression.LZW({});g.Define.clazz("qubit.compression.Compressor",a);a.prototype.compress=function(a,c){for(var b=
(c||k).encode(a),d=[],e=0;e<b.length;e++)d.push(String.fromCharCode(b[e]));return d.join("")};a.prototype.compressAnsi=function(a,b){for(var e=(b||k).encode(a),h=[],g=0;g<e.length;g++){var m;m=e[g];var s=0,l=0>m;l&&(m=-m);var y="",w=!0;do s=m%f,w?(y=c[d[s]],w=!1):y=d[s]+y,m=(m-s)/f;while(0<m);m=l?"-"+y:y;h.push(m)}return h.join("")};a.prototype.decompressAnsi=function(a,c){for(var d=[],e="",g=0;g<a.length;g++){var m=a.charAt(g);if(h.hasOwnProperty(m)){for(var m=e+m,e="",s=0,l=0,A=!0,w=0;w<m.length;w++){var n=
m.charAt(m.length-1-w);A&&(A=!1,n="abcdefghijklmnopqrstuvwxyz0123456789'%./:<>?[".charAt(h[n]));s+=b[n]*Math.pow(f,l++)}m=s;d.push(m)}else e+=m}return(c||k).decode(d)};a.prototype.decompress=function(a,c){for(var b=[],d=0;d<a.length;d++)b.push(a.charCodeAt(d));return(c||k).decode(b)}})();(function(){function a(a){for(var b=[],d=0;d<a.length;d++){var e=c(a[d][0]);b.push([new RegExp(e,"g"),"*"+a[d][1]])}return b}function b(a,c){for(var d=0;d<c.length;d++)if(c[d][1]===a)return c[d][0];return null}function e(c){this._regexDefs=
l;this._defs=m;c&&c.definitions&&(this._regexDefs=a(c.definitions),this._defs=c.definitions)}function h(a,c){for(var b=[],d=0;d<a.length;d++){var e=!0;c&&(e=a.charCodeAt(d)<=c);var h=k.cookieAlphabetMap.hasOwnProperty(a.charAt(d));e&&!h?b.push("*"+a.charCodeAt(d)+"."):b.push(a.charAt(d))}return b.join("")}function c(a){return a.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function d(a){for(var c={},b="",d=0;d<a.length;d++){var e=a.charAt(d);n[e]?b+=e:(isNaN(c[b])&&(c[b]=a.split(b).length-1),b="")}a=
[];for(var h in c)c.hasOwnProperty(h)&&(b=c[h],b>=r&&h.length>=q&&a.push([h,b]));return a=a.sort(function(a,c){return a[0].length===c[0].length?0:c[0].length>a[0].length?1:-1})}var f=g.Define,k=g.Cookie,m=[['","referrer":[{"url":"http://',"1-"],['","referrer":[{"url":"https://',"2-"],[',"referrer":[{"url":"http://',"3-"],[',"referrer":[{"url":"https://',"4-"],[',"sessionStartTime":',"5-"],["www.google.co.uk","6-"],["www.google.","7-"],['"sessionStartTime":',"8-"],['"landing":"',"9-"],["http%3A%2F%2Fwww",
"10-"],['"landing":',"L"],['"time":',"A"],['"pageViews":',"P"],['"sessionCount":',"B"],['"referrer":',"R"],['"url":"http://www.',"J"],['"url":"https://www.',"M"],['"url":"',"I"],['"url":',"U"],["http://www.","W"],["https://www.","V"],["%2Fen%2Ftsuk%2F","K"],['"sessionLandingPage":',"F"],["http%3A%2F%2F","D"],["http://","H"],["https://","X"],['""',"O"],['",',"Y"],['":{}}',"z"],["<","S"],[">","G"],["[","Z"],["]","E"],["{","a"],["}","b"],["(","c"],[")","d"],["!","e"],["#","f"],["$","g"],["!","q"],["'",
"i"],[":","j"],["?","k"],["^","x"],["`","m"],["|","n"],["~","o"],["%","v"],[",","C"]],l=a(m);f.clazz("qubit.opentag.compression.Encoder",e);e.prototype.encode=function(a,b){for(var e=a.replace(/\*/g,"**"),f=d(e),g=0;g<this._regexDefs.length;g++)var k=this._regexDefs[g],e=e.replace(k[0],k[1]);e=e.replace(/;/g,"*-");e=e.replace(/&/g,"*.");e=e.replace(/\\/g,"*/");e=e.replace(/=/g,"*+");e=e.replace(/\n/g,"*N");e=e.replace(/ /g,"*_");e=e.replace(/\t/g,"*T");e=e.replace(/"/g,"*Q");g=d(e);g.concat(f);for(var f=
e.replace(/@/g,"@@"),k=[],m=0,l=0;m<g.length;m++){var p=new RegExp(c(g[m][0]),"g"),p=f.replace(p,"@"+l+"-");p!==f&&(k.push(g[m][0]),l++,f=p)}g=[f,k];f=g[1];(k=0<f.length)&&(e=g[0]);e=b?h(e,b):h(e);return k?"Y"+f.join("*")+"@"+e:"N"+e};for(var n={},f=0;65>f;f++)n["abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ+_.".charAt(f)]=!0;var q=4,r=2;e.prototype.decode=function(a){var c=null;if("N"===a.charAt(0))a=a.substring(1);else if("Y"===a.charAt(0)){var d=a.indexOf("@");if(0<=d&&(c=a.substring(1,
d),c=c.split("*"),a=a.substring(d+1),c&&0!==c.length&&a)){for(var d="",e=!1,h=!1,f="",g=0;g<a.length;g++){var k=a.charAt(g);"@"===k||e||h?e||h?(e=!1,"@"===k?d+="@":isNaN(+("-"+k))?h?(d=c&&"-"===k&&c[+f]?d+c[+f]:d+("@"+f+k),f="",h=!1):d+="@"+k:(h=!0,f+=k)):e=!0:d+=k}f&&(d+="@"+f);e&&(d+="@");a=d}}c="";e=d=!1;h="";for(f=0;f<a.length;f++)g=a.charAt(f),"*"===g||d||e?d||e?(d=!1,isNaN(+("-"+g))?e?(c="."===g?c+String.fromCharCode(+h):"-"===g&&b(h+"-",this._defs)?c+b(h+"-",this._defs):c+("*"+h+g),h="",e=
!1):"*"===g?c+="*":"-"===g?c+=";":"/"===g?c+="\\":"."===g?c+="&":"+"===g?c+="=":"N"===g?c+="\n":"_"===g?c+=" ":"T"===g?c+="\t":"Q"===g?c+='"':null!==b(g,this._defs)?(g=b(g,this._defs),c+=g):c+="*"+g:(h+=g,e=!0)):d=!0:c+=g;h&&(c+="*"+h);d&&(c+="*");return c}})();(function(){function a(a){this.testBinary=!1;this.binSupported=e;a&&(this.compressor=new g.compression.Compressor,this.encoder=new g.opentag.compression.Encoder({}))}var b=g.Cookie,e=!1;g.Define.clazz("qubit.opentag.compression.CookieCompressor",
a);a.prototype.compress=function(a,c){if("string"!==typeof a||""===a)return a;var d=this.encoder.encode(a),e;if(this.binSupported||this.testBinary){e=this.compressor.compress(d);e='"B'+this.encoder.encode(e,128)+'"';b.set("__qtag_test_bin__",e,void 0,void 0,!0);var f=b.get("__qtag_test_bin__",!0);b.rm("__qtag_test_bin__");f&&f!==e&&(e=null)}f=this.encoder.encode(this.compressor.compressAnsi(d));d=!c&&d.length<=f.length?"E"+d:"C"+f;return e&&e.length<d.length?e:d};a.prototype.decompress=function(a){if("string"!==
typeof a||""===a)return a;'"'===a.charAt(0)&&(a=a.substring(1,a.length-1));var c=a.charAt(0);a=a.substring(1);switch(c){case "E":return this.encoder.decode(a);case "C":return a=this.compressor.decompressAnsi(this.encoder.decode(a)),this.encoder.decode(a);case "B":return a=this.compressor.decompress(this.encoder.decode(a)),this.encoder.decode(a);default:throw"This code is not supported! Code: "+c;}}})();(function(){var a=g.Cookie,b=g.opentag.Utils,e=function(){};g.Define.clazz("qubit.opentag.Session",
e);var f=new g.opentag.compression.CookieCompressor({});e.readCompressedCookie=function(c){c=a.get(c,!0);return f.decompress(c)};e.setupSession=function(c){var d=c.config,g,m,l,n,q;g={};g.sessionCount=k.update(d.cookieDomain);q="qtag_"+c.getContainerId();var r="x_qtag_"+c.getContainerId();l=a.get(q);c=!!l;null===l&&(l=a.get(r,!0),l=f.decompress(l));if(l)try{l=x.parse(l)}catch(t){l={sc:0,sessionCount:0,pageViews:0,sessionStartTime:0,referrer:[],sessionLandingPage:"",__v:{}}}else l={sc:0,sessionCount:0,
pageViews:0,sessionStartTime:0,referrer:[],sessionLandingPage:"",__v:{}};m=(new Date).getTime();g.sessionCount!==parseInt(l.sc,10)?(l.sessionStartTime=m,l.sc=g.sessionCount,l.sessionCount+=1,l.referrer.push({url:e.getReferrer(),landing:b.getUrl().substring(0,300),time:m}),l.sessionLandingPage=b.getUrl().substring(0,300)):e.isReferrerDifferent()&&!e.referrerIsSameAsPrevious(l.referrer,m,18E5)&&(l.referrer.push({url:e.getReferrer(),landing:b.getUrl().substring(0,300),time:m}),l.sessionLandingPage=b.getUrl().substring(0,
300),l.sessionStartTime=m,l.sessionCount+=1);g.sessionCount=l.sessionCount;g.sessionStartTime=l.sessionStartTime;g.pageStartTime=m;l.pageViews+=1;g.pageViews=l.pageViews;g.sessionLandingPage=l.sessionLandingPage;g.referrer=l.referrer;5<g.referrer.length&&g.referrer.splice(2,g.referrer.length-5);n=x.stringify(l);for(m=0;f.compress(n).length>d.maxCookieLength&&5>m;)3<=l.referrer.length?l.referrer.splice(2,1):2===l.referrer.length?l.referrer=[l.referrer[0]]:1===l.referrer.length&&(l.referrer=[]),n=x.stringify(l),
m+=1;g.referrer=l.referrer;c&&a.rm(q);q=f.compress(n);a.rm(r);0<d.maxCookieLength&&a.set(r,q,365,d.cookieDomain,!0);g.setVariable=function(c,b,e){l.__v[c]=[b,e?e:0];c=f.compress(x.stringify(l));0<d.maxCookieLength?a.set(r,c,365,d.cookieDomain,!0):a.rm(r)};g.getCookie=function(c,b){var d=a.get(c,!0);if(d&&(b||0===c.indexOf("x_")))try{d=f.decompress(d)}catch(e){}else null!==d&&(d=a.decode(d));return d};g.getVariable=function(a){var c;if(a=l.__v[a])if(c=a[1],0===c||c>(new Date).getTime())return a[0];
return null};g.on=function(a,c,b){c.attachEvent?c.attachEvent("on"+a,b):c.addEventListener&&c.addEventListener(a,b,!1)};g.getTagCookie=function(){return e.readCompressedCookie(r)};return e.lastSession=g};e.referrerIsSameAsPrevious=function(a,d,f){var h,g;return 0<a.length?(h=e.getReferrer(),g=b.getUrl().substring(0,300),a=a[a.length-1],a.url===h&&a.landing===g&&a.time+f>d):!1};e.isReferrerDifferent=function(){var a,b;b=e.getReferrer();a=b.indexOf("://");if(-1===a)return!0;try{return 0!==b.substring(a+
3).indexOf(e.getDomain())?!0:!1}catch(f){return!0}};e.getReferrer=function(){return document.referrer?document.referrer.substring(0,300):"direct"};e.getDomain=function(){return document.location.host}})();(function(){function a(c){e.setIfUnset(c,a.defaultConfig);if(this.singleton){var b=g.opentag.Utils.getObjectUsingPath(this.PACKAGE_NAME+"."+this.CLASS_NAME,f);if(b.__instance)return b.__instance;b.__instance=this}a.SUPER.call(this,c)}function b(a,d){var f=a.toString(),f=f.replace(/\s*function\s*\([\w\s,_\d\$]*\)\s*\{/,
""),f=f.substring(0,f.lastIndexOf("}")),f=f.replace(/(["']\s*\+\s*)\s*_*\w+\s*\.\s*valueForToken\s*\(\s*'([^']*)'\s*\)/g,'$1"${$2}"'),f=f.replace(/\s*_*\w+\s*\.\s*valueForToken\s*\(\s*'([^']*)'\s*\)(\s*\+\s*["'])/g,'"${$1}"$2'),f=f.replace(/(["']\s*\+\s*)\s*_*\w+\s*\.\s*valueForToken\s*\(\s*"([^"]*)"\s*\)/g,'$1"${$2}"'),f=f.replace(/\s*_*\w+\s*\.\s*valueForToken\s*\(\s*"([^"]*)"\s*\)(\s*\+\s*["'])/g,'"${$1}"$2'),f=f.replace(/(\s*)_*\w+\s*\.\s*valueForToken\s*\(\s*'([^']*)'(\s*)\)/g,"$1${$2}$3"),f=
f.replace(/(\s*)_*\w+\s*\.\s*valueForToken\s*\(\s*"([^"]*)"(\s*)\)/g,"$1${$2}$3"),f=d.replaceTokensWithValues(f);e.geval(f)}var e=g.opentag.Utils,h=g.Define;g.Define.clazz("qubit.opentag.LibraryTag",a,g.opentag.BaseTag);a.defaultConfig={vendor:null,imageUrl:null,description:"",async:!1,isPrivate:!1,upgradeable:!0,html:"",parameters:[],prePostWindowScope:!1};a.prototype.pre=function(){};a.prototype.post=function(){};a.prototype.before=function(){a.SUPER.prototype.before.call(this);try{var c=this.config;
if(c&&c.pre)if("function"===typeof c.pre)this.pre=c.pre;else{var d=this.replaceTokensWithValues(String(c.pre));this.pre=e.expressionToFunction(d).bind(this)}this.config.prePostWindowScope&&this.pre!==a.prototype.pre&&this.pre.toString?b(this.pre,this):this.pre()}catch(f){return!0}return!1};a.prototype.after=function(c){a.SUPER.prototype.after.call(this,c);try{var d=this.config;if(d&&d.post)if("function"===typeof d.post)this.post=d.post;else{var f=this.replaceTokensWithValues(String(d.post));this.post=
e.expressionToFunction(f).bind(this)}this.config.prePostWindowScope&&this.post!==a.prototype.post&&this.post.toString?b(this.post,this):this.post(c)}catch(h){}};a.define=function(c,b){c=c.replace(/^[\.]+/g,"").replace(/[\.]+$/g,"").replace(/\.+/g,".");c=g.Define.vendorsSpaceClasspath(c);var f={};b.getDefaultConfig&&(f=b.getDefaultConfig());var k=b.CONSTRUCTOR,l={},n;for(n in b)"config"!==n&&(l[n]=b[n]);l=g.opentag.Utils.defineWrappedClass(c,a,l,m,function(a){a=a||{};a=e.overrideFromBtoA(f,a);var c=
g.opentag.LibraryTag.call(this,a);k&&k.call(this,a);if(c)return c});n=h.STANDARD_VS_NS+".";0!==c.indexOf(n)&&e.namespace(n+c,l);return l};a.getLibraryByClasspath=function(a){return e.getObjectUsingPath(a,g.Define.getVendorSpace())}})();(function(){function a(){}var b=g.opentag.LibraryTag,e=g.Define;a.library=function(){return b.define.apply(b,arguments)};a.libraryRef=function(){return b.getLibraryByClasspath.apply(b.getLibraryByClasspath,arguments)};e.namespace("qubit.Quick",a)})();(function(){function a(c){this.runQueue=
[];this.tags={};this.config={cookieDomain:"",maxCookieLength:1E3,gzip:!0,delayDocWrite:!1,clientId:"",name:"",tellLoadTimesProbability:null,pingServerUrl:null,trackSession:null,disabled:!1,containerId:"",scanTags:!1,noPings:!1};this.ignoreTagsState=!1;if(c){this.setConfig(c);c.name||(this.config.name="Cont-"+q++);a.register(this);a.NO_PINGS&&(this.config.noPings=!0);this.ping=new g.opentag.Ping(this.config);var b=this.sendPings.bind(this);this._pingAsyncCallback=function(){k.setTimeout(b,5)};if(c.init)try{c.init.call(this,
c)}catch(d){}}return this}function b(a,c,d){a[d]&&(v[d]=v[d]||1,d+="("+v[d]+")",v[d]++);a[d]=c}var e=g.opentag.Utils,f=g.opentag.filter.BaseFilter,c=g.opentag.filter.Filter,d=g.opentag.BaseTag,k=g.opentag.Timed,m=g.opentag.Tags,l=g.opentag.Session,n=g.Cookie,q=1;try{window.opentag_consentGiven=function(){a.consentIsGiven=!0;for(var c=a.getContainers(),b=0;b<c.length;b++)try{c[b].run()}catch(d){}}.bind(this)}catch(t){}g.Define.clazz("qubit.opentag.Container",a);var x=[];a.register=function(a){e.addToArrayIfNotExist(x,
a)};a.prototype.isTellingLoadTimes=function(){var a=this.config.tellLoadTimesProbability;null===a&&(a=0);return a>Math.random()};a.prototype.destroy=function(a){this.destroyed=!0;this.unregister();if(a)for(var c in this.tags)a=this.tags[c],a instanceof d&&(a.destroy(),this.tags[c]=null,delete this.tags[c]);c=this.PACKAGE_NAME.split(".");c=c[c.length-1];a=e.getParentObject(this.PACKAGE_NAME);a[c]=null;delete a[c]};a.findContainersByName=function(a){for(var c=this.getContainers(),b=[],d=0;d<c.length;d++)c[d].config.name===
a&&b.push(c[d]);return b};a.getById=function(a){for(var c=this.getContainers(),b=0;b<c.length;b++)if(c[b].getContainerId()===a)return c[b];return null};a.prototype.unregister=function(c){a.unregister(this,c)};a.unregister=function(a,c){e.addToArrayIfNotExist(x,a);e.removeFromArray(x,a);if(c)for(var b in this.tags){var f=this.tags[b];f instanceof d&&(f.unregister(),this.tags[b]=null,delete this.tags[b])}};a.prototype.hasConsent=function(){return"Accepted"===n.get("qubitconsent")};a.prototype.register=
function(c){a.register(c||this)};a.getContainers=function(){return x};a.prototype.getContainers=function(){return a.getContainers()};a.prototype.onTagRegistered=function(a){};a.prototype.registerTag=function(a){var c=a.config.name;if(!this.tags[c]){this.tags[c]=a;try{this.onTagRegistered(a)}catch(b){}}};a.prototype.registerTags=function(a){for(var c=0;c<a.length;c++)this.registerTag(a[c])};a.prototype.setConfig=function(a){for(var c in a)this.config[c]=a[c]};a.prototype.run=function(){this.runTags({command:"runOnceIfFiltersPass"})};
a.prototype.runWithoutFilters=function(){this.runTags({command:"run"})};a.prototype.getTagByname=function(a){return this.tags[a]};a.prototype.containerScriptLoadedSynchronously=function(){var a,c,b,d,e;d=document.getElementsByTagName("script");a=0;for(c=d.length;a<c;a+=1)if(b=d[a],(e=b.getAttribute("src"))&&0<e.indexOf(""+this.config.clientId+"-"+this.getContainerId()+".js"))return null===b.getAttribute("async")&&(!1===b.getAttribute("defer")||""===b.getAttribute("defer")||null===b.getAttribute("defer"));
return!0};a.prototype.prepareSessionIfNeeded=function(){var b=this.config.trackSession;if(!0!==b&&!1!==b){var b=this.tags,d;for(d in b)if(b.hasOwnProperty(d)){var e=b[d];e.resolveAllDynamicData();for(var e=e.getFilters(),f=0;f<e.length;f++){var h=e[f];if(h instanceof c&&h.isSession()){this.trackSession=!0;break}}if(this.trackSession)break}}else this.trackSession=b;a.TRACK_SESSION&&(this.trackSession=!0);this.trackSession&&(this.session=l.setupSession(this))};a.prototype.runTags=function(c,b){if(this.destroyed)throw"Container has been destroyed.";
if(b||!a.LOCKED&&!e.global().QUBIT_CONTAINERS_LOCKED){if(this.onBeforeRun)try{this.onBeforeRun()}catch(d){}var f=!this.containerScriptLoadedSynchronously(),h="runIfFiltersPass";c&&c.command&&(h=c.command);this.runningStarted=(new Date).valueOf();var g={};this.config.scanTags&&!this._scanned&&(this.scanForTags(),this._scanned=(new Date).valueOf());this.prepareSessionIfNeeded();for(var m=this.getTagsInOrder(),l=0;l<m.length;l++)try{var n=m[l],p=n.config.name;if(this.includedToRun(n)){var y=n.resolveDependencies();
if(0<y.length)for(var q=0;q<y.length;q++){var r=y[q],t=r.config.name;!g[t]&&this.tags[t]&&(g[t]=r,this._tagRunner(r,h,f))}g[p]||(g[p]=n,this._tagRunner(n,h,f))}}catch(u){}k.setTimeout(function(){this.sendPingsNotTooOften()}.bind(this),1100);this.waitForAllTagsToFinish()}};a.prototype.getTagsInOrder=function(){var a=[],c;for(c in this.tags){var b=this.tags[c],d=b.config.priority;if(0<+d){for(var e=0,f=0;f<a.length;f++){var h=a[f];if(h)if(h=+h.config.priority,0<h&&h>d)e++;else break}a.splice(e,0,b)}else a.push(b)}return a};
a.prototype._tagRunner=function(a,c,b){try{this.includedToRun(a)&&(b&&(a.forceAsynchronous=!0),this.config.delayDocWrite&&(a.delayDocWrite=!0),a.session=a.session||this.session,a[c]())}catch(d){}};a.prototype.getContainerId=function(){if(this.config.containerId)return this.config.containerId;if(this._pkgName)return this._pkgName;var a=this.PACKAGE_NAME.split(".");return this._pkgName=a=a[a.length-1]};a.prototype.includedToRun=function(c){if(!c)return!1;var b=c.config;if(b.inactive||b.disabled&&!c.cookieSaysToRunEvenIfDisabled()||
c.disabledByCookie())return!1;b=a.consentIsGiven||!b.needsConsent||this.hasConsent();c=c.state===d.prototype.STATE.INITIAL;return this.ignoreTagsState||b&&c};a.prototype.scanForTags=function(a,c){a&&(this.tags={});var b;b=c&&"object"===typeof c?this.findAllTags(c):this.findAllTagsByClassPath();this.registerTags(b);return b};a.prototype.findAllTags=function(a,c){a=a||this.tagsPackageName||this.PACKAGE_NAME;return m.findAllTags(a,c)};a.prototype.findAllTagsByClassPath=function(a){a=a||this.PACKAGE_NAME;
return m.findAllTagsByClassPath(a)};a.prototype.findAllFilters=function(a,c){a=a||this.tagsPackageName||this.PACKAGE_NAME;return m.findAllFilters(a,c)};a.prototype.waitForAllTagsToFinish=function(){if(!this._waitForAllTagsToFinishWaiting){this._lastWaited||(this._lastWaited=(new Date).valueOf());var a=15E3<(new Date).valueOf()-this._lastWaited,a=this.allTagsFinished()||a;if(!this._showFinishedOnce&&a){if(this._lastWaited=null,this._showFinishedOnce=!0,this.runningFinished=(new Date).valueOf(),this.sendPingsNotTooOften(),
this.onTagsInitiallyRun)this.onTagsInitiallyRun()}else a||(this._waitForAllTagsToFinishWaiting=!0,this._showFinishedOnce=!1,k.setTimeout(function(){this._waitForAllTagsToFinishWaiting=!1;this.waitForAllTagsToFinish()}.bind(this),100))}};a.prototype.onTagsInitiallyRun=r;a.prototype.resetAllTags=function(){for(var a in this.tags)this.tags.hasOwnProperty(a)&&this.tags[a].reset()};a.prototype.reset=function(){this._showFinishedOnce=this.runningStarted=this._waitForAllTagsToFinishWaiting=this.runningFinished=
void 0;this.resetAllTags()};a.prototype.sendPingsNotTooOften=function(){this._sndLck=this._sndLck||{};k.runIfNotScheduled(this._pingAsyncCallback,2E3,this._sndLck)};a.prototype.sendPings=function(){if(!this.config.noPings){var a;if(this.isTellingLoadTimes()){var c=this.getAllTagsByState(),b=this,d;c.run&&(d=m.getLoadTimes(c.run),this.lastPingsSentTime=(new Date).valueOf(),this.ping.send(this,d));d=m.getLoadTimes();var e=[];for(a=0;a<d.length;a++)(function(a){a=d[a].tag;a.config.dedupe&&a.sendDedupePing&&
e.push(a)})(a);0<e.length&&(this.lastDedupePingsSentTime=(new Date).valueOf(),this.ping.sendDedupe(this,e));if(c.other){d=m.getLoadTimes(c.other);var f=[];for(a=0;a<d.length;a++)(function(a){var c=d[a].tag;f.push(d[a]);var e=c.onAfter;c.onAfter=function(a){e.call(c,a);b.sendPingsNotTooOften()}})(a);0<f.length&&this.ping.send(this,f)}if(c.awaiting){d=m.getLoadTimes(c.awaiting);var h=[];for(a=0;a<d.length;a++)(function(a){var c=d[a].tag;h.push(d[a]);var e=c.onAfter;c.onAfter=function(a){e.call(c,a);
b.sendPingsNotTooOften()}})(a);0<h.length&&this.ping.send(this,h)}}}};a.prototype.getAllTagsByState=function(){return a.getAllTagsByState(this.tags)};a.getAllTagsByState=function(a){var c=null,e=null,g=null,k=null,m=null,l=null,n=d.prototype.STATE.EXECUTED_WITH_ERRORS,p;for(p in a){var q=a[p];if(q instanceof d){var r=q.config.name;0<q.scriptExecuted?(c=c||{},b(c,q,r)):q.locked?(l=l||{},b(l,q,r)):0>q.scriptExecuted||q.state>=n?(k=k||{},b(k,q,r)):q.filtersState()===f.state.SESSION||0<q.filtersState()?
(g=g||{},b(g,q,r)):q.config.needsConsent?(m=m||{},b(m,q,r)):(e=e||{},b(e,q,r))}}return{run:c,failed:k,awaiting:g,consent:m,locked:l,other:e}};var v={};a.prototype.allTagsFinished=function(){for(var a in this.tags)if(this.tags.hasOwnProperty(a)){var c=this.tags[a];if(c instanceof g.opentag.BaseTag){var b=c.filtersState();if(!c.config.disabled){var d=0>c.filtersState()&&!c.locked,e=!(c.finished()||c.config.runner&&!c.isRunning);if(d&&e&&(c=0<+c.awaitingDependencies,b!==f.state.SESSION&&!c))return!1}}}return!0};
a.prototype.getPageVariables=function(){var a=[],c;for(c in this.tags)if(this.tags.hasOwnProperty(c))for(var b=this.tags[c].getPageVariables(),d=0;d<b.length;d++)e.addToArrayIfNotExist(a,b[d]);return a};a.getPageVariableByName=function(a){for(var c=this.getAllPageVariables(),b=[],d=0;d<c.length;d++)c[d].config.name===a&&b.push(c[d]);return b};a.prototype._getCookieNameForDisabling=function(){return"qubit.opentag.disableContainerRunning_"+this.getContainerId()+this.config.name};a.prototype.disabledByCookie=
function(){return!!n.get(this._getCookieNameForDisabling())};a.prototype.setCookieToDisable=function(){n.set(this._getCookieNameForDisabling(),"true")};a.prototype.rmCookieToDisable=function(){n.rm(this._getCookieNameForDisabling())};a.rmAllDisablingCookies=function(){e.rmCookiesMatching("qubit.opentag.disableContainerRunning_")};a.setCookieForDisabledContainersToRun=function(){n.set("qubit.opentag.forceContainerRunning","true")};a.rmCookieForDisabledContainersToRun=function(){n.rm("qubit.opentag.forceContainerRunning")}})();
(function(){function a(e){b.setIfUnset(e,{url:null,html:"",locationPlaceHolder:"NOT_END",locationObject:"BODY",async:!0});a.SUPER.call(this,e)}var b=g.opentag.Utils;g.Define.clazz("qubit.opentag.CustomTag",a,g.opentag.LibraryTag)})();(function(){var a={callbacks:{},unfired_events:[],early_callbacks:null,currentUV:null},b,e="universal_variable";a._isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)};a._targetChanged=function(b,c,d){if(null===d)return"null"===c?!1:!0;if(void 0===
d)return c===d?!1:!0;c=x.parse(c);c=a._getNested(c,b);b=a._getNested(d,b);return!a._jsonIsEqual(c,b)};a._processCallbacks=function(){var b;if(a.early_callbacks&&0<a.early_callbacks.length){for(b=0;b<a.early_callbacks.length;b+=1)a.push(a.early_callbacks[b]);a.early_callbacks=null}};a._keyStringToArr=function(a){a=a.replace(/^\s+/,"").replace(/\s+$/,"");if(""===a)return[];a=a.replace(/\[(\w+)\]/g,".$1");a=a.replace(/^\./,"");return a.split(".")};a._getNested=function(b,c){for(var d=a._keyStringToArr(c),
e;0<d.length;)if(e=d.shift(),b.hasOwnProperty(e))b=b[e];else return;return b};a._jsonIsEqual=function(b,c){"string"!==typeof b&&(b=x.stringify(b,a._stripEvents));"string"!==typeof c&&(c=x.stringify(c,a._stripEvents));return b===c};a._stripEvents=function(a,c){if("events"!==a)return c};a._on=function(b,c){var d;d=b.split(":");b=d[0];d=d[1];a.callbacks[b]=a.callbacks[b]||[];d?a.callbacks[b].push({keyString:d,func:c}):a.callbacks[b].push({func:c})};a._trigger=function(e,c){var d,f;if(a.callbacks[e])for(d=
0;d<a.callbacks[e].length;d+=1)"function"===typeof a.callbacks[e][d].func&&((f=a.callbacks[e][d].keyString)?"change"===e&&a._targetChanged(f,a.currentUV,b)&&a.callbacks[e][d].func(c):a.callbacks[e][d].func(c))};a._eventsPush=function(e){var c,d;b.events[b.events.length]=e;e.time=e.time||(new Date).getTime();if(a.callbacks.event)for(c=0,d=a.callbacks.event.length,c;c<d;c+=1)a.callbacks.event[c].func(e);e.has_fired=!0};a._getUnfiredEvents=function(){for(var e=0,e=0;e<b.events.length;e+=1)b.events[e].has_fired||
(a.unfired_events.push(b.events.splice(e,1)[0]),e-=1)};a._fireEvents=function(){for(;0<a.unfired_events.length;)b.events.push(a.unfired_events.shift())};a._resetEventsPush=function(){b.events=b.events||[];-1!==b.events.push.toString().indexOf("[native code]")&&(b.events.push=a._eventsPush,a._getUnfiredEvents(),a._fireEvents())};a._checkForChanges=function(){a.callbacks.change&&0<a.callbacks.change.length&&!a._jsonIsEqual(a.currentUV,b)&&(a._trigger("change",b),a.currentUV=x.stringify(b,a._stripEvents))};
a._setUVLocation=function(b){e=b;a._initUV()};a._initUV=function(){window[e]=window[e]||{events:[]};b=window[e];b.events||(b.events=[])};a.push=function(b){a._isArray(b)&&("on"===b[0]?a._on(b[1],b[2]):"trigger"===b[0]&&b[1]&&a._trigger(b[1]))};a.init=function(b,c){c&&(e=c);a._initUV();!window.uv_listener||a._isArray(window.uv_listener)?(a.early_callbacks=window.uv_listener||null,window.uv_listener=a,b||a.start()):c&&window.uv_listener._setUVLocation(e)};a.start=function(){a.currentUV=x.stringify(b,
a._stripEvents);setInterval(function(){a._initUV();a._resetEventsPush();a._checkForChanges()},500);a._processCallbacks()};t.UVListener=a})();(function(){function a(){}function b(a,d,e){!e||void 0!==a[d]&&""!==a[d]&&null!==a[d]||(a[d]=e)}var e=g.Cookie,f=g.opentag.Utils;a.run=function(){var c=!1,b;b=0<=document.location.href.indexOf("opentag_disabled=true")?!0:!1;if(!b){b=!1;if(e.get("opentag_debug_tool")||0<=document.location.href.indexOf("opentag_debug_tool"))b=!0;!b&&(b=!1,e.get("opentag_debug")||
0<=document.location.href.indexOf("opentag_debug"))&&(b=!0);b&&(m.TAGSDK_NS_OVERRIDE=g.DEBUG_MODE?!1:!0,c=!0);g.DEBUG_MODE&&(m.TAGSDK_NS_OVERRIDE=!1);try{t.UVListener.init()}catch(f){}a.runAllContainers(c)}};a.runAllContainers=function(c){try{for(var d=g.opentag.Container.getContainers(),e=0;e<d.length;e++){var k=d[e],l=k.config;if(!k.runningStarted&&!k.configuredInMain){l.scanTags=!0;var n=f.getParentObject(k.PACKAGE_NAME).ClientConfig;n&&b(k.config,"clientId",n.id);var q=f.getParentObject(k.PACKAGE_NAME).SystemDefaults;
q&&(b(l,"pingServerUrl",q.pingServerUrl),b(l,"tellLoadTimesProbability",q.tellLoadTimesProbability));k.configuredInMain=!0;c?(k.destroy(!0),a.loadDebugVersion(k)):m.QUBIT_OPENTAG_STOP_MAIN_EXECUTION?function(){var a=g.opentag.RUN_STOPPED_EXECUTON;g.opentag.RUN_STOPPED_EXECUTON=function(){try{a&&a()}finally{k.run()}}}(k):k.run()}}}catch(r){}};a.loadDebugVersion=function(a){var b=document.createElement("script"),e,f=a.config.scriptURL,h;(h=g.opentag.Utils.getParentObject(a.PACKAGE_NAME).ClientConfig)&&
h.clientId?h=h.clientId:(h=a.PACKAGE_NAME.split("."),h=h[h.length-2].substring(1));a=a.getContainerId();f&&(e=f,e.lastIndexOf("-debug.js")!==e.length-9&&(e=e.substring(0,e.length-3),e+="-debug.js"));b.src=e&&"//d3c3cq33003psk.cloudfront.net/opentag-"+h+"-"+a+"-debug.js"!==e?e:"//s3-eu-west-1.amazonaws.com/opentag/opentag-"+h+"-"+a+"-debug.js";document.getElementsByTagName("head")[0].appendChild(b)};g.Define.namespace("qubit.opentag.Main",a)})();(function(){function a(b){a.SUPER.apply(this,arguments)}
g.Define.clazz("qubit.opentag.pagevariable.UniversalVariable",a,g.opentag.pagevariable.Expression)})()})();function fitTextarea(b){"textarea"===b.tagName.toLowerCase()&&(b.style.overflow="hidden",b.style.height="0px",b.scrollHeight,b.style.height=25+b.scrollHeight+"px",b.style.overflow="")}function nextNode(b){for(;!b.tagName;)b=b.nextSibling;return b}
function toggleShowSibling(b,k){for(var f=k||b.nextSibling;f&&!f.style;)f=f.nextSibling;if(f){var m=!1;f.cmNode&&"none"===f.cmNode.style.display?(f.cmNode.style.display="",m=!0):f.cmNode||"none"!==f.style.display?(f.style.display="none",f.cmNode&&(f.cmNode.style.display="none")):(f.style.display="",m=!0,"TEXTAREA"===f.tagName&&attachEditor(f),fitTextarea(f));(f=b.children[0])&&"true"===f.getAttribute("plus")&&(f.innerHTML=m?"-":"+")}}
function attachEditor(b){b.cm=CodeMirror.fromTextArea(b,{lineNumbers:!0,mode:"javascript",theme:"ambiance",tabMode:"indent",matchBrackets:!0,extraKeys:{"Ctrl-Q":function(b){b.foldCode(b.getCursor())}},foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"]});b.cm.on("change",function(){b.value=b.cm.getValue()});b.cmNode=b.nextSibling}
function getParametersAndConfigForTagNode(b,k,f){var m=b.getElementsByTagName("input");b=b.reference.config;for(var l=0;l<m.length;l++){if(!k&&-1!==m[l].className.indexOf("red"))return"red";if(void 0!==m[l].pindex){var g=m[l].pindex;b.parameters[g].inputVariable=m[l].value;b.parameters[g].variable=void 0;if(m[l].value)try{var n=qubit.opentag.Utils.gevalAndReturn(m[l].value),n=n?n.result:n;b.parameters[g].variable={value:n}}catch(q){logError("Error reading configuration"+q)}}else if(!f&&void 0!==m[l].cname)switch(g=
m[l].cname,g){case "url":case "html":case "urlLocation":case "vendor":case "imageUrl":case "url":b[g]=m[l].value;break;default:try{b[g]=qubit.opentag.Utils.gevalAndReturn(m[l].value).result}catch(r){}}}return f?{parameters:b.parameters}:b}function applyParametersAndConfigToTag(b,k){b.parameters=k.parameters;for(var f in k)b[f]=k[f]}
function classPath(b){if(b){b=b.split(".");for(var k=0;k<b.length;k++){var f=b[k],f=f.replace(/\s+/g,"_"),f=f.replace(/[\W+]/g,"");f.match(/^\d+/)&&(f="_"+f);b[k]=f}return b.join(".").replace(/^[\.]+/g,"").replace(/[\.]+$/g,"").replace(/\.+/g,".")}return b}function getLibraryReferenceNode(b){for(;null!==b&&!b.reference;)b=b.parentNode;return b}window.__tmp__qubit__test_page_8_=null;
function extractFunctionOrString(b){var k=qubit.opentag.Utils.trim(b);return 0===k.indexOf("function")?(qubit.opentag.Utils.geval("window.__tmp__qubit__test_page_8_="+k),window.__tmp__qubit__test_page_8_):b}var IS_IE=!1;-1!==navigator.appName.indexOf("Internet Explorer")&&(IS_IE=!0);
function getXMLHttpRequest(){var b;try{b=new ActiveXObject("Microsoft.XMLHTTP")}catch(k){try{b=new ActiveXObject("Msxml2.XMLHTTP")}catch(f){try{b=new XMLHttpRequest}catch(m){throw"Your browser does not support AJAX!";}}}IS_IE?window.onerror=function(){}:b.onerror=function(){};return b}
function GET(b,k,f){var m=getXMLHttpRequest();m.onreadystatechange=function(){4===m.readyState&&k(m.responseText,m)};f=void 0===f?!0:f;try{m.onerror=function(b){logError("Error while sending GET:"+b)}}catch(l){}b=fakeParam(b);m.open("GET",b,f);m.send()}
function POST(b,k,f,m){var l=getXMLHttpRequest();l.onreadystatechange=function(){4===l.readyState&&f(l.responseText,l)};m=void 0===m?!0:m;try{l.onerror=function(b){logError("Error while sending POST:"+b)}}catch(g){}b=fakeParam(b);l.open("POST",b,m);l.setRequestHeader("Content-type","application/x-www-form-urlencoded");l.send(k)}function fakeParam(b){return b&&-1!==b.lastIndexOf("?")?b+"&fparam="+(new Date).getTime()*Math.random():b+"?fparam="+(new Date).getTime()*Math.random()}
function theProgressBar(b,k){var f=!1,m=document.getElementById("progress-bar-template").innerHTML;if(f)return!1;theProgressBar.title=b;var f=!0,l=document.createElement("div");l.className="progress-bar";l.innerHTML=m;document.body.appendChild(l);l.bar=l.children[0].children[0];l.titleNode=l.bar.children[0];l.titleNode.innerHTML=theProgressBar.title;l.progress=l.bar.children[1];var g=function(){var b=k();100<=b?(l.titleNode.innerHTML=theProgressBar.title+" 100% Done.",l.progress.style.width="100%",
setTimeout(function(){f=!1;document.body.removeChild(l)},200)):(l.titleNode.innerHTML=theProgressBar.title+" "+Math.floor(b)+"%",l.progress.style.width=Math.floor(b)+"%",setTimeout(g,20))};g();return!0}
function qconsole(){this.init=function(){if(!this.initialized){this.initialized=!0;var b=document.getElementById("console-template").innerHTML;this.container=document.createElement("div");this.container.className="qconsole";this.container.innerHTML=b;this.msgContainer=this.container.children[1];document.body.appendChild(this.container);this.msgContainer.scrollTop=this.msgContainer.scrollHeight;var k=this;this.container.ondblclick=function(){info("[double click] Clearing & hiding console...");k.clear();
k.hide()}}};this.log=function(b){var k=document.getElementById("console-msg-template").innerHTML,f=document.createElement("div");f.className="msg";f.innerHTML=k;f.msg=f.children[1];f.header=f.children[0];f.msg.innerHTML=" >>> "+b;this.msgContainer.appendChild(f);this.msgContainer.scrollTop=this.msgContainer.scrollHeight};this.clear=function(){this.msgContainer.innerHTML=""};this.show=function(){qubit.opentag.Utils.addClass(this.container,"shown");qubit.opentag.Utils.removeClass(this.container,"hidden");
this.hidden=!1};this.hide=function(){qubit.opentag.Utils.removeClass(this.container,"shown");qubit.opentag.Utils.addClass(this.container,"hidden");this.hidden=!0};this.init()}var Utils=qubit.opentag.Utils;
function runTagHandler(b){var k=getParametersAndConfigForTagNode(b);if("red"===k)logError("Please fill all highlighed parameter values.\n They are required for tag to run.",2E3);else{var f=APP_PATH+"getClassPath?classPath=libraries."+b.reference.PACKAGE_NAME+".local&file=UVConf.js";GET(f,function(m,l){var g=!0;200!==l.status&&(g=!1,log("UVConfig not found. Proceeding normally."));try{g&&(log("Evaluating UVConf.js from "+f),qubit.opentag.Utils.geval(m))}catch(n){error("Exception while running UVConf.js: "+
n)}finally{runTag(b,k)}})}}
function runTag(b,k){try{var f={},m=b.classReference,l=b.reference;applyParametersAndConfigToTag(f,k);try{for(var g=f.parameters,n=0;n<g.length;n++)for(var q=g[n],r=0;r<l.config.parameters.length;r++){var t=l.config.parameters[r];if(t.token===q.token){q.uv=t.uv;break}}}catch(x){}var a=l.preNode.value;String(a)!==l.config.pre&&String(a)!==String(l.pre)&&(f.pre=extractFunctionOrString(a));var y=l.postNode.value;String(y)!==l.config.post&&String(y)!==String(l.post)&&(f.post=extractFunctionOrString(y));
var e=l.scriptNode.value;String(e)!==l.config.script&&String(e)!==String(l.script)&&(f.script=extractFunctionOrString(e));var h=new m(f);info("triggering run() for "+h.config.name+" ...");h.run();info("Currently executed tag instance is exposed as <pre>window.instance<pre>Please open web console to see more logs.<br/>To view library the logs run:<pre>instance.log.rePrint(5);</pre>in web console.",5E3);window.instance=h}catch(c){logError("Error while executing configuration:"+c)}}
function saveConfig(b){b=getLibraryReferenceNode(b);var k=b.reference;b=getParametersAndConfigForTagNode(b,!0,!0);for(var f=0;f<b.parameters.length;f++)b.parameters[f].variable=void 0,delete b.parameters[f].variable;b=json.serialize({parameters:b.parameters},{prettyPrint:!0});f=k.PACKAGE_NAME+".local";b=encodeURIComponent("//:include tagsdk-current.js\n"+("qubit.opentag.Utils.namespace('"+f+"');\n")+f+".Config = "+b+";");POST(APP_PATH+"saveConfig","classPath=libraries."+k.PACKAGE_NAME+".local&config="+
b,function(b,f){var g=qubit.opentag.Utils.gevalAndReturn(b);g&&g.result.ok?info("Saved"):logError(b)})}
function saveNewVersion(b,k){(k||window.event).ignoreEvent=!0;b=getLibraryReferenceNode(b);var f=b.reference,m=prompt("Please enter the name of the new version, eg 'v1'.\n\n");if(m){var m=classPath(m),f=f.PACKAGE_NAME,l=f.split(".");POST(APP_PATH+"saveNewVersion","location=libraries&classPath="+f+"&version="+(l[0]+"."+l[1])+"."+m,function(b,f){var k=qubit.opentag.Utils.gevalAndReturn(b);k&&k.result.ok?(info("Created new version."),info("Rebuilding system...",1E4),rebuildAndReload()):logError("Error while creating new version: "+
b)})}}function rebuildAndReload(){if(window.buildLocationString){var b="path="+encodeURIComponent(window.buildLocationString);GET(APP_PATH+"rebuild?"+b,function(b,f){var m=qubit.opentag.Utils.gevalAndReturn(b);m&&m.result.ok?(info("System has been rebuilt for "+window.buildLocationString,1E4),info("Reloading page."),location.reload()):logError("Rebuild failed! "+b)})}}var editUVURL=LIBRARIES_REPO_LOC+"shared/templates/UVConf.js";
function editUVURLHandler(b){GET(editUVURL,function(k,f){200!==f.status?logError(k):editUV(b,k)})}function editUV(b,k){openInEditorAndCreate("libraries."+b.reference.PACKAGE_NAME+".local","UVConf.js",!0,k)}function openInEditorHandler(b){openInEditorAndCreate("libraries."+b.reference.PACKAGE_NAME,"Tag.js",!1)}
function openInEditorAndCreate(b,k,f,m){m="classPath="+b+"&file="+k+"&create="+!!f+"&data="+encodeURIComponent(m);POST(APP_PATH+"openInEditor",m,function(b,f){var k=qubit.opentag.Utils.gevalAndReturn(b);k&&k.result.ok||(logError(b),logError("Make sure that CLASSPATH of your library matches its location!"))})}
function reloadTagHandler(b){var k=qubit.opentag.Utils,f=b.reference,m=b.libraryWidget,l=b.classReference.versionClassPath,g="classPath=libraries."+f.PACKAGE_NAME+"&file=Tag.js";reloadTests(b);POST(APP_PATH+"getClassPath",g,function(g,q){200!==q.status&&logError("Error loading tag: "+g);try{var r=getParametersAndConfigForTagNode(b,!0,!0);try{k.getObjectUsingPath(f.PACKAGE_NAME).Tag=void 0}catch(t){}qubit.opentag.Utils.geval(g);var x=k.getObjectUsingPath(f.PACKAGE_NAME+".Tag");x.versionClassPath=l;
m.renderLibraryToNode(x,null,null,r)}catch(a){logError("Error loading tag: "+a)}})}function cancelEvent(b){b.stopPropagation?b.stopPropagation():b.cancelBubble=!0}var Utils=qubit.opentag.Utils,testSuiteCodeTemplateURL=LIBRARIES_REPO_LOC+"shared/templates/TestsSuite.js";function addEditTests(b){GET(testSuiteCodeTemplateURL,function(k,f){200!==f.status?logError(k):addEditStandardTests(b,k)})}
function addEditStandardTests(b,k){if(b=getLibraryReferenceNode(b)){var f=b.reference,m=k.replace("_PACKAGE_",f.PACKAGE_NAME),m=m.replace("_TAG_",f.PACKAGE_NAME+".Tag"),l=f.PACKAGE_NAME.split(".").join("/"),m=m.replace("_TAGPATH_",l+"/Tag.js");openInEditorAndCreate("libraries."+f.PACKAGE_NAME+".local","TestsSuite.js",!0,m)}}var bddSuiteCodeTemplateURL=LIBRARIES_REPO_LOC+"shared/templates/BDDSuite.js";
function addEditDescribeTests(b){GET(bddSuiteCodeTemplateURL,function(k,f){200!=f.status?logError(k):addEditBDDTests(b,k)})}function addEditBDDTests(b,k){if(b=getLibraryReferenceNode(b)){var f=b.reference,m=k.replace("_PACKAGE_",f.PACKAGE_NAME),m=m.replace("_TAG_",f.PACKAGE_NAME+".Tag"),l=f.PACKAGE_NAME.split(".").join("/"),m=m.replace("_TAGPATH_",l+"/Tag.js");openInEditorAndCreate("libraries."+f.PACKAGE_NAME+".local","BDDSuite.js",!0,m)}}function reloadTests(b){_reloadTest(b,"BDDSuite.js")}
function _reloadTest(b,k){var f=qubit.opentag.Utils,m=b.reference,l=b.libraryWidget;POST(APP_PATH+"getClassPath","classPath=libraries."+m.PACKAGE_NAME+".local&file="+k,function(g,k){200!==k.status&&log("Error loading test (probably no tests). "+g);try{var q=getParametersAndConfigForTagNode(b,!0,!0);try{f.getObjectUsingPath(m.PACKAGE_NAME).local.TestsSuite=void 0}catch(r){}qubit.opentag.Utils.geval(g);var t=f.getObjectUsingPath(m.PACKAGE_NAME+".Tag");l.renderLibraryToNode(t,null,null,q)}catch(x){log("Error loading test: "+
x)}finally{reloadBDDTests(b)}})}
function reloadBDDTests(b){var k=qubit.opentag.Utils,f=b.reference,m=b.libraryWidget;POST(APP_PATH+"getClassPath","classPath=libraries."+f.PACKAGE_NAME+".local&file=BDDSuite.js",function(l,g){200!==g.status&&log("Error loading test (probably no tests). "+l);try{var n=getParametersAndConfigForTagNode(b,!0,!0);try{k.getObjectUsingPath(f.PACKAGE_NAME).local.BDDSuite=void 0}catch(q){}qubit.opentag.Utils.geval(l);var r=k.getObjectUsingPath(f.PACKAGE_NAME+".Tag");m.renderLibraryToNode(r,null,null,n)}catch(t){log("Error loading test: "+
t)}})}var testsRunning=!1;
function runAllTests(b){if(testsRunning)info("Wait for currently running tests to finish.");else{testsRunning=!0;for(var k=document.getElementsByTagName("div"),f=0,m=0,l=[],g=0;g<k.length;g++){var n=k[g];"true"===n.getAttribute("library-node")&&(++f,l.push(n))}var q=function(g){try{var k=l[g];k&&runTestsHandler(k,function(){++m;m<f&&setTimeout(function(){q(m)},5);m===f&&(testsRunning=!1,b&&b())})}catch(n){}};q(0);theProgressBar("Running test suites...",function(){return 0===m?0:m/f*100})}}
function runTestsHandler(b,k){try{var f=b.reference,m=qubit.opentag.Utils,l=m.getObjectUsingPath(f.PACKAGE_NAME+".local.TestsSuite"),g=m.getObjectUsingPath(f.PACKAGE_NAME+".local.BDDSuite"),n=function(){var f=!1;l&&!l.isFinished()?f=!0:g&&!g.isFinished&&(f=!0);if(!f){f=!1;if(g)for(var n=g.children,q=0;q<n.length;q++)if("failed"===n[q].result.status){f=!0;break}n=!1;l&&l.failedTests&&0<l.failedTests.length&&(n=!0);if(g||l)n||f?m.addClass(b,"tests-failed"):m.addClass(b,"tests-passed");k&&k()}};l||g?
(l&&runSuite(l,n),g&&runBDDSuite(g,n)):(k&&k(),m.addClass(b,"tests-notests"),log("No tests detected for "+f.config.name))}catch(q){logError("Error while executing tests suite:"+q)}}function runSuite(b,k){b?(b.onFinished=function(){k&&k()},b.run()):k&&k()}function runBDDSuite(b,k){if(b){var f=b.resultCallback;b.resultCallback=function(){f.apply(b,arguments);b.isFinished=!0;if(k)try{k()}catch(m){window.log("Error while running test:"+m)}};b.execute()}else k&&(b.isFinished=!0,k())}Utils=qubit.opentag.Utils;
function toggleUVSelector(b){"Close UV Browser"===b.innerHTML?(document.getElementById("uv-selector-holder").innerHTML="",b.innerHTML="Browse UV"):(openUVVariableSelector(),b.innerHTML="Close UV Browser")}function openUVVariableSelector(){var b=document.getElementById("uv-selector-holder");b.innerHTML="";renderUVSelector(b)}var uvPopupTemplate=document.getElementById("uv-popup-template").innerHTML;
function renderUVSelector(b,k){b.innerHTML="";var f=document.createElement("div");f.innerHTML=uvPopupTemplate;b.appendChild(f);var m=f.children[0].children[1].children[0].children[0],l=f.children[0].children[2];loadUVVariables(function(){for(var b=window.UVS,f=0;f<b.length;f++)(function(b){b.onclick=function(){l.value=b.expr;l.className="result";k&&k(b.expr)}})(renderUVSelectorItemYoNode(m,b[f]))})}var uvPopupItemTemplate=document.getElementById("uv-popup-item-template").innerHTML;
function renderUVSelectorItemYoNode(b,k){var f=document.createElement("div");f.innerHTML=uvPopupItemTemplate;var m=f.children[0].children[1];f.children[0].children[0].innerHTML=k.name;m.innerHTML=k.description;f.expr=k.expression;b.appendChild(f);return f}
function loadUVVariables(b){window.UVS?b&&b(UVS):GET(LIBRARIES_REPO_LOC+"shared/bin/html/data/uv.data",function(k,f){200!==f.status&&log("Error loading UV data: "+k);try{for(var m=k.split("\n"),l=[],g={},n=0;n<m.length;n++){var q=m[n].split("\t"),r={name:q[1],expression:q[2],description:q[3]};g[r.expression]=r;l.push(r)}window.UVS=l;window.EUVS=g;b(l)}catch(t){logError("Error loading UVs: "+t)}})}
(function(){function b(a,b){for(var e=0;e<b.length;e++)if("function"===typeof b[e]&&a instanceof b[e])return!0;return!1}function k(a,b){for(var e=0;e<b.length;e++)if(typeof a===b[e])return!0;return!1}function f(a,b){for(var e=0;e<b.length;e++)b[e]===a&&b.splice(e,1);return b}function m(a){return'"'+a.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"'}function l(a,b){return a?" "+b:b}function g(a,b,e,f,c){var d=" ";""===e&&(d="");return(e||f?0===c.length?[d,a,c.join(","),b]:[d,a,"\n",e,q,c.join(",\n"+
e+q),"\n",e,b]:[a,c.join(","),b]).join("")}var n={};n.checkIfInstanceOf=b;var q="  ",r=function(a,n,e,h,c){if(isNaN(c)||!(h>=c)){var d,t,p,x,u=!1,B,C=!0,H=!1,v=!1,s=!1,z=!1;n&&(n.prettyPrint&&(z=!0),n.raw&&(H=n.raw),n.excludedInstances&&(d=n.excludedInstances),n.excludedTypes&&(t=n.excludedTypes),n.excludedNames&&(p=n.excludedNames),n.own&&(x=n.hasOwn),n.fakeFunctions&&(v=n.fakeFunctions),n.realFunctions&&(s=n.realFunctions),n.includeFunctions&&(u=n.includeFunctions),n.excludeOnTrue&&(B=n.excludeOnTrue),
n.dateAsString&&(C=n.dateAsString));var A="",w="";if(z){for(z=0;z<h;z++)A+=q;w="\n"}if(a instanceof Date)return!H||C?m(a.toISOString()):a.valueOf();if(u||"function"!==typeof a){if("number"===typeof a)return l(A,String(a));if("string"===typeof a)return l(A,m(a));if(null===a)return l(A,"null");if(void 0===a)return H?l(A,"undefined"):void 0;if("boolean"===typeof D)return l(A,String(a));if(u&&"function"===typeof a&&v)return"(function(){})";if(u&&"function"===typeof a&&s)return l(A,a.toString());a:{if(a instanceof
Object)for(D=0;D<e.length;D++)if(e[D]===a){D=!0;break a}D=!1}if(!D){e.push(a);++h;if(a instanceof Array){p=[];for(z=0;z<a.length;z++){if(B)try{if(B(a))continue}catch(N){}if(!d||!b(a,d))if(!t||!k(a,t)){try{var F=r(a[z],n,e,h,c)}catch(K){return f(a,e),m(String(K))}void 0!==F&&p.push(F)}}f(a,e);return g("[","]",A,w,p)}var F=[],G;for(G in a){var D=a[G];if(!x||a.hasOwnProperty(G)){if(B)try{if(B(a))continue}catch(O){}if(!d||!b(D,d))if(!t||!k(D,t)){if(u=p)a:{for(u=0;u<p.length;u++)if(G===p[u]){u=!0;break a}u=
!1}if(!u)try{var J=r(D,n,e,h,c);if(void 0!==J){var L='"'+G.replace(/\"/g,'\\"')+'":'+J;F.push(L)}}catch(M){return f(a,e),m(String(M))}}}}f(a,e);return g("{","}",A,w,F)}}}};n.serialize=function(a,b){var e;b&&(e=b.level);return r(a,b,[],0,e)};var t=(0,eval("this"))||function(){return this}()||this.window;n.parse=function(a){if(/[^,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]/.test(a.replace(/"(\\.|[^"\\])*"/g,"")))throw"insecure json!";a="json.___tmp = ("+a+")";t.execScript?t.execScript(a):t.eval.call(t,a);return n.___tmp};
t.json=n;try{module.exports=n}catch(x){}})();
(function(){function b(b){b&&(this.parentContainer=b.parentContainer,this.container=b.container,this.className=b.className,this.maxTime=b.maxTime,this.closeable=b.closeable,this.init())}b.prototype.init=function(){this.container=this.container||document.createElement("div");this.container.className+=" qubit-notification "+(this.className?this.className:"")};b.prototype.drawCloseButton=function(){var b=this;this.closeable&&(this.closeButton=document.createElement("div"),0===this.container.childNodes.length?
this.container.appendChild(this.closeButton):this.container.insertBefore(this.closeButton,this.container.childNodes[0]),this.closeButton.className="notification-close-button",this.closeButton.onclick=function(){b.destroy()})};b.prototype.show=function(){this.container.style.display=""};b.prototype.hide=function(){this.container.style.display="none"};b.prototype.setContent=function(b){this.content!==b&&(this.content=b,this.container.innerHTML="","object"===typeof b?this.container.appendChild(b):this.container.innerHTML=
b,this.drawCloseButton());return b};b.prototype.paint=function(){this.painted||(this.parentContainer.appendChild(this.container),this.painted=!0)};b.prototype.destroy=function(){try{if(this.onDestroy)this.onDestroy()}finally{this.container.parentNode&&this.container.parentNode.removeChild(this.container)}};window.Notification=b})();
(function(){function b(b){b&&(this.maxTime=+b.maxTime||6E4,this.notifiers={},this.className=b.className,this.parentContainer=b.parentContainer||document.body,this.container=b.container||document.createElement("div"),this.init())}var k=window.Notification;b.prototype.notify=function(b,m,l,g,n){if(!this.notifiers[b]){l=new k({parentContainer:this.container,maxTime:l,className:g,closeable:n});var q=this;l.onDestroy=function(){delete q.notifiers[b]};this.notifiers[b]=l;l.paint()}this.notifiers[b].show();
this.notifiers[b].setContent(m);this.notifiers[b].timestamp=(new Date).valueOf()};b.prototype.done=function(b,k,l){this.notify(b,k);var g=this;setTimeout(function(){g.notifiers[b]&&(g.notifiers[b].destroy(),delete g.notifiers[b])},l)};b.prototype.init=function(){this.setParentContainer(this.parentContainer);var b=this,k;k=function(){b.container&&b.container.parentNode&&(b.oldNotifiersCheck(),setTimeout(k,500))};k()};b.prototype.setParentContainer=function(b){this.parentContainer=b;this.parentContainer.appendChild(this.container);
this.container.className.lastIndexOf(" qubit-notificationmanager"===-1)&&(this.container.className+=" qubit-notificationmanager "+this.className)};b.prototype.oldNotifiersCheck=function(){var b,k;for(b in this.notifiers)this.notifiers.hasOwnProperty(b)&&(k=this.notifiers[b].maxTime||this.maxTime,(new Date).valueOf()-this.notifiers[b].timestamp>k&&this.notifiers[b].destroy())};b.prototype.clear=function(){for(var b in this.notifiers)this.notifiers.hasOwnProperty(b)&&this.notifiers[b].destroy()};window.NotificationManager=
b})();var Utils=qubit.opentag.Utils,parameterTemplate=document.getElementById("parameter-template").innerHTML,parametersTemplate=document.getElementById("parameters-template").innerHTML;function Parameters(b){b&&(this.config=b,this.init())}Utils.clazz("ui.Parameters",Parameters);Parameters.prototype.paint=function(){this.painted=!0;this.config.parentContainer.appendChild(this.container)};
Parameters.prototype.init=function(){var b=document.createElement("div");b.innerHTML=parametersTemplate;b.className="parameters-container";this.container=b;for(var k=b.children[1].children[0],f=b.children[1].children[1],m=this.config.params,l=0;l<m.length;l++){var b=document.createElement("div"),g=m[l];b.innerHTML=parameterTemplate;var n=b.getElementsByTagName("input")[0];n.pindex=l;b.paramNode=n;b.uvNode=b.getElementsByTagName("input")[1];b.getElementsByTagName("label")[0].innerHTML=g.name+" (token: <pre style='display:inline'>"+
g.token+"</pre>)";var q=!1;g.uv?(q=!0,b.uvNode.value=g.uv):(Utils.addClass(b.uvNode,"no-uv"),b.uvNode.value="edit script to set universal variable");g=void 0!==g.inputVariable?g.inputVariable:"";n.value=g;n.className=g||q?"":"red";q&&(n.setAttribute("onfocus",null),n.setAttribute("onblur",null));k.appendChild(b)}0===m.length?(f.style.display="none",k.innerHTML="<div class='no-params'>No parameters defined.</div>"):f.style.display=""};var excluded="parameters PACKAGE dependencies CONSTRUCTOR dedupe priv name description inactive vendor loadDependenciesOnLoad variables".split(" ");
function propertyExcludedFromConfig(b){for(var k=0;k<excluded.length;k++)if(b===excluded[k])return!0;return!1}var hidden=["filterTimeout","isPrivate",,"usesDocumentWrite","timeout","singleton","locationPlaceHolder","locationDetail","locationObject","noMultipleLoad","__proto__"];function propertyHiddenFromConfig(b){for(var k=0;k<hidden.length;k++)if(b===hidden[k])return!0;return!1}
function prepareConfigElement(b,k,f){var m=document.createElement("div");m.innerHTML=f;m.children[0].className="config";m.getElementsByTagName("input")[0].cname=b;m.getElementsByTagName("label")[0].innerHTML=b;void 0!==k&&(m.getElementsByTagName("input")[0].value=k);m.getElementsByTagName("input")[0].entered=!0;return m}var configTemplate=document.getElementById("config-template").innerHTML,hiddenConfigTemplate=document.getElementById("toggled-config-template").innerHTML;
function addConfig(b,k){var f=document.createElement("div");f.innerHTML=hiddenConfigTemplate;f.className="config-header";var m=f.children[0].children[0];m.innerHTML="<span plus='true'>+</span> Configuration";toggleShowSibling(m);var l=f.children[0].children[1];b.appendChild(f);for(var g in k)propertyExcludedFromConfig(g)||propertyHiddenFromConfig(g)||(m=prepareConfigElement(g,k[g],configTemplate),l.appendChild(m));f=document.createElement("div");f.innerHTML=hiddenConfigTemplate;f.className="config-header";
l.appendChild(f);m=f.children[0].children[0];l=f.children[0].children[1];toggleShowSibling(m);m.innerHTML="<span plus='true'>+</span> Advanced";for(g in k)!propertyExcludedFromConfig(g)&&propertyHiddenFromConfig(g)&&(m=prepareConfigElement(g,k[g],configTemplate),l.appendChild(m))}var prePostTemplate=document.getElementById("pre-post-script-template").innerHTML;
function addPrePostTemplate(b,k){var f=document.createElement("div");f.innerHTML=prePostTemplate;var m=f.getElementsByTagName("textarea"),l=m[0],g=m[1],m=m[2],n=k.config.post?k.config.post:String(k.post),q=k.config.script?k.config.script:String(k.script);l.value=String(k.config.pre?k.config.pre:String(k.pre));g.value=String(n);m.value=String(q);l.style.display="none";g.style.display="none";m.style.display="none";k.preNode=l;k.postNode=g;k.scriptNode=m;b.appendChild(f)}var testTemplate=document.getElementById("unit-test-template").innerHTML;
function addTest(b,k){var f=document.createElement("div");f.innerHTML=testTemplate;f.className="unit-test";k.testNode=f;k.statusNode=f.children[0];k.nameNode=f.children[1];k.nameNode.innerHTML=k.name;k.onFinished=function(){this.failed?Utils.addClass(this.statusNode,"failed"):this.passed&&Utils.addClass(this.statusNode,"passed")};b.appendChild(f)}
function addBDDTest(b,k){var f=document.createElement("div");f.innerHTML=testTemplate;f.className="unit-test";k.testNode=f;k.statusNode=f.children[0];k.nameNode=f.children[1];k.nameNode.innerHTML=k.description;var m=k.resultCallback;k.resultCallback=function(b){m.apply(k,arguments);"failed"===k.result.status?Utils.addClass(k.statusNode,"failed"):"passed"===k.result.status&&Utils.addClass(k.statusNode,"passed")};b.appendChild(f)}var testsSuiteTemplate=document.getElementById("unit-tests-suite-template").innerHTML;
function addTestsSuite(b,k){var f=document.createElement("div");f.className="unit-tests-suite";f.innerHTML=testsSuiteTemplate;var m=Utils.getObjectUsingPath(k.PACKAGE_NAME+".local.TestsSuite"),l=Utils.getObjectUsingPath(k.PACKAGE_NAME+".local.BDDSuite");b.appendChild(f);renderTestsToNode(f.children[1],m,l)}
function renderTestsToNode(b,k,f){b.innerHTML="";if(f){f.unitTestsNode=b;f=f.children;for(var m=0;m<f.length;m++)addBDDTest(b,f[m])}if(k)for(k.unitTestsNode=b,f=k.tests,m=0;m<f.length;m++)addTest(b,f[m])}function prepareVendorNode(b){var k=document.createElement("div");k.innerHTML="<a class='plain' href='#-2'>"+b+"</a>";k.className="vendor";k.children[0].onclick=function(){var b=this.ishidden?"show":"hide";this.ishidden=!this.ishidden;this.parentNode.className="vendor "+b};return k}
function findTags(b,k){k=k||[];Utils.traverse(b,function(f,m,l,g){f&&f.prototype&&"superclass"!==l&&f.prototype instanceof qubit.opentag.BaseTag&&f!==qubit.opentag.BaseTag&&f!==qubit.opentag.LibraryTag&&f!==qubit.opentag.CustomTag&&b.Tag!==f&&k.push(f)},{objectsOnly:!0,track:!0});return k}
(function(){function b(b){this.config=b||{};b&&(this.libraryNode=document.createElement("div"),this.config.parentContainer.appendChild(this.libraryNode),this.init(this.paint.bind(this)))}var k=document.getElementById("library-template").innerHTML,f=qubit.opentag.Utils;f.clazz("ui.Library",b);b.prototype.paint=function(b){this.painted=!0;this.renderLibraryToNode(this.config.libraryClass,this.libraryNode,b||"hide")};b.prototype.init=function(b){var k=APP_PATH+"getClassPath?classPath=libraries."+this.config.libraryClass.prototype.PACKAGE_NAME+
".local&file=Config.js";try{GET(k,function(g){try{f.geval(g)}catch(k){}b&&b()})}catch(g){(b,g)&&b()}};b.prototype.renderLibraryToNode=function(b,l,g,n){n=n||{};var q=new b;q.unregister();if(n.parameters&&q.config.parameters)for(var r=0;r<n.parameters.length;r++)for(var t=n.parameters[r].token,x=0;x<q.config.parameters.length;x++)q.config.parameters[x].token===t&&(q.config.parameters[x].inputVariable=n.parameters[r].inputVariable);n=q.PACKAGE_NAME+"."+q.CLASS_NAME;l||(l=document.getElementById(n),
f.removeClass(l,"tests-failed"),f.removeClass(l,"tests-passed"),f.removeClass(l,"tests-notests"));l.setAttribute("library-node","true");l.innerHTML=k;r="";b.versionClassPath&&(r=b.prototype.PACKAGE_NAME.replace(b.versionClassPath+".",""),r=r.replace(/\._(\d)/g,".$1"),r="<span class='version-title'> ("+r+") </span>");l.children[0].children[1].innerHTML=q.config.name+r+"<a href='#-3' onclick='saveNewVersion(this, arguments[0]);'> clone </a>";f.addClass(l,"library");g&&f.addClass(l,g);l.reference=q;
l.libraryWidget=this;l.classReference=b;l.id=n;b=q.config.parameters;g=l.children[7].children[0];l=l.children[7].children[1];try{var a=f.getObjectUsingPath(q.PACKAGE_NAME+".local.Config");if(a&&a.parameters)for(var y=a.parameters,a=0;a<b.length;a++){var e=b[a];for(n=0;n<y.length;n++)if(e.token&&e.token===y[n].token){var h=b[a].inputVariable,c=b[a].uv;b[a]=y[n];h&&(b[a].inputVariable=h);c&&(b[a].uv=c);break}}}catch(d){}g.children[0].innerHTML=(q.config.imageUrl?"<img class='logo' src='"+q.config.imageUrl+
"' align='right' />":"")+q.config.description;(new ui.Parameters({parentContainer:l,params:b})).paint();addConfig(l,q.config);addPrePostTemplate(l,q);addTestsSuite(l,q)}})();qubit.VENDOR_SPACE_CP="";Utils=qubit.opentag.Utils;window.LIBRARIES={};
function renderAllLibrariesToPage(){var b=document.getElementById("libraries");b.innerHTML="";var k=[],f=qubit.vs;if(!f)try{f=qubit.vs}catch(m){}for(var l in f)if("PACKAGE_NAME"!==l&&"CLASSPATH"!==l){var g=f[l],n=prepareVendorNode(l),q;for(q in g)try{var r=g[q].Tag,t=[l,q].join(".");if(r){var x=new r({}),t=r.prototype.PACKAGE_NAME;x.unregister();x instanceof qubit.opentag.LibraryTag&&k.push([n,r,x])}for(var a=findTags(g[q]),y=0;y<a.length;y++){var e=new a[y]({});e.unregister();a[y].versionClassPath=
t;k.push([n,a[y],e])}}catch(h){window.console&&console.log?(console.log("Failed to load tag configuration, possible syntax error:"+h),info("Failed to load tag configuration, possible syntax error:"+h)):logError("Failed to load tag configuration, possible syntax error:"+h)}k.sort(function(a,b){var c=a[1],d=b[1],e=a[2].config,f=b[2].config;return e.name===f.name?(f=e="",c.versionClassPath&&(e=c.prototype.PACKAGE_NAME.replace(c.versionClassPath+".","")),d.versionClassPath&&(f=d.prototype.PACKAGE_NAME.replace(d.versionClassPath+
".","")),compareVersions(e,f)):e.name>f.name?1:e.name===f.name?0:-1});c+=k.length;b.appendChild(n)}var c=k.length,d=0;theProgressBar("Rendering...",function(){return d/c*100});var I=!1;(function(a){var b=0,c=function(){for(var e=0;8>e;e++){d++;if(b===a.length){I||setTimeout(bodyLoaded,200);I=!0;return}var f=a[b][1],g=new ui.Library({parentContainer:a[b][0],libraryClass:f});LIBRARIES[f.PACKAGE_NAME+"."+f.CLASS_NAME]=g;b++}setTimeout(c,4)};c()})(k)}var total=1,counted=0;
function loadAllLibs(b){GET(LIBRARIES_REPO_LOC+"shared/bin/html/scripts.txt",function(k){var f=[];k=k.split(",");k.push("shared/bin/html/js/build-location.js");total=1;counted=0;if(!b){b=[];for(var m=0;m<k.length;m++)k[m]&&-1==k[m].indexOf("shared/js/tagsdk-current.js")&&b.push(k[m])}theProgressBar("Loading scipts",function(){return 0===counted?0:counted/(b.length+total)*100});var l=0,g=function(){if(l!==b.length){var k=l;l++;var m=LIBRARIES_REPO_LOC+b[k];setTimeout(function(){_loadSingle(m,k,g,b,
f)},0)}};g()})}
function compareVersions(b,k){var f=b.replace(/\./g,".").split("."),m=k.replace(/\./g,".").split("."),l=null;if(f.length&&m.length){var g=f[0].replace(/[^\d+]/g,".").split("."),g=g[g.length-1],n=m[0].replace(/[^\d+]/g,".").split("."),n=n[n.length-1],q=f[0].substring(0,f[0].lastIndexOf(g)),r=m[0].substring(0,m[0].lastIndexOf(n));q!==r||isNaN(+g)||isNaN(+n)?f[0]>m[0]?l=!0:f[0]<m[0]&&(l=!1):+g<+n?l=!0:+g>+n&&(l=!1)}if(null===l)for(g=1;g<f.length&&g<m.length;g++)if(n=m[g],q=f[g],"0"!==q.charAt(0)&&"0"!==
n.charAt(0)||0===g||(q="0."+q,n="0."+n),!isNaN(+q)&&!isNaN(+n))if(+q<+n){l=!0;break}else{if(+q>+n){l=!1;break}}else if(q<n){l=!0;break}else if(q>n){l=!1;break}f.length!==m.length&&null===l&&(l=f.length<m.length);return!0===l?1:null===l?0:-1}function _loadSingle(b,k,f,m,l){GET(b,function(g,n){try{l[k]={expr:g,url:b},log(b),counted++,m.length===counted&&_allScriptsFetched(l)}finally{f&&f()}})}
function _allScriptsFetched(b){for(var k=0;k<b.length;k++)try{eval(b[k].expr)}catch(f){logError("Failed to load: "+b[k].url+"\nException: "+f)}theProgressBar.title+=", rendering... ";listScripts(b);setTimeout(function(){counted++;renderAllLibrariesToPage();window.toggleConsole();qubit.opentag.Log.LEVEL=3;qubit.opentag.Log.COLLECT_LEVEL=5},50)}
function keepRunningTests(){-1!==location.href.indexOf("runTests=true")&&(info("Running tests..."),runAllTests(function(){countdown("Automatically running tests... ",10);setTimeout(keepRunningTests,1E4)}))}function countdown(b,k,f){if(!(0>=k)){info(b+k+(f||""),1E3,"countdown");var m=k-1;setTimeout(function(){countdown(b,m)},1E3)}}function listScripts(b){}function bodyLoaded(){setTimeout(keepRunningTests,1E3)}
window.Main=function(){window.qlog=new qconsole;window.toggleConsole=function(){qlog.hidden?qlog.show():qlog.hide()};window.logError=function(b,k){log("<span style='color: red'>"+b+"</span>");info("<span style='color: #FF766F'>"+b+"</span>",k||5E3)};window.info=function(b,k,f){DefaultNotificationsMgr.notify(f||(new Date).valueOf(),b,k||2800,"",!0);log(b)};window.log=function(b){qlog.log(b)};Suite.log=Test.log=function(b){log(b)};loadAllLibs();window.DefaultNotificationsMgr=new NotificationManager({maxTime:4E3})};
